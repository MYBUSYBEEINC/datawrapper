!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("../../../../../../../../../../../static/vendor/jschardet/jschardet.min.js"),require("../../../../../../../../../../../static/vendor/xlsx/xlsx.full.min.js")):"function"==typeof define&&define.amd?define("svelte/upload",["../../../../../../../../../../../static/vendor/jschardet/jschardet.min","../../../../../../../../../../../static/vendor/xlsx/xlsx.full.min"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).upload=e(t.jschardet)}(this,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=e(t);function r(){}function a(t,e){for(var n in e)t[n]=e[n];return t}function o(t,e){for(var n in e)t[n]=1;return t}function i(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n)}function c(t){t.parentNode.removeChild(t)}function u(t,e){for(var n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function l(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function d(t,e,n,r){t.addEventListener(e,n,r)}function h(t,e,n,r){t.removeEventListener(e,n,r)}function p(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function v(t,e){t.data=""+e}function g(t,e){for(var n=0;n<t.options.length;n+=1){var r=t.options[n];if(r.__value===e)return void(r.selected=!0)}}function y(t){var e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function m(){return Object.create(null)}function _(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function b(t,e){return t!=t?e==e:t!==e}function w(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var r=0;r<n.length;r+=1){var a=n[r];if(!a.__calling)try{a.__calling=!0,a.call(this,e)}finally{a.__calling=!1}}}function x(t){t._lock=!0,S(t._beforecreate),S(t._oncreate),S(t._aftercreate),t._lock=!1}function D(){return this._state}function j(t,e){t._handlers=m(),t._slots=m(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function A(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}}function S(t){for(;t&&t.length;)t.shift()()}var T={destroy:function(t){this.destroy=r,this.fire("destroy"),this.set=r,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:D,fire:w,on:A,set:function(t){this._set(a({},t)),this.root._lock||x(this.root)},_recompute:r,_set:function(t){var e=this._state,n={},r=!1;for(var o in t=a(this._staged,t),this._staged={},t)this._differs(t[o],e[o])&&(n[o]=r=!0);r&&(this._state=a(a({},e),t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(this.fire("state",{changed:n,current:this._state,previous:e}),this._fragment.p(n,this._state),this.fire("update",{changed:n,current:this._state,previous:e})))},_stage:function(t){a(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:_},N={exports:{}};
/*!
	 * JavaScript Cookie v2.2.1
	 * https://github.com/js-cookie/js-cookie
	 *
	 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
	 * Released under the MIT license
	 */
!function(t,e){var n;n=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function a(){}function o(e,n,o){if("undefined"!=typeof document){"number"==typeof(o=t({path:"/"},a.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var i=JSON.stringify(n);/^[\{\[]/.test(i)&&(n=i)}catch(t){}n=r.write?r.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=e+"="+n+s}}function i(t,n){if("undefined"!=typeof document){for(var a={},o=document.cookie?document.cookie.split("; "):[],i=0;i<o.length;i++){var s=o[i].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=e(s[0]);if(c=(r.read||r)(c,u)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(a[u]=c,t===u)break}catch(t){}}return t?a[t]:a}}return a.set=o,a.get=function(t){return i(t,!1)},a.getJSON=function(t){return i(t,!0)},a.remove=function(e,n){o(e,"",t(n,{expires:-1}))},a.defaults={},a.withConverter=n,a}((function(){}))},t.exports=n()}(N);var k=N.exports;const O=new Set(["get","head","options","trace"]);function E(t,e={}){if(!e.fetch)try{e.fetch=window.fetch}catch(t){throw new Error("Neither options.fetch nor window.fetch is defined.")}if(!e.baseUrl)try{e.baseUrl="//"+window.dw.backend.__api_domain}catch(t){throw new Error("Neither options.baseUrl nor window.dw is defined.")}const{payload:n,baseUrl:r,fetch:a,raw:o,...i}={payload:null,raw:!1,method:"GET",mode:"cors",credentials:"include",...e,headers:{"Content-Type":"application/json",...e.headers}},s=`${r.replace(/\/$/,"")}/${t.replace(/^\//,"")}`;let c;if(n&&(i.body=JSON.stringify(n)),O.has(i.method.toLowerCase()))c=a(s,i);else{const t=k.get("crumb");t?(i.headers["X-CSRF-Token"]=t,c=a(s,i)):c=E("/v3/me",{fetch:a,baseUrl:r}).then(()=>{const t=k.get("crumb");t&&(i.headers["X-CSRF-Token"]=t)}).catch(()=>{}).then(()=>a(s,i))}return c.then(t=>{if(o)return t;if(!t.ok)throw new M(t);if(204===t.status||!t.headers.get("content-type"))return t;const e=t.headers.get("content-type").split(";")[0];return"application/json"===e?t.json():"image/png"===e||"application/pdf"===e?t.blob():t.text()})}function C(t){return(e,n)=>{if(n&&n.method)throw new Error(`Setting option.method is not allowed in httpReq.${t.toLowerCase()}()`);return E(e,{...n,method:t})}}E.get=C("GET"),E.patch=C("PATCH"),E.put=C("PUT"),E.post=C("POST"),E.head=C("HEAD"),E.delete=C("DELETE");class M extends Error{constructor(t){super(),this.name="HttpReqError",this.status=t.status,this.statusText=t.statusText,this.message=`[${t.status}] ${t.statusText}`,this.response=t}}var R="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},U=Array.prototype,F=Object.prototype,B="undefined"!=typeof Symbol?Symbol.prototype:null,P=U.push,I=U.slice,$=F.toString,L=F.hasOwnProperty,q="undefined"!=typeof ArrayBuffer,H="undefined"!=typeof DataView,V=Array.isArray,z=Object.keys,X=Object.create,J=q&&ArrayBuffer.isView,W=isNaN,G=isFinite,K=!{toString:null}.propertyIsEnumerable("toString"),Z=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Q=Math.pow(2,53)-1;function Y(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),a=0;a<n;a++)r[a]=arguments[a+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var o=Array(e+1);for(a=0;a<e;a++)o[a]=arguments[a];return o[e]=r,t.apply(this,o)}}function tt(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function et(t){return void 0===t}function nt(t){return!0===t||!1===t||"[object Boolean]"===$.call(t)}function rt(t){var e="[object "+t+"]";return function(t){return $.call(t)===e}}var at=rt("String"),ot=rt("Number"),it=rt("Date"),st=rt("RegExp"),ct=rt("Error"),ut=rt("Symbol"),lt=rt("ArrayBuffer"),ft=rt("Function"),dt=R.document&&R.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof dt&&(ft=function(t){return"function"==typeof t||!1});var ht=ft,pt=rt("Object"),vt=H&&pt(new DataView(new ArrayBuffer(8))),gt="undefined"!=typeof Map&&pt(new Map),yt=rt("DataView");var mt=vt?function(t){return null!=t&&ht(t.getInt8)&&lt(t.buffer)}:yt,_t=V||rt("Array");function bt(t,e){return null!=t&&L.call(t,e)}var wt=rt("Arguments");!function(){wt(arguments)||(wt=function(t){return bt(t,"callee")})}();var xt=wt;function Dt(t){return ot(t)&&W(t)}function jt(t){return function(){return t}}function At(t){return function(e){var n=t(e);return"number"==typeof n&&n>=0&&n<=Q}}function St(t){return function(e){return null==e?void 0:e[t]}}var Tt=St("byteLength"),Nt=At(Tt),kt=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var Ot=q?function(t){return J?J(t)&&!mt(t):Nt(t)&&kt.test($.call(t))}:jt(!1),Et=St("length");function Ct(t,e){e=function(t){for(var e={},n=t.length,r=0;r<n;++r)e[t[r]]=!0;return{contains:function(t){return e[t]},push:function(n){return e[n]=!0,t.push(n)}}}(e);var n=Z.length,r=t.constructor,a=ht(r)&&r.prototype||F,o="constructor";for(bt(t,o)&&!e.contains(o)&&e.push(o);n--;)(o=Z[n])in t&&t[o]!==a[o]&&!e.contains(o)&&e.push(o)}function Mt(t){if(!tt(t))return[];if(z)return z(t);var e=[];for(var n in t)bt(t,n)&&e.push(n);return K&&Ct(t,e),e}function Rt(t,e){var n=Mt(e),r=n.length;if(null==t)return!r;for(var a=Object(t),o=0;o<r;o++){var i=n[o];if(e[i]!==a[i]||!(i in a))return!1}return!0}function Ut(t){return t instanceof Ut?t:this instanceof Ut?void(this._wrapped=t):new Ut(t)}function Ft(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,Tt(t))}Ut.VERSION="1.13.1",Ut.prototype.value=function(){return this._wrapped},Ut.prototype.valueOf=Ut.prototype.toJSON=Ut.prototype.value,Ut.prototype.toString=function(){return String(this._wrapped)};function Bt(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var a=typeof t;return("function"===a||"object"===a||"object"==typeof e)&&function t(e,n,r,a){e instanceof Ut&&(e=e._wrapped);n instanceof Ut&&(n=n._wrapped);var o=$.call(e);if(o!==$.call(n))return!1;if(vt&&"[object Object]"==o&&mt(e)){if(!mt(n))return!1;o="[object DataView]"}switch(o){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return B.valueOf.call(e)===B.valueOf.call(n);case"[object ArrayBuffer]":case"[object DataView]":return t(Ft(e),Ft(n),r,a)}var i="[object Array]"===o;if(!i&&Ot(e)){if(Tt(e)!==Tt(n))return!1;if(e.buffer===n.buffer&&e.byteOffset===n.byteOffset)return!0;i=!0}if(!i){if("object"!=typeof e||"object"!=typeof n)return!1;var s=e.constructor,c=n.constructor;if(s!==c&&!(ht(s)&&s instanceof s&&ht(c)&&c instanceof c)&&"constructor"in e&&"constructor"in n)return!1}a=a||[];var u=(r=r||[]).length;for(;u--;)if(r[u]===e)return a[u]===n;if(r.push(e),a.push(n),i){if((u=e.length)!==n.length)return!1;for(;u--;)if(!Bt(e[u],n[u],r,a))return!1}else{var l,f=Mt(e);if(u=f.length,Mt(n).length!==u)return!1;for(;u--;)if(l=f[u],!bt(n,l)||!Bt(e[l],n[l],r,a))return!1}return r.pop(),a.pop(),!0}(t,e,n,r)}function Pt(t){if(!tt(t))return[];var e=[];for(var n in t)e.push(n);return K&&Ct(t,e),e}function It(t){var e=Et(t);return function(n){if(null==n)return!1;var r=Pt(n);if(Et(r))return!1;for(var a=0;a<e;a++)if(!ht(n[t[a]]))return!1;return t!==Vt||!ht(n[$t])}}var $t="forEach",Lt=["clear","delete"],qt=["get","has","set"],Ht=Lt.concat($t,qt),Vt=Lt.concat(qt),zt=["add"].concat(Lt,$t,"has"),Xt=gt?It(Ht):rt("Map"),Jt=gt?It(Vt):rt("WeakMap"),Wt=gt?It(zt):rt("Set"),Gt=rt("WeakSet");function Kt(t){for(var e=Mt(t),n=e.length,r=Array(n),a=0;a<n;a++)r[a]=t[e[a]];return r}function Zt(t){for(var e={},n=Mt(t),r=0,a=n.length;r<a;r++)e[t[n[r]]]=n[r];return e}function Qt(t){var e=[];for(var n in t)ht(t[n])&&e.push(n);return e.sort()}function Yt(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var a=1;a<r;a++)for(var o=arguments[a],i=t(o),s=i.length,c=0;c<s;c++){var u=i[c];e&&void 0!==n[u]||(n[u]=o[u])}return n}}var te=Yt(Pt),ee=Yt(Mt),ne=Yt(Pt,!0);function re(t){if(!tt(t))return{};if(X)return X(t);var e=function(){};e.prototype=t;var n=new e;return e.prototype=null,n}function ae(t){return tt(t)?_t(t)?t.slice():te({},t):t}function oe(t){return _t(t)?t:[t]}function ie(t){return Ut.toPath(t)}function se(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0}function ce(t,e,n){var r=se(t,ie(e));return et(r)?n:r}function ue(t){return t}function le(t){return t=ee({},t),function(e){return Rt(e,t)}}function fe(t){return t=ie(t),function(e){return se(e,t)}}function de(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,a){return t.call(e,n,r,a)};case 4:return function(n,r,a,o){return t.call(e,n,r,a,o)}}return function(){return t.apply(e,arguments)}}function he(t,e,n){return null==t?ue:ht(t)?de(t,e,n):tt(t)&&!_t(t)?le(t):fe(t)}function pe(t,e){return he(t,e,1/0)}function ve(t,e,n){return Ut.iteratee!==pe?Ut.iteratee(t,e):he(t,e,n)}function ge(){}function ye(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}Ut.toPath=oe,Ut.iteratee=pe;var me=Date.now||function(){return(new Date).getTime()};function _e(t){var e=function(e){return t[e]},n="(?:"+Mt(t).join("|")+")",r=RegExp(n),a=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(a,e):t}}var be={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},we=_e(be),xe=_e(Zt(be)),De=Ut.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},je=/(.)^/,Ae={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Se=/\\|'|\r|\n|\u2028|\u2029/g;function Te(t){return"\\"+Ae[t]}var Ne=/^\s*(\w|\$)+\s*$/;var ke=0;function Oe(t,e,n,r,a){if(!(r instanceof e))return t.apply(n,a);var o=re(t.prototype),i=t.apply(o,a);return tt(i)?i:o}var Ee=Y((function(t,e){var n=Ee.placeholder,r=function(){for(var a=0,o=e.length,i=Array(o),s=0;s<o;s++)i[s]=e[s]===n?arguments[a++]:e[s];for(;a<arguments.length;)i.push(arguments[a++]);return Oe(t,r,this,this,i)};return r}));Ee.placeholder=Ut;var Ce=Y((function(t,e,n){if(!ht(t))throw new TypeError("Bind must be called on a function");var r=Y((function(a){return Oe(t,r,e,this,n.concat(a))}));return r})),Me=At(Et);function Re(t,e,n,r){if(r=r||[],e||0===e){if(e<=0)return r.concat(t)}else e=1/0;for(var a=r.length,o=0,i=Et(t);o<i;o++){var s=t[o];if(Me(s)&&(_t(s)||xt(s)))if(e>1)Re(s,e-1,n,r),a=r.length;else for(var c=0,u=s.length;c<u;)r[a++]=s[c++];else n||(r[a++]=s)}return r}var Ue=Y((function(t,e){var n=(e=Re(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=Ce(t[r],t)}return t}));var Fe=Y((function(t,e,n){return setTimeout((function(){return t.apply(null,n)}),e)})),Be=Ee(Fe,Ut,1);function Pe(t,e,n){var r,a,o,i,s=0;n||(n={});var c=function(){s=!1===n.leading?0:me(),r=null,i=t.apply(a,o),r||(a=o=null)},u=function(){var u=me();s||!1!==n.leading||(s=u);var l=e-(u-s);return a=this,o=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),s=u,i=t.apply(a,o),r||(a=o=null)):r||!1===n.trailing||(r=setTimeout(c,l)),i};return u.cancel=function(){clearTimeout(r),s=0,r=a=o=null},u}function Ie(t){return function(){return!t.apply(this,arguments)}}function $e(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}var Le=Ee($e,2);function qe(t,e,n){e=ve(e,n);for(var r,a=Mt(t),o=0,i=a.length;o<i;o++)if(e(t[r=a[o]],r,t))return r}function He(t){return function(e,n,r){n=ve(n,r);for(var a=Et(e),o=t>0?0:a-1;o>=0&&o<a;o+=t)if(n(e[o],o,e))return o;return-1}}var Ve=He(1),ze=He(-1);function Xe(t,e,n,r){for(var a=(n=ve(n,r,1))(e),o=0,i=Et(t);o<i;){var s=Math.floor((o+i)/2);n(t[s])<a?o=s+1:i=s}return o}function Je(t,e,n){return function(r,a,o){var i=0,s=Et(r);if("number"==typeof o)t>0?i=o>=0?o:Math.max(o+s,i):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return r[o=n(r,a)]===a?o:-1;if(a!=a)return(o=e(I.call(r,i,s),Dt))>=0?o+i:-1;for(o=t>0?i:s-1;o>=0&&o<s;o+=t)if(r[o]===a)return o;return-1}}var We=Je(1,Ve,Xe),Ge=Je(-1,ze);function Ke(t,e,n){var r=(Me(t)?Ve:qe)(t,e,n);if(void 0!==r&&-1!==r)return t[r]}function Ze(t,e,n){var r,a;if(e=de(e,n),Me(t))for(r=0,a=t.length;r<a;r++)e(t[r],r,t);else{var o=Mt(t);for(r=0,a=o.length;r<a;r++)e(t[o[r]],o[r],t)}return t}function Qe(t,e,n){e=ve(e,n);for(var r=!Me(t)&&Mt(t),a=(r||t).length,o=Array(a),i=0;i<a;i++){var s=r?r[i]:i;o[i]=e(t[s],s,t)}return o}function Ye(t){var e=function(e,n,r,a){var o=!Me(e)&&Mt(e),i=(o||e).length,s=t>0?0:i-1;for(a||(r=e[o?o[s]:s],s+=t);s>=0&&s<i;s+=t){var c=o?o[s]:s;r=n(r,e[c],c,e)}return r};return function(t,n,r,a){var o=arguments.length>=3;return e(t,de(n,a,4),r,o)}}var tn=Ye(1),en=Ye(-1);function nn(t,e,n){var r=[];return e=ve(e,n),Ze(t,(function(t,n,a){e(t,n,a)&&r.push(t)})),r}function rn(t,e,n){e=ve(e,n);for(var r=!Me(t)&&Mt(t),a=(r||t).length,o=0;o<a;o++){var i=r?r[o]:o;if(!e(t[i],i,t))return!1}return!0}function an(t,e,n){e=ve(e,n);for(var r=!Me(t)&&Mt(t),a=(r||t).length,o=0;o<a;o++){var i=r?r[o]:o;if(e(t[i],i,t))return!0}return!1}function on(t,e,n,r){return Me(t)||(t=Kt(t)),("number"!=typeof n||r)&&(n=0),We(t,e,n)>=0}var sn=Y((function(t,e,n){var r,a;return ht(e)?a=e:(e=ie(e),r=e.slice(0,-1),e=e[e.length-1]),Qe(t,(function(t){var o=a;if(!o){if(r&&r.length&&(t=se(t,r)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)}))}));function cn(t,e){return Qe(t,fe(e))}function un(t,e,n){var r,a,o=-1/0,i=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var s=0,c=(t=Me(t)?t:Kt(t)).length;s<c;s++)null!=(r=t[s])&&r>o&&(o=r);else e=ve(e,n),Ze(t,(function(t,n,r){((a=e(t,n,r))>i||a===-1/0&&o===-1/0)&&(o=t,i=a)}));return o}function ln(t,e,n){if(null==e||n)return Me(t)||(t=Kt(t)),t[ye(t.length-1)];var r=Me(t)?ae(t):Kt(t),a=Et(r);e=Math.max(Math.min(e,a),0);for(var o=a-1,i=0;i<e;i++){var s=ye(i,o),c=r[i];r[i]=r[s],r[s]=c}return r.slice(0,e)}function fn(t,e){return function(n,r,a){var o=e?[[],[]]:{};return r=ve(r,a),Ze(n,(function(e,a){var i=r(e,a,n);t(o,e,i)})),o}}var dn=fn((function(t,e,n){bt(t,n)?t[n].push(e):t[n]=[e]})),hn=fn((function(t,e,n){t[n]=e})),pn=fn((function(t,e,n){bt(t,n)?t[n]++:t[n]=1})),vn=fn((function(t,e,n){t[n?0:1].push(e)}),!0),gn=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function yn(t,e,n){return e in n}var mn=Y((function(t,e){var n={},r=e[0];if(null==t)return n;ht(r)?(e.length>1&&(r=de(r,e[1])),e=Pt(t)):(r=yn,e=Re(e,!1,!1),t=Object(t));for(var a=0,o=e.length;a<o;a++){var i=e[a],s=t[i];r(s,i,t)&&(n[i]=s)}return n})),_n=Y((function(t,e){var n,r=e[0];return ht(r)?(r=Ie(r),e.length>1&&(n=e[1])):(e=Qe(Re(e,!1,!1),String),r=function(t,n){return!on(e,n)}),mn(t,r,n)}));function bn(t,e,n){return I.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function wn(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:bn(t,t.length-e)}function xn(t,e,n){return I.call(t,null==e||n?1:e)}var Dn=Y((function(t,e){return e=Re(e,!0,!0),nn(t,(function(t){return!on(e,t)}))})),jn=Y((function(t,e){return Dn(t,e)}));function An(t,e,n,r){nt(e)||(r=n,n=e,e=!1),null!=n&&(n=ve(n,r));for(var a=[],o=[],i=0,s=Et(t);i<s;i++){var c=t[i],u=n?n(c,i,t):c;e&&!n?(i&&o===u||a.push(c),o=u):n?on(o,u)||(o.push(u),a.push(c)):on(a,c)||a.push(c)}return a}var Sn=Y((function(t){return An(Re(t,!0,!0))}));function Tn(t){for(var e=t&&un(t,Et).length||0,n=Array(e),r=0;r<e;r++)n[r]=cn(t,r);return n}var Nn=Y(Tn);function kn(t,e){return t._chain?Ut(e).chain():e}function On(t){return Ze(Qt(t),(function(e){var n=Ut[e]=t[e];Ut.prototype[e]=function(){var t=[this._wrapped];return P.apply(t,arguments),kn(this,n.apply(Ut,t))}})),Ut}Ze(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=U[t];Ut.prototype[t]=function(){var n=this._wrapped;return null!=n&&(e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0]),kn(this,n)}})),Ze(["concat","join","slice"],(function(t){var e=U[t];Ut.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),kn(this,t)}}));var En=On(Object.freeze({__proto__:null,VERSION:"1.13.1",restArguments:Y,isObject:tt,isNull:function(t){return null===t},isUndefined:et,isBoolean:nt,isElement:function(t){return!(!t||1!==t.nodeType)},isString:at,isNumber:ot,isDate:it,isRegExp:st,isError:ct,isSymbol:ut,isArrayBuffer:lt,isDataView:mt,isArray:_t,isFunction:ht,isArguments:xt,isFinite:function(t){return!ut(t)&&G(t)&&!isNaN(parseFloat(t))},isNaN:Dt,isTypedArray:Ot,isEmpty:function(t){if(null==t)return!0;var e=Et(t);return"number"==typeof e&&(_t(t)||at(t)||xt(t))?0===e:0===Et(Mt(t))},isMatch:Rt,isEqual:function(t,e){return Bt(t,e)},isMap:Xt,isWeakMap:Jt,isSet:Wt,isWeakSet:Gt,keys:Mt,allKeys:Pt,values:Kt,pairs:function(t){for(var e=Mt(t),n=e.length,r=Array(n),a=0;a<n;a++)r[a]=[e[a],t[e[a]]];return r},invert:Zt,functions:Qt,methods:Qt,extend:te,extendOwn:ee,assign:ee,defaults:ne,create:function(t,e){var n=re(t);return e&&ee(n,e),n},clone:ae,tap:function(t,e){return e(t),t},get:ce,has:function(t,e){for(var n=(e=ie(e)).length,r=0;r<n;r++){var a=e[r];if(!bt(t,a))return!1;t=t[a]}return!!n},mapObject:function(t,e,n){e=ve(e,n);for(var r=Mt(t),a=r.length,o={},i=0;i<a;i++){var s=r[i];o[s]=e(t[s],s,t)}return o},identity:ue,constant:jt,noop:ge,toPath:oe,property:fe,propertyOf:function(t){return null==t?ge:function(e){return ce(t,e)}},matcher:le,matches:le,times:function(t,e,n){var r=Array(Math.max(0,t));e=de(e,n,1);for(var a=0;a<t;a++)r[a]=e(a);return r},random:ye,now:me,escape:we,unescape:xe,templateSettings:De,template:function(t,e,n){!e&&n&&(e=n),e=ne({},e,Ut.templateSettings);var r=RegExp([(e.escape||je).source,(e.interpolate||je).source,(e.evaluate||je).source].join("|")+"|$","g"),a=0,o="__p+='";t.replace(r,(function(e,n,r,i,s){return o+=t.slice(a,s).replace(Se,Te),a=s+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(o+="';\n"+i+"\n__p+='"),e})),o+="';\n";var i,s=e.variable;if(s){if(!Ne.test(s))throw new Error("variable is not a bare identifier: "+s)}else o="with(obj||{}){\n"+o+"}\n",s="obj";o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{i=new Function(s,"_",o)}catch(t){throw t.source=o,t}var c=function(t){return i.call(this,t,Ut)};return c.source="function("+s+"){\n"+o+"}",c},result:function(t,e,n){var r=(e=ie(e)).length;if(!r)return ht(n)?n.call(t):n;for(var a=0;a<r;a++){var o=null==t?void 0:t[e[a]];void 0===o&&(o=n,a=r),t=ht(o)?o.call(t):o}return t},uniqueId:function(t){var e=++ke+"";return t?t+e:e},chain:function(t){var e=Ut(t);return e._chain=!0,e},iteratee:pe,partial:Ee,bind:Ce,bindAll:Ue,memoize:function(t,e){var n=function(r){var a=n.cache,o=""+(e?e.apply(this,arguments):r);return bt(a,o)||(a[o]=t.apply(this,arguments)),a[o]};return n.cache={},n},delay:Fe,defer:Be,throttle:Pe,debounce:function(t,e,n){var r,a,o,i,s,c=function(){var u=me()-a;e>u?r=setTimeout(c,e-u):(r=null,n||(i=t.apply(s,o)),r||(o=s=null))},u=Y((function(u){return s=this,o=u,a=me(),r||(r=setTimeout(c,e),n&&(i=t.apply(s,o))),i}));return u.cancel=function(){clearTimeout(r),r=o=s=null},u},wrap:function(t,e){return Ee(e,t)},negate:Ie,compose:function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:$e,once:Le,findKey:qe,findIndex:Ve,findLastIndex:ze,sortedIndex:Xe,indexOf:We,lastIndexOf:Ge,find:Ke,detect:Ke,findWhere:function(t,e){return Ke(t,le(e))},each:Ze,forEach:Ze,map:Qe,collect:Qe,reduce:tn,foldl:tn,inject:tn,reduceRight:en,foldr:en,filter:nn,select:nn,reject:function(t,e,n){return nn(t,Ie(ve(e)),n)},every:rn,all:rn,some:an,any:an,contains:on,includes:on,include:on,invoke:sn,pluck:cn,where:function(t,e){return nn(t,le(e))},max:un,min:function(t,e,n){var r,a,o=1/0,i=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var s=0,c=(t=Me(t)?t:Kt(t)).length;s<c;s++)null!=(r=t[s])&&r<o&&(o=r);else e=ve(e,n),Ze(t,(function(t,n,r){((a=e(t,n,r))<i||a===1/0&&o===1/0)&&(o=t,i=a)}));return o},shuffle:function(t){return ln(t,1/0)},sample:ln,sortBy:function(t,e,n){var r=0;return e=ve(e,n),cn(Qe(t,(function(t,n,a){return{value:t,index:r++,criteria:e(t,n,a)}})).sort((function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index})),"value")},groupBy:dn,indexBy:hn,countBy:pn,partition:vn,toArray:function(t){return t?_t(t)?I.call(t):at(t)?t.match(gn):Me(t)?Qe(t,ue):Kt(t):[]},size:function(t){return null==t?0:Me(t)?t.length:Mt(t).length},pick:mn,omit:_n,first:wn,head:wn,take:wn,initial:bn,last:function(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:xn(t,Math.max(0,t.length-e))},rest:xn,tail:xn,drop:xn,compact:function(t){return nn(t,Boolean)},flatten:function(t,e){return Re(t,e,!1)},without:jn,uniq:An,unique:An,union:Sn,intersection:function(t){for(var e=[],n=arguments.length,r=0,a=Et(t);r<a;r++){var o=t[r];if(!on(e,o)){var i;for(i=1;i<n&&on(arguments[i],o);i++);i===n&&e.push(o)}}return e},difference:Dn,unzip:Tn,transpose:Tn,zip:Nn,object:function(t,e){for(var n={},r=0,a=Et(t);r<a;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},range:function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),a=Array(r),o=0;o<r;o++,t+=n)a[o]=t;return a},chunk:function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,a=t.length;r<a;)n.push(I.call(t,r,r+=e));return n},mixin:On,default:Ut}));En._=En;const Cn={};function Mn(t="core"){"chart"===t?window.__dw&&window.__dw.vis&&window.__dw.vis.meta&&(Cn[t]=window.__dw.vis.meta.locale||{}):Cn[t]="core"===t?dw.backend.__messages.core:Object.assign({},dw.backend.__messages.core,dw.backend.__messages[t])}function Rn(t,e="core"){if(t=t.trim(),Cn[e]||Mn(e),!Cn[e][t])return"MISSING:"+t;var n=Cn[e][t];return"string"==typeof n&&arguments.length>2&&(n=n.replace(/\$(\d)/g,(t,e)=>(e=2+Number(e),void 0===arguments[e]?t:arguments[e]))),n}let Un;const Fn=dw.backend.currentChart,Bn=Pe(()=>{const{chartData:t}=Un.get();E.put(`/v3/charts/${Fn.get("id")}/data`,{body:t,headers:{"Content-Type":"text/csv"}})},1e3);function Pn(){Un=this}function In({changed:t,current:e,previous:n}){t.chartData&&e.chartData&&n&&n.chartData!==e.chartData&&Bn()}function $n(t){j(this,t),this._state=a({placeholder:Rn("upload / paste here")},t.data),this._intro=!0,this._handlers.update=[In],this._fragment=function(t,e){var n,r,a,o=!1;function u(){o=!0,t.set({chartData:a.value}),o=!1}return{c(){var t,o;n=l("form"),r=l("div"),d(a=l("textarea"),"input",u),a.readOnly=e.readonly,a.id="upload-data-text",t="resize",o="none",a.style.setProperty(t,o),a.placeholder=e.placeholder,a.className="svelte-kl1kny",r.className="control-group",n.className="upload-form"},m(t,o){s(t,n,o),i(n,r),i(r,a),a.value=e.chartData},p(t,e){!o&&t.chartData&&(a.value=e.chartData),t.readonly&&(a.readOnly=e.readonly),t.placeholder&&(a.placeholder=e.placeholder)},d(t){t&&c(n),h(a,"input",u)}}}(this,this._state),this.root._oncreate.push(()=>{Pn.call(this),this.fire("update",{changed:o({},this._state),current:this._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),x(this))}function Ln({changed:t,current:e}){if(t.selectedDataset&&"--"!==e.selectedDataset){const t=e.selectedDataset;this.set({chartData:t.data}),t.presets&&Object.keys(t.presets).forEach(e=>{dw.backend.currentChart.set(e,t.presets[e])})}}function qn(t,e,n){const r=Object.create(t);return r.dataset=e[n],r}function Hn(t,e,n){const r=Object.create(t);return r.group=e[n],r}function Vn(t,e){var n,r,a,o=e.dataset.title;return{c(){n=l("option"),r=f(o),n.__value=a=e.dataset,n.value=n.__value,n.className="demo-dataset"},m(t,e){s(t,n,e),i(n,r)},p(t,e){t.datasetsArray&&o!==(o=e.dataset.title)&&v(r,o),t.datasetsArray&&a!==(a=e.dataset)&&(n.__value=a),n.value=n.__value},d(t){t&&c(n)}}}function zn(t,e){for(var n,r,a=e.group.datasets,o=[],i=0;i<a.length;i+=1)o[i]=Vn(0,qn(e,a,i));return{c(){n=l("optgroup");for(var t=0;t<o.length;t+=1)o[t].c();p(n,"label",r=e.group.type)},m(t,e){s(t,n,e);for(var r=0;r<o.length;r+=1)o[r].m(n,null)},p(t,e){if(t.datasetsArray){a=e.group.datasets;for(var i=0;i<a.length;i+=1){const r=qn(e,a,i);o[i]?o[i].p(t,r):(o[i]=Vn(0,r),o[i].c(),o[i].m(n,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=a.length}t.datasetsArray&&r!==(r=e.group.type)&&p(n,"label",r)},d(t){t&&c(n),u(o,t)}}}function Xn(t){j(this,t),this._state=a({selectedDataset:"--"},t.data),this._recompute({datasets:1},this._state),this._intro=!0,this._handlers.update=[Ln],this._fragment=function(t,e){for(var n,r,a,o,p,v,m,_,b,w,x=Rn("upload / quick help"),D=Rn("upload / try a dataset"),j=Rn("upload / sample dataset"),A=!1,S=e.datasetsArray,T=[],N=0;N<S.length;N+=1)T[N]=zn(t,Hn(e,S,N));function k(){A=!0,t.set({selectedDataset:y(_)}),A=!1}return{c(){n=l("p"),r=f(x),a=f("\n\n"),o=l("div"),p=l("p"),v=f(D),m=f("\n    "),_=l("select"),b=l("option"),w=f(j);for(var i=0;i<T.length;i+=1)T[i].c();b.__value="--",b.value=b.__value,d(_,"change",k),"selectedDataset"in e||t.root._beforecreate.push(k),_.disabled=e.readonly,_.id="demo-datasets",_.className="svelte-16u58l0",o.className="demo-datasets"},m(t,c){s(t,n,c),i(n,r),s(t,a,c),s(t,o,c),i(o,p),i(p,v),i(o,m),i(o,_),i(_,b),i(b,w);for(var u=0;u<T.length;u+=1)T[u].m(_,null);g(_,e.selectedDataset)},p(e,n){if(e.datasetsArray){S=n.datasetsArray;for(var r=0;r<S.length;r+=1){const a=Hn(n,S,r);T[r]?T[r].p(e,a):(T[r]=zn(t,a),T[r].c(),T[r].m(_,null))}for(;r<T.length;r+=1)T[r].d(1);T.length=S.length}!A&&e.selectedDataset&&g(_,n.selectedDataset),e.readonly&&(_.disabled=n.readonly)},d(t){t&&(c(n),c(a),c(o)),u(T,t),h(_,"change",k)}}}(this,this._state),this.root._oncreate.push(()=>{this.fire("update",{changed:o({},this._state),current:this._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),x(this))}async function Jn({changed:t,current:e}){t.sheets&&e.sheets.length>1?setTimeout(()=>{this.set({selected:e.sheets[0]})},300):t.sheets&&1===e.sheets.length&&(await E.put(`/v3/charts/${dw.backend.currentChart.get("id")}/data`,{body:e.sheets[0].csv,headers:{"Content-Type":"text/csv"}}),window.location.href="describe"),t.selected&&e.selected.csv&&this.set({chartData:e.selected.csv})}function Wn(t,e,n){const r=Object.create(t);return r.sheet=e[n],r}function Gn(t,e){var n,a=Rn("upload / xls / uploading data");return{c(){n=l("p")},m(t,e){s(t,n,e),n.innerHTML=a},p:r,d(t){t&&c(n)}}}function Kn(t,e){for(var n,r,a,o,p,v=Rn("upload / select sheet"),m=!1,_=e.sheets,b=[],w=0;w<_.length;w+=1)b[w]=Qn(t,Wn(e,_,w));function x(){m=!0,t.set({selected:y(o)}),m=!1}return{c(){n=l("p"),r=f(v),a=f("\n    "),o=l("select");for(var i=0;i<b.length;i+=1)b[i].c();d(o,"change",x),"selected"in e||t.root._beforecreate.push(x),o.disabled=p=!e.sheets.length,o.className="svelte-16u58l0"},m(t,c){s(t,n,c),i(n,r),s(t,a,c),s(t,o,c);for(var u=0;u<b.length;u+=1)b[u].m(o,null);g(o,e.selected)},p(e,n){if(e.sheets){_=n.sheets;for(var r=0;r<_.length;r+=1){const a=Wn(n,_,r);b[r]?b[r].p(e,a):(b[r]=Qn(t,a),b[r].c(),b[r].m(o,null))}for(;r<b.length;r+=1)b[r].d(1);b.length=_.length}!m&&e.selected&&g(o,n.selected),e.sheets&&p!==(p=!n.sheets.length)&&(o.disabled=p)},d(t){t&&(c(n),c(a),c(o)),u(b,t),h(o,"change",x)}}}function Zn(t,e){var n,a=Rn("upload / parsing-xls");return{c(){(n=l("div")).className="alert alert-info"},m(t,e){s(t,n,e),n.innerHTML=a},p:r,d(t){t&&c(n)}}}function Qn(t,e){var n,r,a,o=e.sheet.name;return{c(){n=l("option"),r=f(o),n.__value=a=e.sheet,n.value=n.__value},m(t,e){s(t,n,e),i(n,r)},p(t,e){t.sheets&&o!==(o=e.sheet.name)&&v(r,o),t.sheets&&a!==(a=e.sheet)&&(n.__value=a),n.value=n.__value},d(t){t&&c(n)}}}function Yn(t){j(this,t),this._state=a({selected:!1,sheets:[]},t.data),this._intro=!0,this._handlers.update=[Jn],this._fragment=function(t,e){var n;function r(t){return t.sheets.length?t.sheets.length>1?Kn:Gn:Zn}var a=r(e),o=a(t,e);return{c(){n=l("div"),o.c()},m(t,e){s(t,n,e),o.m(n,null)},p(e,i){a===(a=r(i))&&o?o.p(e,i):(o.d(1),(o=a(t,i)).c(),o.m(n,null))},d(t){t&&c(n),o.d()}}}(this,this._state),this.root._oncreate.push(()=>{this.fire("update",{changed:o({},this._state),current:this._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),x(this))}function tr(t,e){var r=new FileReader;r.onload=function(){try{var a=new Uint8Array(r.result),o="";let s=0;for(var i=0;i<a.length;++i)a[i]>122&&s++,o+=String.fromCharCode(a[i]);let c=n.default.detect(o);c.confidence<=.95&&s<10&&(c.encoding="utf-8"),(r=new FileReader).onload=()=>e(null,r.result),r.readAsText(t,c.encoding)}catch(t){console.warn(t),e(null,r.result)}},r.readAsArrayBuffer(t)}let er;a($n.prototype,T),a(Xn.prototype,T),Xn.prototype._recompute=function(t,e){t.datasets&&this._differs(e.datasetsArray,e.datasetsArray=function({datasets:t}){return Object.keys(t).map(e=>t[e])}(e))&&(t.datasetsArray=!0)},a(Yn.prototype,T);const nr=[{id:"copy",title:Rn("upload / copy-paste"),longTitle:Rn("upload / copy-paste / long"),icon:"fa fa-clipboard",mainPanel:$n,sidebar:Xn,action(){}},{id:"upload",title:Rn("upload / upload-csv"),longTitle:Rn("upload / upload-csv / long"),icon:"fa-file-excel-o fa",mainPanel:$n,sidebar:Xn,isFileUpload:!0,async onFileUpload(t){const e=t.target.files[0];"text/"===e.type.substr(0,5)||".csv"===e.name.substr(e.name.length-4)?(er.set({Sidebar:Xn}),tr(e,async(t,e)=>{if(t)return console.error("could not read file",t);await E.put(`/v3/charts/${dw.backend.currentChart.get("id")}/data`,{body:e,headers:{"Content-Type":"text/csv"}}),window.location.href="describe"})):"application/"===e.type.substr(0,12)?(er.set({Sidebar:Yn,sheets:[]}),function(t,e){const n="undefined"!=typeof FileReader&&(FileReader.prototype||{}).readAsBinaryString,r=new FileReader;r.onload=function(){try{const t=n?r.result:new Uint8Array(r.result),a=XLSX.read(t,{type:n?"binary":"array"});e(null,a.SheetNames.map(t=>({name:t,sheet:a.Sheets[t],csv:XLSX.utils.sheet_to_csv(a.Sheets[t])})))}catch(t){console.error(t),e(null,r.result)}},r.readAsBinaryString(t)}(e,(t,e)=>{if(t)return er.set({error:t});er.set({sheets:e})})):(console.error(e.type),console.error(e),er.set({error:Rn("upload / csv-required")}))},action(){}}];var rr={addButton(t){nr.push(t),this.set({buttons:nr});const{defaultMethod:e}=this.get();t.id===e&&this.btnAction(t)},btnAction(t){if(this.set({active:t}),"external-data"!==t.id){const{dw_chart:t}=this.store.get();t.get("externalData")&&(t.set("externalData",""),setTimeout(()=>{dw.backend.currentChart.save()},1e3))}let e=t.id;"upload"===t.id&&(e="copy",setTimeout(()=>{},1e3));const{dw_chart:n}=this.store.get();n.set("metadata.data.upload-method",e),t.action&&t.action(),t.mainPanel&&this.set({MainPanel:t.mainPanel}),t.sidebar&&this.set({Sidebar:t.sidebar})},btnUpload(t,e){t.onFileUpload&&t.onFileUpload(e)},dragStart(t){const{active:e}=this.get();"copy"===e.id&&(t.preventDefault(),this.set({dragover:!0}))},resetDrag(){this.set({dragover:!1})},onFileDrop(t){const{active:e}=this.get();if("copy"!==e.id)return;this.resetDrag(),t.preventDefault();const n=[];if(t.dataTransfer.items){for(let e=0;e<t.dataTransfer.items.length;e++)"file"===t.dataTransfer.items[e].kind&&n.push(t.dataTransfer.items[e].getAsFile());t.dataTransfer.items.clear()}else{for(let e=0;e<t.dataTransfer.files.length;e++)n.push(t.dataTransfer.files[e]);t.dataTransfer.items.clear()}for(let t=0;t<n.length;t++)if("text/"===n[t].type.substr(0,5))return tr(n[t],async(t,e)=>{if(t)return console.error("could not read file",t);await E.put(`/v3/charts/${dw.backend.currentChart.get("id")}/data`,{body:e,headers:{"Content-Type":"text/csv"}}),window.location.href="describe"})}};function ar(){er=this;const{dw_chart:t}=this.store.get(),e=t.get("metadata.data.upload-method","copy");this.set({defaultMethod:e}),nr.forEach(t=>{t.id===e&&this.set({active:t})})}function or(t){const{component:e,ctx:n}=this._svelte;e.btnAction(n.btn)}function ir(t){const{component:e,ctx:n}=this._svelte;e.btnUpload(n.btn,t)}function sr(t,e,n){const r=Object.create(t);return r.btn=e[n],r}function cr(t,e){var n,r=Rn("upload / drag-csv-here");return{c(){(n=l("div")).className="draginfo svelte-oe6wy4"},m(t,e){s(t,n,e),n.innerHTML=r},d(t){t&&c(n)}}}function ur(t,e){var n;return{c(){(n=l("input"))._svelte={component:t,ctx:e},d(n,"change",ir),n.accept=".csv, .tsv, .txt, .xlsx, .xls, .ods, .dbf",n.className="file-upload svelte-oe6wy4",p(n,"type","file")},m(t,e){s(t,n,e)},p(t,r){e=r,n._svelte.ctx=e},d(t){t&&c(n),h(n,"change",ir)}}}function lr(t,e){var n,r,a,o,u,p,g,y,m,_=e.btn.title,b=e.btn.isFileUpload&&ur(t,e);return{c(){n=l("li"),r=l("label"),b&&b.c(),a=f("\n                            "),o=l("i"),p=f("\n                            "),g=l("span"),y=f(_),o.className=u=e.btn.icon+" svelte-oe6wy4",g.className="svelte-oe6wy4",r.className="svelte-oe6wy4",n._svelte={component:t,ctx:e},d(n,"click",or),n.className=m="action "+(e.active==e.btn?"active":"")+" svelte-oe6wy4"},m(t,e){s(t,n,e),i(n,r),b&&b.m(r,null),i(r,a),i(r,o),i(r,p),i(r,g),i(g,y)},p(i,s){(e=s).btn.isFileUpload?b?b.p(i,e):((b=ur(t,e)).c(),b.m(r,a)):b&&(b.d(1),b=null),i.buttons&&u!==(u=e.btn.icon+" svelte-oe6wy4")&&(o.className=u),i.buttons&&_!==(_=e.btn.title)&&v(y,_),n._svelte.ctx=e,(i.active||i.buttons)&&m!==(m="action "+(e.active==e.btn?"active":"")+" svelte-oe6wy4")&&(n.className=m)},d(t){t&&c(n),b&&b.d(),h(n,"click",or)}}}function fr(t,e){var n,r,a,o;function u(e){t.set({error:!1})}return{c(){n=l("div"),(r=l("div")).textContent="✕",a=f("\n                    "),o=l("noscript"),d(r,"click",u),r.className="action close",n.className="alert alert-error"},m(t,c){s(t,n,c),i(n,r),i(n,a),i(n,o),o.insertAdjacentHTML("afterend",e.error)},p(t,e){t.error&&(!function(t){for(;t.nextSibling;)t.parentNode.removeChild(t.nextSibling)}(o),o.insertAdjacentHTML("afterend",e.error))},d(t){t&&c(n),h(r,"click",u)}}}function dr(t){j(this,t),this._state=a({dragover:!1,MainPanel:$n,Sidebar:Xn,active:nr[0],buttons:nr,sheets:[],chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},t.data),this._intro=!0,this._fragment=function(t,e){for(var n,r,a,o,p,g,y,m,_,b,w,x,D,j,A,S,T,N,k,O,E,C,M=Rn("upload / title"),R=e.active.longTitle||e.active.title,U={},F={},B=Rn("Proceed"),P=e.dragover&&cr(),I=e.buttons,$=[],L=0;L<I.length;L+=1)$[L]=lr(t,sr(e,I,L));var q=e.error&&fr(t,e),H=e.Sidebar;function V(e){var n={};return void 0!==e.chartData&&(n.chartData=e.chartData,U.chartData=!0),void 0!==e.readonly&&(n.readonly=e.readonly,U.readonly=!0),void 0!==e.sheets&&(n.sheets=e.sheets,U.sheets=!0),void 0!==e.datasets&&(n.datasets=e.datasets,U.datasets=!0),{root:t.root,store:t.store,data:n,_bind(e,n){var r={};!U.chartData&&e.chartData&&(r.chartData=n.chartData),!U.readonly&&e.readonly&&(r.readonly=n.readonly),!U.sheets&&e.sheets&&(r.sheets=n.sheets),!U.datasets&&e.datasets&&(r.datasets=n.datasets),t._set(r),U={}}}}if(H){var z=new H(V(e));t.root._beforecreate.push(()=>{z._bind({chartData:1,readonly:1,sheets:1,datasets:1},z.get())})}var X=e.MainPanel;function J(e){var n={};return void 0!==e.chartData&&(n.chartData=e.chartData,F.chartData=!0),void 0!==e.readonly&&(n.readonly=e.readonly,F.readonly=!0),{root:t.root,store:t.store,data:n,_bind(e,n){var r={};!F.chartData&&e.chartData&&(r.chartData=n.chartData),!F.readonly&&e.readonly&&(r.readonly=n.readonly),t._set(r),F={}}}}if(X){var W=new X(J(e));t.root._beforecreate.push(()=>{W._bind({chartData:1,readonly:1},W.get())})}function G(e){t.onFileDrop(e)}function K(e){t.dragStart(e)}function Z(e){t.dragStart(e)}function Q(e){t.resetDrag()}function Y(e){t.resetDrag()}return{c(){n=l("div"),P&&P.c(),r=f("\n\n    \n    "),a=l("div"),o=l("div"),p=l("div"),g=l("h3"),y=f("\n\n                "),m=l("ul");for(var t=0;t<$.length;t+=1)$[t].c();_=f("\n\n                "),q&&q.c(),b=f("\n\n                "),w=l("h4"),x=f(R),D=f("\n\n                "),z&&z._fragment.c(),j=f("\n        "),A=l("div"),W&&W._fragment.c(),S=f("\n\n            "),T=l("div"),N=l("a"),k=f(B),O=f(" "),E=l("i"),m.className="import-methods svelte-oe6wy4",w.className="svelte-oe6wy4",p.className="sidebar",o.className="span5",E.className="icon-chevron-right icon-white",N.href="describe",N.className="submit btn btn-primary svelte-oe6wy4",N.id="describe-proceed",T.className="buttons pull-right",A.className="span7",a.className="row",a.style.cssText=C=e.dragover?"opacity: 0.5;filter:blur(6px);background:white;pointer-events:none":"",d(n,"drop",G),d(n,"dragover",K),d(n,"dragenter",Z),d(n,"dragend",Q),d(n,"dragleave",Y),n.className="chart-editor dw-create-upload upload-data"},m(t,e){s(t,n,e),P&&P.m(n,null),i(n,r),i(n,a),i(a,o),i(o,p),i(p,g),g.innerHTML=M,i(p,y),i(p,m);for(var c=0;c<$.length;c+=1)$[c].m(m,null);i(p,_),q&&q.m(p,null),i(p,b),i(p,w),i(w,x),i(p,D),z&&z._mount(p,null),i(a,j),i(a,A),W&&W._mount(A,null),i(A,S),i(A,T),i(T,N),i(N,k),i(N,O),i(N,E)},p(o,i){if((e=i).dragover?P||((P=cr()).c(),P.m(n,r)):P&&(P.d(1),P=null),o.active||o.buttons){I=e.buttons;for(var s=0;s<I.length;s+=1){const n=sr(e,I,s);$[s]?$[s].p(o,n):($[s]=lr(t,n),$[s].c(),$[s].m(m,null))}for(;s<$.length;s+=1)$[s].d(1);$.length=I.length}e.error?q?q.p(o,e):((q=fr(t,e)).c(),q.m(p,b)):q&&(q.d(1),q=null),o.active&&R!==(R=e.active.longTitle||e.active.title)&&v(x,R);var c={};!U.chartData&&o.chartData&&(c.chartData=e.chartData,U.chartData=void 0!==e.chartData),!U.readonly&&o.readonly&&(c.readonly=e.readonly,U.readonly=void 0!==e.readonly),!U.sheets&&o.sheets&&(c.sheets=e.sheets,U.sheets=void 0!==e.sheets),!U.datasets&&o.datasets&&(c.datasets=e.datasets,U.datasets=void 0!==e.datasets),H!==(H=e.Sidebar)?(z&&z.destroy(),H?(z=new H(V(e)),t.root._beforecreate.push(()=>{const t={};void 0===e.chartData&&(t.chartData=1),void 0===e.readonly&&(t.readonly=1),void 0===e.sheets&&(t.sheets=1),void 0===e.datasets&&(t.datasets=1),z._bind(t,z.get())}),z._fragment.c(),z._mount(p,null)):z=null):H&&(z._set(c),U={});var u={};!F.chartData&&o.chartData&&(u.chartData=e.chartData,F.chartData=void 0!==e.chartData),!F.readonly&&o.readonly&&(u.readonly=e.readonly,F.readonly=void 0!==e.readonly),X!==(X=e.MainPanel)?(W&&W.destroy(),X?(W=new X(J(e)),t.root._beforecreate.push(()=>{const t={};void 0===e.chartData&&(t.chartData=1),void 0===e.readonly&&(t.readonly=1),W._bind(t,W.get())}),W._fragment.c(),W._mount(A,S)):W=null):X&&(W._set(u),F={}),o.dragover&&C!==(C=e.dragover?"opacity: 0.5;filter:blur(6px);background:white;pointer-events:none":"")&&(a.style.cssText=C)},d(t){t&&c(n),P&&P.d(),u($,t),q&&q.d(),z&&z.destroy(),W&&W.destroy(),h(n,"drop",G),h(n,"dragover",K),h(n,"dragenter",Z),h(n,"dragend",Q),h(n,"dragleave",Y)}}}(this,this._state),this.root._oncreate.push(()=>{ar.call(this),this.fire("update",{changed:o({},this._state),current:this._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),x(this))}function hr(t,e){this._handlers={},this._dependents=[],this._computed=m(),this._sortedComputedProperties=[],this._state=a({},t),this._differs=e&&e.immutable?b:_}a(dr.prototype,T),a(dr.prototype,rr),a(hr.prototype,{_add(t,e){this._dependents.push({component:t,props:e})},_init(t){const e={};for(let n=0;n<t.length;n+=1){const r=t[n];e["$"+r]=this._state[r]}return e},_remove(t){let e=this._dependents.length;for(;e--;)if(this._dependents[e].component===t)return void this._dependents.splice(e,1)},_set(t,e){const n=this._state;this._state=a(a({},n),t);for(let t=0;t<this._sortedComputedProperties.length;t+=1)this._sortedComputedProperties[t].update(this._state,e);this.fire("state",{changed:e,previous:n,current:this._state}),this._dependents.filter(t=>{const n={};let r=!1;for(let a=0;a<t.props.length;a+=1){const o=t.props[a];o in e&&(n["$"+o]=this._state[o],r=!0)}if(r)return t.component._stage(n),!0}).forEach(t=>{t.component.set({})}),this.fire("update",{changed:e,previous:n,current:this._state})},_sortComputedProperties(){const t=this._computed,e=this._sortedComputedProperties=[],n=m();let r;function a(o){const i=t[o];i&&(i.deps.forEach(t=>{if(t===r)throw new Error(`Cyclical dependency detected between ${t} <-> ${o}`);a(t)}),n[o]||(n[o]=!0,e.push(i)))}for(const t in this._computed)a(r=t)},compute(t,e,n){let r;const o={deps:e,update:(a,o,i)=>{const s=e.map(t=>(t in o&&(i=!0),a[t]));if(i){const e=n.apply(null,s);this._differs(e,r)&&(r=e,o[t]=!0,a[t]=r)}}};this._computed[t]=o,this._sortComputedProperties();const i=a({},this._state),s={};o.update(i,s,!0),this._set(i,s)},fire:w,get:D,on:A,set(t){const e=this._state,n=this._changed={};let r=!1;for(const a in t){if(this._computed[a])throw new Error(`'${a}' is a read-only computed property`);this._differs(t[a],e[a])&&(n[a]=r=!0)}r&&this._set(t,n)}});return{App:dr,data:{chart:{id:""},readonly:!1,chartData:"",transpose:!1,firstRowIsHeader:!0,skipRows:0},store:new hr({})}}));
