!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("Handsontable"),require("dayjs")):"function"==typeof define&&define.amd?define(["Handsontable","dayjs"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["describe/hot"]=e(t.HOT,t.dayjs)}(this,(function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=n(t),o=n(e);function a(){}function u(t,e){for(var n in e)t[n]=e[n];return t}function i(t,e){for(var n in e)t[n]=1;return t}function s(){return Object.create(null)}function c(t){t._lock=!0,l(t._beforecreate),l(t._oncreate),l(t._aftercreate),t._lock=!1}function l(t){for(;t&&t.length;)t.shift()()}var f={destroy:function(t){this.destroy=a,this.fire("destroy"),this.set=a,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:function(){return this._state},fire:function(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var r=0;r<n.length;r+=1){var o=n[r];if(!o.__calling)try{o.__calling=!0,o.call(this,e)}finally{o.__calling=!1}}},on:function(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}},set:function(t){this._set(u({},t)),this.root._lock||c(this.root)},_recompute:a,_set:function(t){var e=this._state,n={},r=!1;for(var o in t=u(this._staged,t),this._staged={},t)this._differs(t[o],e[o])&&(n[o]=r=!0);r&&(this._state=u(u({},e),t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(this.fire("state",{changed:n,current:this._state,previous:e}),this._fragment.p(n,this._state),this.fire("update",{changed:n,current:this._state,previous:e})))},_stage:function(t){u(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}};const h=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,d=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;function p(t,e){if(null===t)return null;if(void 0!==t){if((t=String(t)).indexOf("<")<0&&t.indexOf(">")<0)return t;if(t=function(t,e){e=(((void 0!==e?e||"":"<a><span><b><br><br/><i><strong><sup><sub><strike><u><em><tt>")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=t,r=t;for(;;)if(r=(n=r).replace(d,"").replace(h,(function(t,n){return e.indexOf("<"+n.toLowerCase()+">")>-1?t:""})),n===r)return r}(t,e),"undefined"==typeof document)return t;var n=document.createElement("div");n.innerHTML=`<span>${t}</span>`;for(var r=n.childNodes[0].querySelectorAll("*"),o=0;o<r.length;o++){if("a"===r[o].nodeName.toLowerCase()){"_self"!==r[o].getAttribute("target")&&r[o].setAttribute("target","_blank"),r[o].setAttribute("rel","nofollow noopener noreferrer");const t=(r[o].getAttribute("href")||"").toLowerCase().replace(/[^a-z0-9 -/:?=]/g,"").trim();(t.startsWith("javascript:")||t.startsWith("vbscript:")||t.startsWith("data:"))&&r[o].setAttribute("href","")}const t=[];for(var a=0;a<r[o].attributes.length;a++){var u=r[o].attributes[a];u.specified&&"on"===u.name.substr(0,2)&&t.push(u.name)}t.forEach(t=>r[o].removeAttribute(t))}return n.childNodes[0].innerHTML}}var v="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},g=Array.prototype,m=Object.prototype,y="undefined"!=typeof Symbol?Symbol.prototype:null,b=g.push,_=g.slice,w=m.toString,C=m.hasOwnProperty,M="undefined"!=typeof ArrayBuffer,R="undefined"!=typeof DataView,S=Array.isArray,j=Object.keys,x=Object.create,N=M&&ArrayBuffer.isView,O=isNaN,A=isFinite,L=!{toString:null}.propertyIsEnumerable("toString"),E=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],I=Math.pow(2,53)-1;function T(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),o=0;o<n;o++)r[o]=arguments[o+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var a=Array(e+1);for(o=0;o<e;o++)a[o]=arguments[o];return a[e]=r,t.apply(this,a)}}function k(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function D(t){return void 0===t}function $(t){return!0===t||!1===t||"[object Boolean]"===w.call(t)}function H(t){var e="[object "+t+"]";return function(t){return w.call(t)===e}}var Y=H("String"),F=H("Number"),B=H("Date"),V=H("RegExp"),q=H("Error"),P=H("Symbol"),z=H("ArrayBuffer"),W=H("Function"),U=v.document&&v.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof U&&(W=function(t){return"function"==typeof t||!1});var G=W,J=H("Object"),K=R&&J(new DataView(new ArrayBuffer(8))),Q="undefined"!=typeof Map&&J(new Map),X=H("DataView");var Z=K?function(t){return null!=t&&G(t.getInt8)&&z(t.buffer)}:X,tt=S||H("Array");function et(t,e){return null!=t&&C.call(t,e)}var nt=H("Arguments");!function(){nt(arguments)||(nt=function(t){return et(t,"callee")})}();var rt=nt;function ot(t){return F(t)&&O(t)}function at(t){return function(){return t}}function ut(t){return function(e){var n=t(e);return"number"==typeof n&&n>=0&&n<=I}}function it(t){return function(e){return null==e?void 0:e[t]}}var st=it("byteLength"),ct=ut(st),lt=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var ft=M?function(t){return N?N(t)&&!Z(t):ct(t)&&lt.test(w.call(t))}:at(!1),ht=it("length");function dt(t,e){e=function(t){for(var e={},n=t.length,r=0;r<n;++r)e[t[r]]=!0;return{contains:function(t){return e[t]},push:function(n){return e[n]=!0,t.push(n)}}}(e);var n=E.length,r=t.constructor,o=G(r)&&r.prototype||m,a="constructor";for(et(t,a)&&!e.contains(a)&&e.push(a);n--;)(a=E[n])in t&&t[a]!==o[a]&&!e.contains(a)&&e.push(a)}function pt(t){if(!k(t))return[];if(j)return j(t);var e=[];for(var n in t)et(t,n)&&e.push(n);return L&&dt(t,e),e}function vt(t,e){var n=pt(e),r=n.length;if(null==t)return!r;for(var o=Object(t),a=0;a<r;a++){var u=n[a];if(e[u]!==o[u]||!(u in o))return!1}return!0}function gt(t){return t instanceof gt?t:this instanceof gt?void(this._wrapped=t):new gt(t)}function mt(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,st(t))}gt.VERSION="1.13.1",gt.prototype.value=function(){return this._wrapped},gt.prototype.valueOf=gt.prototype.toJSON=gt.prototype.value,gt.prototype.toString=function(){return String(this._wrapped)};function yt(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var o=typeof t;return("function"===o||"object"===o||"object"==typeof e)&&function t(e,n,r,o){e instanceof gt&&(e=e._wrapped);n instanceof gt&&(n=n._wrapped);var a=w.call(e);if(a!==w.call(n))return!1;if(K&&"[object Object]"==a&&Z(e)){if(!Z(n))return!1;a="[object DataView]"}switch(a){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return y.valueOf.call(e)===y.valueOf.call(n);case"[object ArrayBuffer]":case"[object DataView]":return t(mt(e),mt(n),r,o)}var u="[object Array]"===a;if(!u&&ft(e)){if(st(e)!==st(n))return!1;if(e.buffer===n.buffer&&e.byteOffset===n.byteOffset)return!0;u=!0}if(!u){if("object"!=typeof e||"object"!=typeof n)return!1;var i=e.constructor,s=n.constructor;if(i!==s&&!(G(i)&&i instanceof i&&G(s)&&s instanceof s)&&"constructor"in e&&"constructor"in n)return!1}o=o||[];var c=(r=r||[]).length;for(;c--;)if(r[c]===e)return o[c]===n;if(r.push(e),o.push(n),u){if((c=e.length)!==n.length)return!1;for(;c--;)if(!yt(e[c],n[c],r,o))return!1}else{var l,f=pt(e);if(c=f.length,pt(n).length!==c)return!1;for(;c--;)if(l=f[c],!et(n,l)||!yt(e[l],n[l],r,o))return!1}return r.pop(),o.pop(),!0}(t,e,n,r)}function bt(t){if(!k(t))return[];var e=[];for(var n in t)e.push(n);return L&&dt(t,e),e}function _t(t){var e=ht(t);return function(n){if(null==n)return!1;var r=bt(n);if(ht(r))return!1;for(var o=0;o<e;o++)if(!G(n[t[o]]))return!1;return t!==St||!G(n[wt])}}var wt="forEach",Ct=["clear","delete"],Mt=["get","has","set"],Rt=Ct.concat(wt,Mt),St=Ct.concat(Mt),jt=["add"].concat(Ct,wt,"has"),xt=Q?_t(Rt):H("Map"),Nt=Q?_t(St):H("WeakMap"),Ot=Q?_t(jt):H("Set"),At=H("WeakSet");function Lt(t){for(var e=pt(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t[e[o]];return r}function Et(t){for(var e={},n=pt(t),r=0,o=n.length;r<o;r++)e[t[n[r]]]=n[r];return e}function It(t){var e=[];for(var n in t)G(t[n])&&e.push(n);return e.sort()}function Tt(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var o=1;o<r;o++)for(var a=arguments[o],u=t(a),i=u.length,s=0;s<i;s++){var c=u[s];e&&void 0!==n[c]||(n[c]=a[c])}return n}}var kt=Tt(bt),Dt=Tt(pt),$t=Tt(bt,!0);function Ht(t){if(!k(t))return{};if(x)return x(t);var e=function(){};e.prototype=t;var n=new e;return e.prototype=null,n}function Yt(t){return k(t)?tt(t)?t.slice():kt({},t):t}function Ft(t){return tt(t)?t:[t]}function Bt(t){return gt.toPath(t)}function Vt(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0}function qt(t,e,n){var r=Vt(t,Bt(e));return D(r)?n:r}function Pt(t){return t}function zt(t){return t=Dt({},t),function(e){return vt(e,t)}}function Wt(t){return t=Bt(t),function(e){return Vt(e,t)}}function Ut(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,a){return t.call(e,n,r,o,a)}}return function(){return t.apply(e,arguments)}}function Gt(t,e,n){return null==t?Pt:G(t)?Ut(t,e,n):k(t)&&!tt(t)?zt(t):Wt(t)}function Jt(t,e){return Gt(t,e,1/0)}function Kt(t,e,n){return gt.iteratee!==Jt?gt.iteratee(t,e):Gt(t,e,n)}function Qt(){}function Xt(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}gt.toPath=Ft,gt.iteratee=Jt;var Zt=Date.now||function(){return(new Date).getTime()};function te(t){var e=function(e){return t[e]},n="(?:"+pt(t).join("|")+")",r=RegExp(n),o=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(o,e):t}}var ee={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},ne=te(ee),re=te(Et(ee)),oe=gt.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},ae=/(.)^/,ue={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},ie=/\\|'|\r|\n|\u2028|\u2029/g;function se(t){return"\\"+ue[t]}var ce=/^\s*(\w|\$)+\s*$/;var le=0;function fe(t,e,n,r,o){if(!(r instanceof e))return t.apply(n,o);var a=Ht(t.prototype),u=t.apply(a,o);return k(u)?u:a}var he=T((function(t,e){var n=he.placeholder,r=function(){for(var o=0,a=e.length,u=Array(a),i=0;i<a;i++)u[i]=e[i]===n?arguments[o++]:e[i];for(;o<arguments.length;)u.push(arguments[o++]);return fe(t,r,this,this,u)};return r}));he.placeholder=gt;var de=T((function(t,e,n){if(!G(t))throw new TypeError("Bind must be called on a function");var r=T((function(o){return fe(t,r,e,this,n.concat(o))}));return r})),pe=ut(ht);function ve(t,e,n,r){if(r=r||[],e||0===e){if(e<=0)return r.concat(t)}else e=1/0;for(var o=r.length,a=0,u=ht(t);a<u;a++){var i=t[a];if(pe(i)&&(tt(i)||rt(i)))if(e>1)ve(i,e-1,n,r),o=r.length;else for(var s=0,c=i.length;s<c;)r[o++]=i[s++];else n||(r[o++]=i)}return r}var ge=T((function(t,e){var n=(e=ve(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=de(t[r],t)}return t}));var me=T((function(t,e,n){return setTimeout((function(){return t.apply(null,n)}),e)})),ye=he(me,gt,1);function be(t){return function(){return!t.apply(this,arguments)}}function _e(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}var we=he(_e,2);function Ce(t,e,n){e=Kt(e,n);for(var r,o=pt(t),a=0,u=o.length;a<u;a++)if(e(t[r=o[a]],r,t))return r}function Me(t){return function(e,n,r){n=Kt(n,r);for(var o=ht(e),a=t>0?0:o-1;a>=0&&a<o;a+=t)if(n(e[a],a,e))return a;return-1}}var Re=Me(1),Se=Me(-1);function je(t,e,n,r){for(var o=(n=Kt(n,r,1))(e),a=0,u=ht(t);a<u;){var i=Math.floor((a+u)/2);n(t[i])<o?a=i+1:u=i}return a}function xe(t,e,n){return function(r,o,a){var u=0,i=ht(r);if("number"==typeof a)t>0?u=a>=0?a:Math.max(a+i,u):i=a>=0?Math.min(a+1,i):a+i+1;else if(n&&a&&i)return r[a=n(r,o)]===o?a:-1;if(o!=o)return(a=e(_.call(r,u,i),ot))>=0?a+u:-1;for(a=t>0?u:i-1;a>=0&&a<i;a+=t)if(r[a]===o)return a;return-1}}var Ne=xe(1,Re,je),Oe=xe(-1,Se);function Ae(t,e,n){var r=(pe(t)?Re:Ce)(t,e,n);if(void 0!==r&&-1!==r)return t[r]}function Le(t,e,n){var r,o;if(e=Ut(e,n),pe(t))for(r=0,o=t.length;r<o;r++)e(t[r],r,t);else{var a=pt(t);for(r=0,o=a.length;r<o;r++)e(t[a[r]],a[r],t)}return t}function Ee(t,e,n){e=Kt(e,n);for(var r=!pe(t)&&pt(t),o=(r||t).length,a=Array(o),u=0;u<o;u++){var i=r?r[u]:u;a[u]=e(t[i],i,t)}return a}function Ie(t){var e=function(e,n,r,o){var a=!pe(e)&&pt(e),u=(a||e).length,i=t>0?0:u-1;for(o||(r=e[a?a[i]:i],i+=t);i>=0&&i<u;i+=t){var s=a?a[i]:i;r=n(r,e[s],s,e)}return r};return function(t,n,r,o){var a=arguments.length>=3;return e(t,Ut(n,o,4),r,a)}}var Te=Ie(1),ke=Ie(-1);function De(t,e,n){var r=[];return e=Kt(e,n),Le(t,(function(t,n,o){e(t,n,o)&&r.push(t)})),r}function $e(t,e,n){e=Kt(e,n);for(var r=!pe(t)&&pt(t),o=(r||t).length,a=0;a<o;a++){var u=r?r[a]:a;if(!e(t[u],u,t))return!1}return!0}function He(t,e,n){e=Kt(e,n);for(var r=!pe(t)&&pt(t),o=(r||t).length,a=0;a<o;a++){var u=r?r[a]:a;if(e(t[u],u,t))return!0}return!1}function Ye(t,e,n,r){return pe(t)||(t=Lt(t)),("number"!=typeof n||r)&&(n=0),Ne(t,e,n)>=0}var Fe=T((function(t,e,n){var r,o;return G(e)?o=e:(e=Bt(e),r=e.slice(0,-1),e=e[e.length-1]),Ee(t,(function(t){var a=o;if(!a){if(r&&r.length&&(t=Vt(t,r)),null==t)return;a=t[e]}return null==a?a:a.apply(t,n)}))}));function Be(t,e){return Ee(t,Wt(e))}function Ve(t,e,n){var r,o,a=-1/0,u=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var i=0,s=(t=pe(t)?t:Lt(t)).length;i<s;i++)null!=(r=t[i])&&r>a&&(a=r);else e=Kt(e,n),Le(t,(function(t,n,r){((o=e(t,n,r))>u||o===-1/0&&a===-1/0)&&(a=t,u=o)}));return a}function qe(t,e,n){if(null==e||n)return pe(t)||(t=Lt(t)),t[Xt(t.length-1)];var r=pe(t)?Yt(t):Lt(t),o=ht(r);e=Math.max(Math.min(e,o),0);for(var a=o-1,u=0;u<e;u++){var i=Xt(u,a),s=r[u];r[u]=r[i],r[i]=s}return r.slice(0,e)}function Pe(t,e){return function(n,r,o){var a=e?[[],[]]:{};return r=Kt(r,o),Le(n,(function(e,o){var u=r(e,o,n);t(a,e,u)})),a}}var ze=Pe((function(t,e,n){et(t,n)?t[n].push(e):t[n]=[e]})),We=Pe((function(t,e,n){t[n]=e})),Ue=Pe((function(t,e,n){et(t,n)?t[n]++:t[n]=1})),Ge=Pe((function(t,e,n){t[n?0:1].push(e)}),!0),Je=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Ke(t,e,n){return e in n}var Qe=T((function(t,e){var n={},r=e[0];if(null==t)return n;G(r)?(e.length>1&&(r=Ut(r,e[1])),e=bt(t)):(r=Ke,e=ve(e,!1,!1),t=Object(t));for(var o=0,a=e.length;o<a;o++){var u=e[o],i=t[u];r(i,u,t)&&(n[u]=i)}return n})),Xe=T((function(t,e){var n,r=e[0];return G(r)?(r=be(r),e.length>1&&(n=e[1])):(e=Ee(ve(e,!1,!1),String),r=function(t,n){return!Ye(e,n)}),Qe(t,r,n)}));function Ze(t,e,n){return _.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function tn(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:Ze(t,t.length-e)}function en(t,e,n){return _.call(t,null==e||n?1:e)}var nn=T((function(t,e){return e=ve(e,!0,!0),De(t,(function(t){return!Ye(e,t)}))})),rn=T((function(t,e){return nn(t,e)}));function on(t,e,n,r){$(e)||(r=n,n=e,e=!1),null!=n&&(n=Kt(n,r));for(var o=[],a=[],u=0,i=ht(t);u<i;u++){var s=t[u],c=n?n(s,u,t):s;e&&!n?(u&&a===c||o.push(s),a=c):n?Ye(a,c)||(a.push(c),o.push(s)):Ye(o,s)||o.push(s)}return o}var an=T((function(t){return on(ve(t,!0,!0))}));function un(t){for(var e=t&&Ve(t,ht).length||0,n=Array(e),r=0;r<e;r++)n[r]=Be(t,r);return n}var sn=T(un);function cn(t,e){return t._chain?gt(e).chain():e}function ln(t){return Le(It(t),(function(e){var n=gt[e]=t[e];gt.prototype[e]=function(){var t=[this._wrapped];return b.apply(t,arguments),cn(this,n.apply(gt,t))}})),gt}Le(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=g[t];gt.prototype[t]=function(){var n=this._wrapped;return null!=n&&(e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0]),cn(this,n)}})),Le(["concat","join","slice"],(function(t){var e=g[t];gt.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),cn(this,t)}}));var fn=ln(Object.freeze({__proto__:null,VERSION:"1.13.1",restArguments:T,isObject:k,isNull:function(t){return null===t},isUndefined:D,isBoolean:$,isElement:function(t){return!(!t||1!==t.nodeType)},isString:Y,isNumber:F,isDate:B,isRegExp:V,isError:q,isSymbol:P,isArrayBuffer:z,isDataView:Z,isArray:tt,isFunction:G,isArguments:rt,isFinite:function(t){return!P(t)&&A(t)&&!isNaN(parseFloat(t))},isNaN:ot,isTypedArray:ft,isEmpty:function(t){if(null==t)return!0;var e=ht(t);return"number"==typeof e&&(tt(t)||Y(t)||rt(t))?0===e:0===ht(pt(t))},isMatch:vt,isEqual:function(t,e){return yt(t,e)},isMap:xt,isWeakMap:Nt,isSet:Ot,isWeakSet:At,keys:pt,allKeys:bt,values:Lt,pairs:function(t){for(var e=pt(t),n=e.length,r=Array(n),o=0;o<n;o++)r[o]=[e[o],t[e[o]]];return r},invert:Et,functions:It,methods:It,extend:kt,extendOwn:Dt,assign:Dt,defaults:$t,create:function(t,e){var n=Ht(t);return e&&Dt(n,e),n},clone:Yt,tap:function(t,e){return e(t),t},get:qt,has:function(t,e){for(var n=(e=Bt(e)).length,r=0;r<n;r++){var o=e[r];if(!et(t,o))return!1;t=t[o]}return!!n},mapObject:function(t,e,n){e=Kt(e,n);for(var r=pt(t),o=r.length,a={},u=0;u<o;u++){var i=r[u];a[i]=e(t[i],i,t)}return a},identity:Pt,constant:at,noop:Qt,toPath:Ft,property:Wt,propertyOf:function(t){return null==t?Qt:function(e){return qt(t,e)}},matcher:zt,matches:zt,times:function(t,e,n){var r=Array(Math.max(0,t));e=Ut(e,n,1);for(var o=0;o<t;o++)r[o]=e(o);return r},random:Xt,now:Zt,escape:ne,unescape:re,templateSettings:oe,template:function(t,e,n){!e&&n&&(e=n),e=$t({},e,gt.templateSettings);var r=RegExp([(e.escape||ae).source,(e.interpolate||ae).source,(e.evaluate||ae).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(r,(function(e,n,r,u,i){return a+=t.slice(o,i).replace(ie,se),o=i+e.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?a+="'+\n((__t=("+r+"))==null?'':__t)+\n'":u&&(a+="';\n"+u+"\n__p+='"),e})),a+="';\n";var u,i=e.variable;if(i){if(!ce.test(i))throw new Error("variable is not a bare identifier: "+i)}else a="with(obj||{}){\n"+a+"}\n",i="obj";a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{u=new Function(i,"_",a)}catch(t){throw t.source=a,t}var s=function(t){return u.call(this,t,gt)};return s.source="function("+i+"){\n"+a+"}",s},result:function(t,e,n){var r=(e=Bt(e)).length;if(!r)return G(n)?n.call(t):n;for(var o=0;o<r;o++){var a=null==t?void 0:t[e[o]];void 0===a&&(a=n,o=r),t=G(a)?a.call(t):a}return t},uniqueId:function(t){var e=++le+"";return t?t+e:e},chain:function(t){var e=gt(t);return e._chain=!0,e},iteratee:Jt,partial:he,bind:de,bindAll:ge,memoize:function(t,e){var n=function(r){var o=n.cache,a=""+(e?e.apply(this,arguments):r);return et(o,a)||(o[a]=t.apply(this,arguments)),o[a]};return n.cache={},n},delay:me,defer:ye,throttle:function(t,e,n){var r,o,a,u,i=0;n||(n={});var s=function(){i=!1===n.leading?0:Zt(),r=null,u=t.apply(o,a),r||(o=a=null)},c=function(){var c=Zt();i||!1!==n.leading||(i=c);var l=e-(c-i);return o=this,a=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),i=c,u=t.apply(o,a),r||(o=a=null)):r||!1===n.trailing||(r=setTimeout(s,l)),u};return c.cancel=function(){clearTimeout(r),i=0,r=o=a=null},c},debounce:function(t,e,n){var r,o,a,u,i,s=function(){var c=Zt()-o;e>c?r=setTimeout(s,e-c):(r=null,n||(u=t.apply(i,a)),r||(a=i=null))},c=T((function(c){return i=this,a=c,o=Zt(),r||(r=setTimeout(s,e),n&&(u=t.apply(i,a))),u}));return c.cancel=function(){clearTimeout(r),r=a=i=null},c},wrap:function(t,e){return he(e,t)},negate:be,compose:function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:_e,once:we,findKey:Ce,findIndex:Re,findLastIndex:Se,sortedIndex:je,indexOf:Ne,lastIndexOf:Oe,find:Ae,detect:Ae,findWhere:function(t,e){return Ae(t,zt(e))},each:Le,forEach:Le,map:Ee,collect:Ee,reduce:Te,foldl:Te,inject:Te,reduceRight:ke,foldr:ke,filter:De,select:De,reject:function(t,e,n){return De(t,be(Kt(e)),n)},every:$e,all:$e,some:He,any:He,contains:Ye,includes:Ye,include:Ye,invoke:Fe,pluck:Be,where:function(t,e){return De(t,zt(e))},max:Ve,min:function(t,e,n){var r,o,a=1/0,u=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var i=0,s=(t=pe(t)?t:Lt(t)).length;i<s;i++)null!=(r=t[i])&&r<a&&(a=r);else e=Kt(e,n),Le(t,(function(t,n,r){((o=e(t,n,r))<u||o===1/0&&a===1/0)&&(a=t,u=o)}));return a},shuffle:function(t){return qe(t,1/0)},sample:qe,sortBy:function(t,e,n){var r=0;return e=Kt(e,n),Be(Ee(t,(function(t,n,o){return{value:t,index:r++,criteria:e(t,n,o)}})).sort((function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index})),"value")},groupBy:ze,indexBy:We,countBy:Ue,partition:Ge,toArray:function(t){return t?tt(t)?_.call(t):Y(t)?t.match(Je):pe(t)?Ee(t,Pt):Lt(t):[]},size:function(t){return null==t?0:pe(t)?t.length:pt(t).length},pick:Qe,omit:Xe,first:tn,head:tn,take:tn,initial:Ze,last:function(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:en(t,Math.max(0,t.length-e))},rest:en,tail:en,drop:en,compact:function(t){return De(t,Boolean)},flatten:function(t,e){return ve(t,e,!1)},without:rn,uniq:on,unique:on,union:an,intersection:function(t){for(var e=[],n=arguments.length,r=0,o=ht(t);r<o;r++){var a=t[r];if(!Ye(e,a)){var u;for(u=1;u<n&&Ye(arguments[u],a);u++);u===n&&e.push(a)}}return e},difference:nn,unzip:un,transpose:un,zip:sn,object:function(t,e){for(var n={},r=0,o=ht(t);r<o;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},range:function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),o=Array(r),a=0;a<r;a++,t+=n)o[a]=t;return o},chunk:function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,o=t.length;r<o;)n.push(_.call(t,r,r+=e));return n},mixin:ln,default:gt}));function hn(t){if(!t.format())return Pt;switch(t.precision()){case"year":return function(t){return B(t)?t.getFullYear():t};case"half":return function(t){return B(t)?t.getFullYear()+" H"+(t.getMonth()/6+1):t};case"quarter":return function(t){return B(t)?t.getFullYear()+" Q"+(t.getMonth()/3+1):t};case"month":return function(t){return B(t)?dn(t,"MMM YY"):t};case"week":return function(t){return B(t)?function(t){const e=t.getUTCDay(),n=new Date(t.valueOf());n.setDate(n.getDate()-(e+6)%7+3);const r=n.getUTCFullYear(),o=Math.floor((n.getTime()-new Date(r,0,1,-6))/864e5);return[r,1+Math.floor(o/7),e>0?e:7]}(t).slice(0,2).join(" W"):t};case"day":return function(t,e){return B(t)?dn(t,e?"dddd, MMMM DD, YYYY":"l"):t};case"day-minutes":return function(t,e){return B(t)?dn(t,"MMM DD"+(e?", YYYY":"")).replace(/ /g,"&nbsp;")+" - "+dn(t,"LT").replace(" ","&nbsp;"):t};case"day-seconds":return function(t,e){return B(t)?(e?dn(t,"MMM DD, YYYY").replace(/ /g,"&nbsp;")+" - ":"")+dn(t,"LTS").replace(" ","&nbsp;"):t}}}function dn(t,e){const n=o.default.locale();o.default.locale("en");const r=o.default(t).format(e);return o.default.locale(n),r}fn._=fn;const pn=new Set(["฿","₿","¢","$","€","eur","£","gbp","¥","yen","usd","cad","us$","ca$","can$"]);function vn(t,e){return Math.abs(t-e)<1e-6}function gn(t,e){const n=e["number-format"]||"-",r=Number(e["number-divisor"]||0),o=(e["number-append"]||"").replace(/ /g," "),a=(e["number-prepend"]||"").replace(/ /g," ");return function(e,u,i){if(isNaN(e))return e;var s,c,l=n,f=0;0!==r&&"-"===l&&(f=1),"s"===l.substr(0,1)&&(f=Math.max(0,(s=e,c=+l.substr(1),0===s?0:Math.round(c-Math.ceil(Math.log(Math.abs(s))/Math.LN10))))),i&&(f=0),"-"===l&&(f=vn(e,Math.round(e))?0:vn(e,.1*Math.round(10*e))?1:vn(e,.01*Math.round(100*e))?2:vn(e,.001*Math.round(1e3*e))?3:vn(e,1e-4*Math.round(1e4*e))?4:vn(e,1e-5*Math.round(1e5*e))?5:6),"n"===l[0]&&(f=Number(l.substr(1,l.length)));let h="0,0";for(var d=0;d<f;d++)0===d&&(h+="."),h+="0";return function(t,e,n){if(n={format:"0.[00]",prepend:"",append:"",minusChar:"−",plusMinusChar:"±",multiply:1,...n},void 0===e||isNaN(e)||""===e||null===e)return"";const{append:r,prepend:o,minusChar:a,plusMinusChar:u,multiply:i}=n;let{format:s}=n;s.includes("%")&&Number.isFinite(e)&&(e*=.01),e*=i;const c=s.indexOf("(")>-1,l=s.indexOf(";")>-1;s=s.replace(/;/g,",");let f=t(c?e:Math.abs(e)).format(s);if(l){const n=t.options.currentLocale,r=t.locales[n].delimiters.thousands,o=s.includes("%")?e/.01:e;f=Math.abs(o)<1e4?f.replace(r,""):f}return o&&!c&&e<0&&pn.has(o.trim().toLowerCase())?`${a}${o}${f.replace("+","")}${r}`:o&&e>=0&&pn.has(o.trim().toLowerCase())&&s.includes("+")?`${0===e?u:"+"}${o}${f.replace("+","")}${r}`:0===e&&s.includes("+")?`${o}${f.replace("+",u)}${r}`:e<0&&!c?`${o}${a}${f.replace("+","")}${r}`:`${o}${f}${r}`}(t,e,{format:h,prepend:u?a:"",append:u?o:"",multiply:Math.pow(10,-1*r)})}}const mn=t=>t;function yn(t,e,n,r){return"date"===e.type()?hn(e.type(!0)):"number"===e.type()?gn(t,function(t,e=null,n=null){if(!e)return t;const r=Array.isArray(e)?e:e.split(".");let o=t;for(let t=0;t<r.length&&null!=o;t++)o=o[r[t]];return null==o?n:o}(n,"data.column-format."+r,{})):mn}function bn(t,e,n,r){const{numeral:o}=dw.visualization.libraries,a={date:"fa fa-clock-o"};return function(u,i,s,c,l,f,h){if(n.numColumns()<=c||!n.hasColumn(c))return;const d=n.column(c),{searchResults:v,currentResult:g,activeColumn:m}=t.get(),y=t.getColumnFormat(d.name());if((s=u.toPhysicalRow(s))>0){var b=yn(o,d,e.get().metadata,d.name());f=null===d.val(s-1)||""===d.val(s-1)?"–":b(d.val(s-1),!0)}parseInt(f)<0&&i.classList.add("negative"),i.classList.add(d.type()+"Type"),i.dataset.column=c,"text"===d.type()&&f&&f.length>70&&(f=f.substr(0,60)+"…"),0===s?(i.classList.add("firstRow"),a[d.type()]&&(f='<i class="'+a[d.type()]+'"></i> '+f)):i.classList.add(s%2?"oddRow":"evenRow"),y.ignore&&i.classList.add("ignored"),m&&m.name()===d.name()&&i.classList.add("active");const _=r.hooks.run(u,"modifyRow",s);v.forEach(t=>{t.row===_&&t.col===c&&i.classList.add("htSearchResult")}),g&&g.row===_&&g.col===c&&i.classList.add("htCurrentSearchResult"),s>0&&!d.type(!0).isValid(d.val(s-1))&&null!==d.val(s-1)&&""!==d.val(s-1)&&i.classList.add("parsingError"),s>0&&(null===d.val(s-1)||""===d.val(s-1))&&i.classList.add("noData"),d.isComputed&&d.errors.length&&d.errors.find(t=>"all"===t.row||t.row===s-1)&&i.classList.add("parsingError"),h.readOnly&&i.classList.add("readOnly"),e.dataCellChanged(c,s)&&i.classList.add("changed"),function(t,e,n,o,a,u){var i=p(r.helper.stringify(u));e.innerHTML=i}(0,i,0,0,0,f)}}function _n(t){if(!t||"object"!=typeof t)return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}let wn=null,Cn=null;var Mn={render(){const{hot:t}=this.get();t.render()},doSearch(){const{hot:t,search:e}=this.get();clearTimeout(Cn),Cn=setTimeout(()=>{if(t&&e){const n=t.getPlugin("search").query(e);this.set({searchResults:n})}else this.set({searchResults:[]})},300)},update(){const{data:t,transpose:e,firstRowIsHeader:n,skipRows:o,hot:a}=this.get();if(!t)return;const{dw_chart:u}=this.store.get(),i=u.dataset(dw.datasource.delimited({csv:t,transpose:e,firstRowIsHeader:n,skipRows:o}).parse()).dataset();this.set({columnOrder:i.columnOrder()});const s=[[]];i.eachColumn(t=>s[0].push(t.title())),i.eachRow(t=>{const e=[];i.eachColumn(n=>e.push(n.raw(t))),s.push(e)}),a.loadData(s);const c=bn(this,u,i,r.default);a.updateSettings({cells:(t,e)=>{const{readonly:n}=this.get();return{readOnly:n||i.hasColumn(e)&&i.column(e).isComputed&&0===t,renderer:c}},manualColumnMove:[]}),this.set({ds:i}),this.set({has_changes:_n(chart.get("metadata.data.changes",[])).length>0}),r.default.hooks.once("afterRender",()=>this.initCustomEvents()),r.default.hooks.once("afterRender",()=>this.fire("afterRender")),a.render()},dataChanged(t){const{hot:e}=this.get();let n=!1;t.forEach(([t,r,o,a])=>{if(o!==a){const u=this.store.get().dw_chart,{transpose:i}=this.get(),s=_n(u.get("metadata.data.changes",[]));if(t=e.toPhysicalRow(t),r=u.dataset().columnOrder()[r],i){const e=t;t=r,r=e}s.push({column:r,row:t,value:a,previous:o,time:(new Date).getTime()}),u.set("metadata.data.changes",s),n=!0}}),n&&setTimeout(()=>{this.update(),chart.save()},100)},columnMoved(t,e){const{hot:n}=this.get();if(!t.length)return;const{columnOrder:o}=this.get(),a=o.slice(0),u=o[e],i=a.splice(t[0],t.length),s=void 0===u?a.length:u?a.indexOf(u):0;a.splice(s,0,...i),this.store.get().dw_chart.set("metadata.data.column-order",a.slice(0)),this.set({columnOrder:a}),r.default.hooks.once("afterRender",()=>{setTimeout(()=>{this.fire("resetSort"),n.selectCell(0,s,n.countRows()-1,s+i.length-1)},10)}),this.update()},updateHeight(){const t=document.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(500,t+10)+"px"},checkRange(t,e,n,r){const{hot:o}=this.get(),{ds:a}=this.get();if(e!==r||0!==t||n!==o.countRows()-1)if(e===r||0!==t||n!==o.countRows()-1)this.set({activeColumn:null,multiSelection:!1});else{const t=[];for(let n=Math.min(e,r);n<=Math.max(e,r);n++)t.push(+document.querySelector(`#data-preview .htCore tbody tr:first-child td:nth-child(${n+2})`).dataset.column);this.set({multiSelection:t.map(t=>a.column(t)),activeColumn:null})}},initCustomEvents(){setTimeout(()=>{this.refs.hot.querySelectorAll(".htCore thead th:first-child").forEach(t=>{t.removeEventListener("click",xn),t.addEventListener("click",xn)}),this.refs.hot.querySelectorAll(".htCore thead th+th").forEach(t=>{t.removeEventListener("click",jn),t.addEventListener("click",jn)})},500)},getColumnFormat(t){const{dw_chart:e}=this.store.get();return e.get("metadata.data.column-format",{})[t]||{type:"auto",ignore:!1}}};function Rn(){wn=this,r.default.hooks.once("afterRender",()=>this.initCustomEvents()),window.addEventListener("keyup",t=>{const{activeColumn:e,ds:n}=this.get();if(e&&"input"!==t.target.tagName.toLowerCase()&&"textarea"!==t.target.tagName.toLowerCase()&&("ArrowRight"===t.key||"ArrowLeft"===t.key)){t.preventDefault(),t.stopPropagation();const r=n.indexOf(e.name());"ArrowRight"===t.key?this.set({activeColumn:n.column((r+1)%n.numColumns())}):this.set({activeColumn:n.column((r-1+n.numColumns())%n.numColumns())})}});const{dw_chart:t}=this.store.get(),e=new r.default(this.refs.hot,{data:[],rowHeaders:t=>r.default.hooks.run(e,"modifyRow",t)+1,colHeaders:!0,fixedRowsTop:1,fixedColumnsLeft:this.get().fixedColumnsLeft,filters:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:500,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0,syncLimit:5},sortIndicator:!0,columnSorting:!0,sortFunction:function(e,n){if(n.col>-1){const r=t.dataset().column(n.col),o=r.type();return(t,n)=>0===t[0]?-1:(t[1]=r.val(t[0]-1),n[1]=r.val(n[0]-1),"number"===o&&(isNaN(t[1])&&(t[1]=e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),isNaN(n[1])&&(n[1]=e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY)),"date"===o&&("string"==typeof t[1]&&(t[1]=new Date(110,0,1)),"string"==typeof n[1]&&(n[1]=new Date(110,0,1))),("desc"===e?-1:1)*(t[1]>n[1]?1:t[1]<n[1]?-1:0))}return(t,e)=>t[0]-e[0]},afterGetColHeader:(t,e)=>{const{activeColumn:n,ds:r}=this.get();r&&r.hasColumn(t)&&((0===t||t)&&n&&r.column(t).name()===n.name()&&e.classList.add("selected"),(0===t||t)&&(this.getColumnFormat(r.column(t).name()).ignore?e.classList.add("ignored"):e.classList.remove("ignored")))},search:"search"});window.HT=e,this.set({hot:e}),r.default.hooks.add("afterSetDataAtCell",t=>this.dataChanged(t)),r.default.hooks.add("afterColumnMove",(t,e)=>this.columnMoved(t,e)),r.default.hooks.add("afterRender",()=>this.updateHeight()),r.default.hooks.add("afterSelection",(t,e,n,r)=>this.checkRange(t,e,n,r))}function Sn({changed:t,current:e,previous:n}){const r=e.hot;if(r){if(t.data&&this.update(),t.firstRowIsHeader&&n&&void 0!==n.firstRowIsHeader&&this.update(),t.hot&&this.update(),t.search&&n&&(this.doSearch(),this.set({searchIndex:0})),t.searchResults&&r.render(),t.currentResult&&e.currentResult){r.render();const t=e.currentResult;r.scrollViewportTo(t.row,t.col),setTimeout(()=>{r.scrollViewportTo(t.row,t.col)},100)}t.activeColumn&&setTimeout(()=>r.render(),10),t.fixedColumnsLeft&&r.updateSettings({fixedColumnsLeft:e.fixedColumnsLeft}),t.sorting&&r.getPlugin("columnSorting").sort(chart.dataset().indexOf(e.sorting.sortBy),e.sorting.sortDir?"asc":"desc")}}function jn(t){const e=this,n=e.parentNode.children.length;let r=-1;for(let t=0;t<n;t++)if(e.parentNode.children.item(t)===e){r=t;break}const o=+wn.refs.hot.querySelector(`.htCore tbody tr:first-child td:nth-child(${r+1})`).dataset.column,{dw_chart:a}=wn.store.get(),{activeColumn:u,hot:i}=wn.get();if(a.dataset().hasColumn(o)){const e=a.dataset().column(+o);u&&u.name()===e.name()?(t.target.parentNode.classList.remove("selected"),wn.set({activeColumn:!1}),i.deselectCell()):(t.target.parentNode.classList.add("selected"),wn.set({activeColumn:e}))}}function xn(t){t.preventDefault();const{transpose:e}=wn.get();wn.set({transpose:!e}),wn.update()}function Nn(t,e){var n;return{c(){var t;t="div",(n=document.createElement(t)).id="data-preview"},m(e,r){!function(t,e,n){t.insertBefore(e,n)}(e,n,r),t.refs.hot=n},p:a,d(e){var r;e&&(r=n).parentNode.removeChild(r),t.refs.hot===n&&(t.refs.hot=null)}}}function On(t){!function(t,e){t._handlers=s(),t._slots=s(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}(this,t),this.refs={},this._state=u({hot:null,data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,fixedColumnsLeft:0,searchIndex:0,sortBy:"-",transpose:!1,activeColumn:null,search:"",searchResults:[]},t.data),this._recompute({searchResults:1,searchIndex:1},this._state),this._intro=!0,this._handlers.state=[Sn],Sn.call(this,{changed:i({},this._state),current:this._state}),this._fragment=Nn(this,this._state),this.root._oncreate.push(()=>{Rn.call(this),this.fire("update",{changed:i({},this._state),current:this._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),c(this))}return u(On.prototype,f),u(On.prototype,Mn),On.prototype._recompute=function(t,e){(t.searchResults||t.searchIndex)&&this._differs(e.currentResult,e.currentResult=function({searchResults:t,searchIndex:e}){if(!t||!t.length)return null;const n=t.length;if(e<0||e>=n){for(;e<0;)e+=n;e>n&&(e%=n)}return t[e]}(e))&&(t.currentResult=!0)},{Handsontable:On}}));
