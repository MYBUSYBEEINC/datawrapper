!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("Handsontable"),require("dayjs")):"function"==typeof define&&define.amd?define(["Handsontable","dayjs"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["describe/hot"]=e(t.HOT,t.dayjs)}(this,(function(t,e){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var n=r(t),u=r(e);function o(){}function a(t,e){for(var r in e)t[r]=e[r];return t}function i(t,e){for(var r in e)t[r]=1;return t}function s(){return Object.create(null)}function c(t){t._lock=!0,l(t._beforecreate),l(t._oncreate),l(t._aftercreate),t._lock=!1}function l(t){for(;t&&t.length;)t.shift()()}var f={destroy:function(t){this.destroy=o,this.fire("destroy"),this.set=o,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:function(){return this._state},fire:function(t,e){var r=t in this._handlers&&this._handlers[t].slice();if(r)for(var n=0;n<r.length;n+=1){var u=r[n];if(!u.__calling)try{u.__calling=!0,u.call(this,e)}finally{u.__calling=!1}}},on:function(t,e){var r=this._handlers[t]||(this._handlers[t]=[]);return r.push(e),{cancel:function(){var t=r.indexOf(e);~t&&r.splice(t,1)}}},set:function(t){this._set(a({},t)),this.root._lock||c(this.root)},_recompute:o,_set:function(t){var e=this._state,r={},n=!1;for(var u in t=a(this._staged,t),this._staged={},t)this._differs(t[u],e[u])&&(r[u]=n=!0);n&&(this._state=a(a({},e),t),this._recompute(r,this._state),this._bind&&this._bind(r,this._state),this._fragment&&(this.fire("state",{changed:r,current:this._state,previous:e}),this._fragment.p(r,this._state),this.fire("update",{changed:r,current:this._state,previous:e})))},_stage:function(t){a(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}};const p=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,h=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;function d(t,e){if(null===t)return null;if(void 0!==t){if((t=String(t)).indexOf("<")<0&&t.indexOf(">")<0)return t;if(t=function(t,e){e=(((void 0!==e?e||"":"<a><span><b><br><br/><i><strong><sup><sub><strike><u><em><tt>")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var r=t,n=t;for(;;)if(n=(r=n).replace(h,"").replace(p,(function(t,r){return e.indexOf("<"+r.toLowerCase()+">")>-1?t:""})),r===n)return n}(t,e),"undefined"==typeof document)return t;var r=document.createElement("div");r.innerHTML=`<span>${t}</span>`;for(var n=r.childNodes[0].querySelectorAll("*"),u=0;u<n.length;u++){if("a"===n[u].nodeName.toLowerCase()){"_self"!==n[u].getAttribute("target")&&n[u].setAttribute("target","_blank"),n[u].setAttribute("rel","nofollow noopener noreferrer");const t=(n[u].getAttribute("href")||"").toLowerCase().replace(/[^a-z0-9 -/:?=]/g,"").trim();(t.startsWith("javascript:")||t.startsWith("vbscript:")||t.startsWith("data:"))&&n[u].setAttribute("href","")}const t=[];for(var o=0;o<n[u].attributes.length;o++){var a=n[u].attributes[o];a.specified&&"on"===a.name.substr(0,2)&&t.push(a.name)}t.forEach(t=>n[u].removeAttribute(t))}return r.childNodes[0].innerHTML}}var v="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},m=Array.prototype,g=Object.prototype,Y="undefined"!=typeof Symbol?Symbol.prototype:null,y=m.push,b=m.slice,M=g.toString,w=g.hasOwnProperty,_="undefined"!=typeof ArrayBuffer,D="undefined"!=typeof DataView,j=Array.isArray,x=Object.keys,N=Object.create,C=_&&ArrayBuffer.isView,O=isNaN,S=isFinite,A=!{toString:null}.propertyIsEnumerable("toString"),R=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],E=Math.pow(2,53)-1;function H(t,e){return e=null==e?t.length-1:+e,function(){for(var r=Math.max(arguments.length-e,0),n=Array(r),u=0;u<r;u++)n[u]=arguments[u+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var o=Array(e+1);for(u=0;u<e;u++)o[u]=arguments[u];return o[e]=n,t.apply(this,o)}}function L(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function T(t){return void 0===t}function k(t){return!0===t||!1===t||"[object Boolean]"===M.call(t)}function I(t){var e="[object "+t+"]";return function(t){return M.call(t)===e}}var $=I("String"),F=I("Number"),W=I("Date"),B=I("RegExp"),V=I("Error"),q=I("Symbol"),z=I("ArrayBuffer"),P=I("Function"),U=v.document&&v.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof U&&(P=function(t){return"function"==typeof t||!1});var Q=P,J=I("Object"),K=D&&J(new DataView(new ArrayBuffer(8))),X="undefined"!=typeof Map&&J(new Map),G=I("DataView");var Z=K?function(t){return null!=t&&Q(t.getInt8)&&z(t.buffer)}:G,tt=j||I("Array");function et(t,e){return null!=t&&w.call(t,e)}var rt=I("Arguments");!function(){rt(arguments)||(rt=function(t){return et(t,"callee")})}();var nt=rt;function ut(t){return F(t)&&O(t)}function ot(t){return function(){return t}}function at(t){return function(e){var r=t(e);return"number"==typeof r&&r>=0&&r<=E}}function it(t){return function(e){return null==e?void 0:e[t]}}var st=it("byteLength"),ct=at(st),lt=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var ft=_?function(t){return C?C(t)&&!Z(t):ct(t)&&lt.test(M.call(t))}:ot(!1),pt=it("length");function ht(t,e){e=function(t){for(var e={},r=t.length,n=0;n<r;++n)e[t[n]]=!0;return{contains:function(t){return e[t]},push:function(r){return e[r]=!0,t.push(r)}}}(e);var r=R.length,n=t.constructor,u=Q(n)&&n.prototype||g,o="constructor";for(et(t,o)&&!e.contains(o)&&e.push(o);r--;)(o=R[r])in t&&t[o]!==u[o]&&!e.contains(o)&&e.push(o)}function dt(t){if(!L(t))return[];if(x)return x(t);var e=[];for(var r in t)et(t,r)&&e.push(r);return A&&ht(t,e),e}function vt(t,e){var r=dt(e),n=r.length;if(null==t)return!n;for(var u=Object(t),o=0;o<n;o++){var a=r[o];if(e[a]!==u[a]||!(a in u))return!1}return!0}function mt(t){return t instanceof mt?t:this instanceof mt?void(this._wrapped=t):new mt(t)}function gt(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,st(t))}mt.VERSION="1.13.1",mt.prototype.value=function(){return this._wrapped},mt.prototype.valueOf=mt.prototype.toJSON=mt.prototype.value,mt.prototype.toString=function(){return String(this._wrapped)};function Yt(t,e,r,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var u=typeof t;return("function"===u||"object"===u||"object"==typeof e)&&function t(e,r,n,u){e instanceof mt&&(e=e._wrapped);r instanceof mt&&(r=r._wrapped);var o=M.call(e);if(o!==M.call(r))return!1;if(K&&"[object Object]"==o&&Z(e)){if(!Z(r))return!1;o="[object DataView]"}switch(o){case"[object RegExp]":case"[object String]":return""+e==""+r;case"[object Number]":return+e!=+e?+r!=+r:0==+e?1/+e==1/r:+e==+r;case"[object Date]":case"[object Boolean]":return+e==+r;case"[object Symbol]":return Y.valueOf.call(e)===Y.valueOf.call(r);case"[object ArrayBuffer]":case"[object DataView]":return t(gt(e),gt(r),n,u)}var a="[object Array]"===o;if(!a&&ft(e)){if(st(e)!==st(r))return!1;if(e.buffer===r.buffer&&e.byteOffset===r.byteOffset)return!0;a=!0}if(!a){if("object"!=typeof e||"object"!=typeof r)return!1;var i=e.constructor,s=r.constructor;if(i!==s&&!(Q(i)&&i instanceof i&&Q(s)&&s instanceof s)&&"constructor"in e&&"constructor"in r)return!1}u=u||[];var c=(n=n||[]).length;for(;c--;)if(n[c]===e)return u[c]===r;if(n.push(e),u.push(r),a){if((c=e.length)!==r.length)return!1;for(;c--;)if(!Yt(e[c],r[c],n,u))return!1}else{var l,f=dt(e);if(c=f.length,dt(r).length!==c)return!1;for(;c--;)if(l=f[c],!et(r,l)||!Yt(e[l],r[l],n,u))return!1}return n.pop(),u.pop(),!0}(t,e,r,n)}function yt(t){if(!L(t))return[];var e=[];for(var r in t)e.push(r);return A&&ht(t,e),e}function bt(t){var e=pt(t);return function(r){if(null==r)return!1;var n=yt(r);if(pt(n))return!1;for(var u=0;u<e;u++)if(!Q(r[t[u]]))return!1;return t!==jt||!Q(r[Mt])}}var Mt="forEach",wt=["clear","delete"],_t=["get","has","set"],Dt=wt.concat(Mt,_t),jt=wt.concat(_t),xt=["add"].concat(wt,Mt,"has"),Nt=X?bt(Dt):I("Map"),Ct=X?bt(jt):I("WeakMap"),Ot=X?bt(xt):I("Set"),St=I("WeakSet");function At(t){for(var e=dt(t),r=e.length,n=Array(r),u=0;u<r;u++)n[u]=t[e[u]];return n}function Rt(t){for(var e={},r=dt(t),n=0,u=r.length;n<u;n++)e[t[r[n]]]=r[n];return e}function Et(t){var e=[];for(var r in t)Q(t[r])&&e.push(r);return e.sort()}function Ht(t,e){return function(r){var n=arguments.length;if(e&&(r=Object(r)),n<2||null==r)return r;for(var u=1;u<n;u++)for(var o=arguments[u],a=t(o),i=a.length,s=0;s<i;s++){var c=a[s];e&&void 0!==r[c]||(r[c]=o[c])}return r}}var Lt=Ht(yt),Tt=Ht(dt),kt=Ht(yt,!0);function It(t){if(!L(t))return{};if(N)return N(t);var e=function(){};e.prototype=t;var r=new e;return e.prototype=null,r}function $t(t){return L(t)?tt(t)?t.slice():Lt({},t):t}function Ft(t){return tt(t)?t:[t]}function Wt(t){return mt.toPath(t)}function Bt(t,e){for(var r=e.length,n=0;n<r;n++){if(null==t)return;t=t[e[n]]}return r?t:void 0}function Vt(t,e,r){var n=Bt(t,Wt(e));return T(n)?r:n}function qt(t){return t}function zt(t){return t=Tt({},t),function(e){return vt(e,t)}}function Pt(t){return t=Wt(t),function(e){return Bt(e,t)}}function Ut(t,e,r){if(void 0===e)return t;switch(null==r?3:r){case 1:return function(r){return t.call(e,r)};case 3:return function(r,n,u){return t.call(e,r,n,u)};case 4:return function(r,n,u,o){return t.call(e,r,n,u,o)}}return function(){return t.apply(e,arguments)}}function Qt(t,e,r){return null==t?qt:Q(t)?Ut(t,e,r):L(t)&&!tt(t)?zt(t):Pt(t)}function Jt(t,e){return Qt(t,e,1/0)}function Kt(t,e,r){return mt.iteratee!==Jt?mt.iteratee(t,e):Qt(t,e,r)}function Xt(){}function Gt(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}mt.toPath=Ft,mt.iteratee=Jt;var Zt=Date.now||function(){return(new Date).getTime()};function te(t){var e=function(e){return t[e]},r="(?:"+dt(t).join("|")+")",n=RegExp(r),u=RegExp(r,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(u,e):t}}var ee={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},re=te(ee),ne=te(Rt(ee)),ue=mt.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},oe=/(.)^/,ae={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},ie=/\\|'|\r|\n|\u2028|\u2029/g;function se(t){return"\\"+ae[t]}var ce=/^\s*(\w|\$)+\s*$/;var le=0;function fe(t,e,r,n,u){if(!(n instanceof e))return t.apply(r,u);var o=It(t.prototype),a=t.apply(o,u);return L(a)?a:o}var pe=H((function(t,e){var r=pe.placeholder,n=function(){for(var u=0,o=e.length,a=Array(o),i=0;i<o;i++)a[i]=e[i]===r?arguments[u++]:e[i];for(;u<arguments.length;)a.push(arguments[u++]);return fe(t,n,this,this,a)};return n}));pe.placeholder=mt;var he=H((function(t,e,r){if(!Q(t))throw new TypeError("Bind must be called on a function");var n=H((function(u){return fe(t,n,e,this,r.concat(u))}));return n})),de=at(pt);function ve(t,e,r,n){if(n=n||[],e||0===e){if(e<=0)return n.concat(t)}else e=1/0;for(var u=n.length,o=0,a=pt(t);o<a;o++){var i=t[o];if(de(i)&&(tt(i)||nt(i)))if(e>1)ve(i,e-1,r,n),u=n.length;else for(var s=0,c=i.length;s<c;)n[u++]=i[s++];else r||(n[u++]=i)}return n}var me=H((function(t,e){var r=(e=ve(e,!1,!1)).length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=e[r];t[n]=he(t[n],t)}return t}));var ge=H((function(t,e,r){return setTimeout((function(){return t.apply(null,r)}),e)})),Ye=pe(ge,mt,1);function ye(t){return function(){return!t.apply(this,arguments)}}function be(t,e){var r;return function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=null),r}}var Me=pe(be,2);function we(t,e,r){e=Kt(e,r);for(var n,u=dt(t),o=0,a=u.length;o<a;o++)if(e(t[n=u[o]],n,t))return n}function _e(t){return function(e,r,n){r=Kt(r,n);for(var u=pt(e),o=t>0?0:u-1;o>=0&&o<u;o+=t)if(r(e[o],o,e))return o;return-1}}var De=_e(1),je=_e(-1);function xe(t,e,r,n){for(var u=(r=Kt(r,n,1))(e),o=0,a=pt(t);o<a;){var i=Math.floor((o+a)/2);r(t[i])<u?o=i+1:a=i}return o}function Ne(t,e,r){return function(n,u,o){var a=0,i=pt(n);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+i,a):i=o>=0?Math.min(o+1,i):o+i+1;else if(r&&o&&i)return n[o=r(n,u)]===u?o:-1;if(u!=u)return(o=e(b.call(n,a,i),ut))>=0?o+a:-1;for(o=t>0?a:i-1;o>=0&&o<i;o+=t)if(n[o]===u)return o;return-1}}var Ce=Ne(1,De,xe),Oe=Ne(-1,je);function Se(t,e,r){var n=(de(t)?De:we)(t,e,r);if(void 0!==n&&-1!==n)return t[n]}function Ae(t,e,r){var n,u;if(e=Ut(e,r),de(t))for(n=0,u=t.length;n<u;n++)e(t[n],n,t);else{var o=dt(t);for(n=0,u=o.length;n<u;n++)e(t[o[n]],o[n],t)}return t}function Re(t,e,r){e=Kt(e,r);for(var n=!de(t)&&dt(t),u=(n||t).length,o=Array(u),a=0;a<u;a++){var i=n?n[a]:a;o[a]=e(t[i],i,t)}return o}function Ee(t){var e=function(e,r,n,u){var o=!de(e)&&dt(e),a=(o||e).length,i=t>0?0:a-1;for(u||(n=e[o?o[i]:i],i+=t);i>=0&&i<a;i+=t){var s=o?o[i]:i;n=r(n,e[s],s,e)}return n};return function(t,r,n,u){var o=arguments.length>=3;return e(t,Ut(r,u,4),n,o)}}var He=Ee(1),Le=Ee(-1);function Te(t,e,r){var n=[];return e=Kt(e,r),Ae(t,(function(t,r,u){e(t,r,u)&&n.push(t)})),n}function ke(t,e,r){e=Kt(e,r);for(var n=!de(t)&&dt(t),u=(n||t).length,o=0;o<u;o++){var a=n?n[o]:o;if(!e(t[a],a,t))return!1}return!0}function Ie(t,e,r){e=Kt(e,r);for(var n=!de(t)&&dt(t),u=(n||t).length,o=0;o<u;o++){var a=n?n[o]:o;if(e(t[a],a,t))return!0}return!1}function $e(t,e,r,n){return de(t)||(t=At(t)),("number"!=typeof r||n)&&(r=0),Ce(t,e,r)>=0}var Fe=H((function(t,e,r){var n,u;return Q(e)?u=e:(e=Wt(e),n=e.slice(0,-1),e=e[e.length-1]),Re(t,(function(t){var o=u;if(!o){if(n&&n.length&&(t=Bt(t,n)),null==t)return;o=t[e]}return null==o?o:o.apply(t,r)}))}));function We(t,e){return Re(t,Pt(e))}function Be(t,e,r){var n,u,o=-1/0,a=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var i=0,s=(t=de(t)?t:At(t)).length;i<s;i++)null!=(n=t[i])&&n>o&&(o=n);else e=Kt(e,r),Ae(t,(function(t,r,n){((u=e(t,r,n))>a||u===-1/0&&o===-1/0)&&(o=t,a=u)}));return o}function Ve(t,e,r){if(null==e||r)return de(t)||(t=At(t)),t[Gt(t.length-1)];var n=de(t)?$t(t):At(t),u=pt(n);e=Math.max(Math.min(e,u),0);for(var o=u-1,a=0;a<e;a++){var i=Gt(a,o),s=n[a];n[a]=n[i],n[i]=s}return n.slice(0,e)}function qe(t,e){return function(r,n,u){var o=e?[[],[]]:{};return n=Kt(n,u),Ae(r,(function(e,u){var a=n(e,u,r);t(o,e,a)})),o}}var ze=qe((function(t,e,r){et(t,r)?t[r].push(e):t[r]=[e]})),Pe=qe((function(t,e,r){t[r]=e})),Ue=qe((function(t,e,r){et(t,r)?t[r]++:t[r]=1})),Qe=qe((function(t,e,r){t[r?0:1].push(e)}),!0),Je=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Ke(t,e,r){return e in r}var Xe=H((function(t,e){var r={},n=e[0];if(null==t)return r;Q(n)?(e.length>1&&(n=Ut(n,e[1])),e=yt(t)):(n=Ke,e=ve(e,!1,!1),t=Object(t));for(var u=0,o=e.length;u<o;u++){var a=e[u],i=t[a];n(i,a,t)&&(r[a]=i)}return r})),Ge=H((function(t,e){var r,n=e[0];return Q(n)?(n=ye(n),e.length>1&&(r=e[1])):(e=Re(ve(e,!1,!1),String),n=function(t,r){return!$e(e,r)}),Xe(t,n,r)}));function Ze(t,e,r){return b.call(t,0,Math.max(0,t.length-(null==e||r?1:e)))}function tr(t,e,r){return null==t||t.length<1?null==e||r?void 0:[]:null==e||r?t[0]:Ze(t,t.length-e)}function er(t,e,r){return b.call(t,null==e||r?1:e)}var rr=H((function(t,e){return e=ve(e,!0,!0),Te(t,(function(t){return!$e(e,t)}))})),nr=H((function(t,e){return rr(t,e)}));function ur(t,e,r,n){k(e)||(n=r,r=e,e=!1),null!=r&&(r=Kt(r,n));for(var u=[],o=[],a=0,i=pt(t);a<i;a++){var s=t[a],c=r?r(s,a,t):s;e&&!r?(a&&o===c||u.push(s),o=c):r?$e(o,c)||(o.push(c),u.push(s)):$e(u,s)||u.push(s)}return u}var or=H((function(t){return ur(ve(t,!0,!0))}));function ar(t){for(var e=t&&Be(t,pt).length||0,r=Array(e),n=0;n<e;n++)r[n]=We(t,n);return r}var ir=H(ar);function sr(t,e){return t._chain?mt(e).chain():e}function cr(t){return Ae(Et(t),(function(e){var r=mt[e]=t[e];mt.prototype[e]=function(){var t=[this._wrapped];return y.apply(t,arguments),sr(this,r.apply(mt,t))}})),mt}Ae(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=m[t];mt.prototype[t]=function(){var r=this._wrapped;return null!=r&&(e.apply(r,arguments),"shift"!==t&&"splice"!==t||0!==r.length||delete r[0]),sr(this,r)}})),Ae(["concat","join","slice"],(function(t){var e=m[t];mt.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),sr(this,t)}}));var lr=cr(Object.freeze({__proto__:null,VERSION:"1.13.1",restArguments:H,isObject:L,isNull:function(t){return null===t},isUndefined:T,isBoolean:k,isElement:function(t){return!(!t||1!==t.nodeType)},isString:$,isNumber:F,isDate:W,isRegExp:B,isError:V,isSymbol:q,isArrayBuffer:z,isDataView:Z,isArray:tt,isFunction:Q,isArguments:nt,isFinite:function(t){return!q(t)&&S(t)&&!isNaN(parseFloat(t))},isNaN:ut,isTypedArray:ft,isEmpty:function(t){if(null==t)return!0;var e=pt(t);return"number"==typeof e&&(tt(t)||$(t)||nt(t))?0===e:0===pt(dt(t))},isMatch:vt,isEqual:function(t,e){return Yt(t,e)},isMap:Nt,isWeakMap:Ct,isSet:Ot,isWeakSet:St,keys:dt,allKeys:yt,values:At,pairs:function(t){for(var e=dt(t),r=e.length,n=Array(r),u=0;u<r;u++)n[u]=[e[u],t[e[u]]];return n},invert:Rt,functions:Et,methods:Et,extend:Lt,extendOwn:Tt,assign:Tt,defaults:kt,create:function(t,e){var r=It(t);return e&&Tt(r,e),r},clone:$t,tap:function(t,e){return e(t),t},get:Vt,has:function(t,e){for(var r=(e=Wt(e)).length,n=0;n<r;n++){var u=e[n];if(!et(t,u))return!1;t=t[u]}return!!r},mapObject:function(t,e,r){e=Kt(e,r);for(var n=dt(t),u=n.length,o={},a=0;a<u;a++){var i=n[a];o[i]=e(t[i],i,t)}return o},identity:qt,constant:ot,noop:Xt,toPath:Ft,property:Pt,propertyOf:function(t){return null==t?Xt:function(e){return Vt(t,e)}},matcher:zt,matches:zt,times:function(t,e,r){var n=Array(Math.max(0,t));e=Ut(e,r,1);for(var u=0;u<t;u++)n[u]=e(u);return n},random:Gt,now:Zt,escape:re,unescape:ne,templateSettings:ue,template:function(t,e,r){!e&&r&&(e=r),e=kt({},e,mt.templateSettings);var n=RegExp([(e.escape||oe).source,(e.interpolate||oe).source,(e.evaluate||oe).source].join("|")+"|$","g"),u=0,o="__p+='";t.replace(n,(function(e,r,n,a,i){return o+=t.slice(u,i).replace(ie,se),u=i+e.length,r?o+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),e})),o+="';\n";var a,i=e.variable;if(i){if(!ce.test(i))throw new Error("variable is not a bare identifier: "+i)}else o="with(obj||{}){\n"+o+"}\n",i="obj";o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{a=new Function(i,"_",o)}catch(t){throw t.source=o,t}var s=function(t){return a.call(this,t,mt)};return s.source="function("+i+"){\n"+o+"}",s},result:function(t,e,r){var n=(e=Wt(e)).length;if(!n)return Q(r)?r.call(t):r;for(var u=0;u<n;u++){var o=null==t?void 0:t[e[u]];void 0===o&&(o=r,u=n),t=Q(o)?o.call(t):o}return t},uniqueId:function(t){var e=++le+"";return t?t+e:e},chain:function(t){var e=mt(t);return e._chain=!0,e},iteratee:Jt,partial:pe,bind:he,bindAll:me,memoize:function(t,e){var r=function(n){var u=r.cache,o=""+(e?e.apply(this,arguments):n);return et(u,o)||(u[o]=t.apply(this,arguments)),u[o]};return r.cache={},r},delay:ge,defer:Ye,throttle:function(t,e,r){var n,u,o,a,i=0;r||(r={});var s=function(){i=!1===r.leading?0:Zt(),n=null,a=t.apply(u,o),n||(u=o=null)},c=function(){var c=Zt();i||!1!==r.leading||(i=c);var l=e-(c-i);return u=this,o=arguments,l<=0||l>e?(n&&(clearTimeout(n),n=null),i=c,a=t.apply(u,o),n||(u=o=null)):n||!1===r.trailing||(n=setTimeout(s,l)),a};return c.cancel=function(){clearTimeout(n),i=0,n=u=o=null},c},debounce:function(t,e,r){var n,u,o,a,i,s=function(){var c=Zt()-u;e>c?n=setTimeout(s,e-c):(n=null,r||(a=t.apply(i,o)),n||(o=i=null))},c=H((function(c){return i=this,o=c,u=Zt(),n||(n=setTimeout(s,e),r&&(a=t.apply(i,o))),a}));return c.cancel=function(){clearTimeout(n),n=o=i=null},c},wrap:function(t,e){return pe(e,t)},negate:ye,compose:function(){var t=arguments,e=t.length-1;return function(){for(var r=e,n=t[e].apply(this,arguments);r--;)n=t[r].call(this,n);return n}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:be,once:Me,findKey:we,findIndex:De,findLastIndex:je,sortedIndex:xe,indexOf:Ce,lastIndexOf:Oe,find:Se,detect:Se,findWhere:function(t,e){return Se(t,zt(e))},each:Ae,forEach:Ae,map:Re,collect:Re,reduce:He,foldl:He,inject:He,reduceRight:Le,foldr:Le,filter:Te,select:Te,reject:function(t,e,r){return Te(t,ye(Kt(e)),r)},every:ke,all:ke,some:Ie,any:Ie,contains:$e,includes:$e,include:$e,invoke:Fe,pluck:We,where:function(t,e){return Te(t,zt(e))},max:Be,min:function(t,e,r){var n,u,o=1/0,a=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var i=0,s=(t=de(t)?t:At(t)).length;i<s;i++)null!=(n=t[i])&&n<o&&(o=n);else e=Kt(e,r),Ae(t,(function(t,r,n){((u=e(t,r,n))<a||u===1/0&&o===1/0)&&(o=t,a=u)}));return o},shuffle:function(t){return Ve(t,1/0)},sample:Ve,sortBy:function(t,e,r){var n=0;return e=Kt(e,r),We(Re(t,(function(t,r,u){return{value:t,index:n++,criteria:e(t,r,u)}})).sort((function(t,e){var r=t.criteria,n=e.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return t.index-e.index})),"value")},groupBy:ze,indexBy:Pe,countBy:Ue,partition:Qe,toArray:function(t){return t?tt(t)?b.call(t):$(t)?t.match(Je):de(t)?Re(t,qt):At(t):[]},size:function(t){return null==t?0:de(t)?t.length:dt(t).length},pick:Xe,omit:Ge,first:tr,head:tr,take:tr,initial:Ze,last:function(t,e,r){return null==t||t.length<1?null==e||r?void 0:[]:null==e||r?t[t.length-1]:er(t,Math.max(0,t.length-e))},rest:er,tail:er,drop:er,compact:function(t){return Te(t,Boolean)},flatten:function(t,e){return ve(t,e,!1)},without:nr,uniq:ur,unique:ur,union:or,intersection:function(t){for(var e=[],r=arguments.length,n=0,u=pt(t);n<u;n++){var o=t[n];if(!$e(e,o)){var a;for(a=1;a<r&&$e(arguments[a],o);a++);a===r&&e.push(o)}}return e},difference:rr,unzip:ar,transpose:ar,zip:ir,object:function(t,e){for(var r={},n=0,u=pt(t);n<u;n++)e?r[t[n]]=e[n]:r[t[n][0]]=t[n][1];return r},range:function(t,e,r){null==e&&(e=t||0,t=0),r||(r=e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/r),0),u=Array(n),o=0;o<n;o++,t+=r)u[o]=t;return u},chunk:function(t,e){if(null==e||e<1)return[];for(var r=[],n=0,u=t.length;n<u;)r.push(b.call(t,n,n+=e));return r},mixin:cr,default:mt}));function fr(t){if(!t.format())return qt;switch(t.precision()){case"year":return function(t){return W(t)?t.getFullYear():t};case"half":return function(t){return W(t)?t.getFullYear()+" H"+(t.getMonth()/6+1):t};case"quarter":return function(t){return W(t)?t.getFullYear()+" Q"+(t.getMonth()/3+1):t};case"month":return function(t){return W(t)?pr(t,"MMM YY"):t};case"week":return function(t){return W(t)?function(t){const e=t.getUTCDay(),r=new Date(t.valueOf());r.setDate(r.getDate()-(e+6)%7+3);const n=r.getUTCFullYear(),u=Math.floor((r.getTime()-new Date(n,0,1,-6))/864e5);return[n,1+Math.floor(u/7),e>0?e:7]}(t).slice(0,2).join(" W"):t};case"day":return function(t,e){return W(t)?pr(t,e?"dddd, MMMM DD, YYYY":"l"):t};case"day-minutes":return function(t,e){return W(t)?pr(t,"MMM DD"+(e?", YYYY":"")).replace(/ /g,"&nbsp;")+" - "+pr(t,"LT").replace(" ","&nbsp;"):t};case"day-seconds":return function(t,e){return W(t)?(e?pr(t,"MMM DD, YYYY").replace(/ /g,"&nbsp;")+" - ":"")+pr(t,"LTS").replace(" ","&nbsp;"):t}}}function pr(t,e){const r=u.default.locale();u.default.locale("en");const n=u.default(t).format(e);return u.default.locale(r),n}lr._=lr;const hr=new Set(["฿","₿","¢","$","€","eur","£","gbp","¥","yen","usd","cad","us$","ca$","can$"]);function dr(t,e){return Math.abs(t-e)<1e-6}function vr(t,e){const r=e["number-format"]||"-",n=Number(e["number-divisor"]||0),u=(e["number-append"]||"").replace(/ /g," "),o=(e["number-prepend"]||"").replace(/ /g," ");return function(e,a,i){if(isNaN(e))return e;var s,c,l=r,f=0;0!==n&&"-"===l&&(f=1),"s"===l.substr(0,1)&&(f=Math.max(0,(s=e,c=+l.substr(1),0===s?0:Math.round(c-Math.ceil(Math.log(Math.abs(s))/Math.LN10))))),i&&(f=0),"-"===l&&(f=dr(e,Math.round(e))?0:dr(e,.1*Math.round(10*e))?1:dr(e,.01*Math.round(100*e))?2:dr(e,.001*Math.round(1e3*e))?3:dr(e,1e-4*Math.round(1e4*e))?4:dr(e,1e-5*Math.round(1e5*e))?5:6),"n"===l[0]&&(f=Number(l.substr(1,l.length)));let p="0,0";for(var h=0;h<f;h++)0===h&&(p+="."),p+="0";return function(t,e,r){if(r={format:"0.[00]",prepend:"",append:"",minusChar:"−",plusMinusChar:"±",multiply:1,...r},void 0===e||isNaN(e)||""===e||null===e)return"";const{append:n,prepend:u,minusChar:o,plusMinusChar:a,multiply:i}=r;let{format:s}=r;s.includes("%")&&Number.isFinite(e)&&(e*=.01),e*=i;const c=s.indexOf("(")>-1,l=s.indexOf(";")>-1;s=s.replace(/;/g,",");let f=t(c?e:Math.abs(e)).format(s);if(l){const r=t.options.currentLocale,n=t.locales[r].delimiters.thousands,u=s.includes("%")?e/.01:e;f=Math.abs(u)<1e4?f.replace(n,""):f}return u&&!c&&e<0&&hr.has(u.trim().toLowerCase())?`${o}${u}${f.replace("+","")}${n}`:u&&e>=0&&hr.has(u.trim().toLowerCase())&&s.includes("+")?`${0===e?a:"+"}${u}${f.replace("+","")}${n}`:0===e&&s.includes("+")?`${u}${f.replace("+",a)}${n}`:e<0&&!c?`${u}${o}${f.replace("+","")}${n}`:`${u}${f}${n}`}(t,e,{format:p,prepend:a?o:"",append:a?u:"",multiply:Math.pow(10,-1*n)})}}const mr=t=>t;function gr(t,e,r,n){return"date"===e.type()?fr(e.type(!0)):"number"===e.type()?vr(t,function(t,e=null,r=null){if(!e)return t;const n=Array.isArray(e)?e:e.split(".");let u=t;for(let t=0;t<n.length&&null!=u;t++)u=u[n[t]];return null==u?r:u}(r,"data.column-format."+n,{})):mr}function Yr(t,e,r,n){const{numeral:u}=dw.visualization.libraries,o={date:"fa fa-clock-o"};return function(a,i,s,c,l,f,p){if(r.numColumns()<=c||!r.hasColumn(c))return;const h=r.column(c),{searchResults:v,currentResult:m,activeColumn:g}=t.get(),Y=t.getColumnFormat(h.name());if((s=a.toPhysicalRow(s))>0){var y=gr(u,h,e.get().metadata,h.name());f=null===h.val(s-1)||""===h.val(s-1)?"–":y(h.val(s-1),!0)}parseInt(f)<0&&i.classList.add("negative"),i.classList.add(h.type()+"Type"),i.dataset.column=c,"text"===h.type()&&f&&f.length>70&&(f=f.substr(0,60)+"…"),0===s?(i.classList.add("firstRow"),o[h.type()]&&(f='<i class="'+o[h.type()]+'"></i> '+f)):i.classList.add(s%2?"oddRow":"evenRow"),Y.ignore&&i.classList.add("ignored"),g&&g.name()===h.name()&&i.classList.add("active");const b=n.hooks.run(a,"modifyRow",s);v.forEach(t=>{t.row===b&&t.col===c&&i.classList.add("htSearchResult")}),m&&m.row===b&&m.col===c&&i.classList.add("htCurrentSearchResult"),s>0&&!h.type(!0).isValid(h.val(s-1))&&null!==h.val(s-1)&&""!==h.val(s-1)&&i.classList.add("parsingError"),s>0&&(null===h.val(s-1)||""===h.val(s-1))&&i.classList.add("noData"),h.isComputed&&h.errors.length&&h.errors.find(t=>"all"===t.row||t.row===s-1)&&i.classList.add("parsingError"),p.readOnly&&i.classList.add("readOnly"),e.dataCellChanged(c,s)&&i.classList.add("changed"),function(t,e,r,u,o,a){var i=d(n.helper.stringify(a));e.innerHTML=i}(0,i,0,0,0,f)}}var yr="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},br=Array.prototype,Mr=Object.prototype,wr="undefined"!=typeof Symbol?Symbol.prototype:null,_r=br.push,Dr=br.slice,jr=Mr.toString,xr=Mr.hasOwnProperty,Nr="undefined"!=typeof ArrayBuffer,Cr="undefined"!=typeof DataView,Or=Array.isArray,Sr=Object.keys,Ar=Object.create,Rr=Nr&&ArrayBuffer.isView,Er=isNaN,Hr=isFinite,Lr=!{toString:null}.propertyIsEnumerable("toString"),Tr=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],kr=Math.pow(2,53)-1;function Ir(t,e){return e=null==e?t.length-1:+e,function(){for(var r=Math.max(arguments.length-e,0),n=Array(r),u=0;u<r;u++)n[u]=arguments[u+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var o=Array(e+1);for(u=0;u<e;u++)o[u]=arguments[u];return o[e]=n,t.apply(this,o)}}function $r(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function Fr(t){return null===t}function Wr(t){return void 0===t}function Br(t){return!0===t||!1===t||"[object Boolean]"===jr.call(t)}function Vr(t){var e="[object "+t+"]";return function(t){return jr.call(t)===e}}var qr=Vr("String"),zr=Vr("Number"),Pr=Vr("Date"),Ur=Vr("RegExp"),Qr=Vr("Error"),Jr=Vr("Symbol"),Kr=Vr("ArrayBuffer"),Xr=Vr("Function"),Gr=yr.document&&yr.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof Gr&&(Xr=function(t){return"function"==typeof t||!1});var Zr=Xr,tn=Vr("Object"),en=Cr&&tn(new DataView(new ArrayBuffer(8))),rn="undefined"!=typeof Map&&tn(new Map),nn=Vr("DataView");var un=en?function(t){return null!=t&&Zr(t.getInt8)&&Kr(t.buffer)}:nn,on=Or||Vr("Array");function an(t,e){return null!=t&&xr.call(t,e)}var sn=Vr("Arguments");!function(){sn(arguments)||(sn=function(t){return an(t,"callee")})}();var cn=sn;function ln(t){return zr(t)&&Er(t)}function fn(t){return function(){return t}}function pn(t){return function(e){var r=t(e);return"number"==typeof r&&r>=0&&r<=kr}}function hn(t){return function(e){return null==e?void 0:e[t]}}var dn=hn("byteLength"),vn=pn(dn),mn=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var gn=Nr?function(t){return Rr?Rr(t)&&!un(t):vn(t)&&mn.test(jr.call(t))}:fn(!1),Yn=hn("length");function yn(t,e){e=function(t){for(var e={},r=t.length,n=0;n<r;++n)e[t[n]]=!0;return{contains:function(t){return e[t]},push:function(r){return e[r]=!0,t.push(r)}}}(e);var r=Tr.length,n=t.constructor,u=Zr(n)&&n.prototype||Mr,o="constructor";for(an(t,o)&&!e.contains(o)&&e.push(o);r--;)(o=Tr[r])in t&&t[o]!==u[o]&&!e.contains(o)&&e.push(o)}function bn(t){if(!$r(t))return[];if(Sr)return Sr(t);var e=[];for(var r in t)an(t,r)&&e.push(r);return Lr&&yn(t,e),e}function Mn(t,e){var r=bn(e),n=r.length;if(null==t)return!n;for(var u=Object(t),o=0;o<n;o++){var a=r[o];if(e[a]!==u[a]||!(a in u))return!1}return!0}function wn(t){return t instanceof wn?t:this instanceof wn?void(this._wrapped=t):new wn(t)}function _n(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,dn(t))}wn.VERSION="1.13.1",wn.prototype.value=function(){return this._wrapped},wn.prototype.valueOf=wn.prototype.toJSON=wn.prototype.value,wn.prototype.toString=function(){return String(this._wrapped)};function Dn(t,e,r,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var u=typeof t;return("function"===u||"object"===u||"object"==typeof e)&&function t(e,r,n,u){e instanceof wn&&(e=e._wrapped);r instanceof wn&&(r=r._wrapped);var o=jr.call(e);if(o!==jr.call(r))return!1;if(en&&"[object Object]"==o&&un(e)){if(!un(r))return!1;o="[object DataView]"}switch(o){case"[object RegExp]":case"[object String]":return""+e==""+r;case"[object Number]":return+e!=+e?+r!=+r:0==+e?1/+e==1/r:+e==+r;case"[object Date]":case"[object Boolean]":return+e==+r;case"[object Symbol]":return wr.valueOf.call(e)===wr.valueOf.call(r);case"[object ArrayBuffer]":case"[object DataView]":return t(_n(e),_n(r),n,u)}var a="[object Array]"===o;if(!a&&gn(e)){if(dn(e)!==dn(r))return!1;if(e.buffer===r.buffer&&e.byteOffset===r.byteOffset)return!0;a=!0}if(!a){if("object"!=typeof e||"object"!=typeof r)return!1;var i=e.constructor,s=r.constructor;if(i!==s&&!(Zr(i)&&i instanceof i&&Zr(s)&&s instanceof s)&&"constructor"in e&&"constructor"in r)return!1}u=u||[];var c=(n=n||[]).length;for(;c--;)if(n[c]===e)return u[c]===r;if(n.push(e),u.push(r),a){if((c=e.length)!==r.length)return!1;for(;c--;)if(!Dn(e[c],r[c],n,u))return!1}else{var l,f=bn(e);if(c=f.length,bn(r).length!==c)return!1;for(;c--;)if(l=f[c],!an(r,l)||!Dn(e[l],r[l],n,u))return!1}return n.pop(),u.pop(),!0}(t,e,r,n)}function jn(t){if(!$r(t))return[];var e=[];for(var r in t)e.push(r);return Lr&&yn(t,e),e}function xn(t){var e=Yn(t);return function(r){if(null==r)return!1;var n=jn(r);if(Yn(n))return!1;for(var u=0;u<e;u++)if(!Zr(r[t[u]]))return!1;return t!==An||!Zr(r[Nn])}}var Nn="forEach",Cn=["clear","delete"],On=["get","has","set"],Sn=Cn.concat(Nn,On),An=Cn.concat(On),Rn=["add"].concat(Cn,Nn,"has"),En=rn?xn(Sn):Vr("Map"),Hn=rn?xn(An):Vr("WeakMap"),Ln=rn?xn(Rn):Vr("Set"),Tn=Vr("WeakSet");function kn(t){for(var e=bn(t),r=e.length,n=Array(r),u=0;u<r;u++)n[u]=t[e[u]];return n}function In(t){for(var e={},r=bn(t),n=0,u=r.length;n<u;n++)e[t[r[n]]]=r[n];return e}function $n(t){var e=[];for(var r in t)Zr(t[r])&&e.push(r);return e.sort()}function Fn(t,e){return function(r){var n=arguments.length;if(e&&(r=Object(r)),n<2||null==r)return r;for(var u=1;u<n;u++)for(var o=arguments[u],a=t(o),i=a.length,s=0;s<i;s++){var c=a[s];e&&void 0!==r[c]||(r[c]=o[c])}return r}}var Wn=Fn(jn),Bn=Fn(bn),Vn=Fn(jn,!0);function qn(t){if(!$r(t))return{};if(Ar)return Ar(t);var e=function(){};e.prototype=t;var r=new e;return e.prototype=null,r}function zn(t){return $r(t)?on(t)?t.slice():Wn({},t):t}function Pn(t){return on(t)?t:[t]}function Un(t){return wn.toPath(t)}function Qn(t,e){for(var r=e.length,n=0;n<r;n++){if(null==t)return;t=t[e[n]]}return r?t:void 0}function Jn(t,e,r){var n=Qn(t,Un(e));return Wr(n)?r:n}function Kn(t){return t}function Xn(t){return t=Bn({},t),function(e){return Mn(e,t)}}function Gn(t){return t=Un(t),function(e){return Qn(e,t)}}function Zn(t,e,r){if(void 0===e)return t;switch(null==r?3:r){case 1:return function(r){return t.call(e,r)};case 3:return function(r,n,u){return t.call(e,r,n,u)};case 4:return function(r,n,u,o){return t.call(e,r,n,u,o)}}return function(){return t.apply(e,arguments)}}function tu(t,e,r){return null==t?Kn:Zr(t)?Zn(t,e,r):$r(t)&&!on(t)?Xn(t):Gn(t)}function eu(t,e){return tu(t,e,1/0)}function ru(t,e,r){return wn.iteratee!==eu?wn.iteratee(t,e):tu(t,e,r)}function nu(){}function uu(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}wn.toPath=Pn,wn.iteratee=eu;var ou=Date.now||function(){return(new Date).getTime()};function au(t){var e=function(e){return t[e]},r="(?:"+bn(t).join("|")+")",n=RegExp(r),u=RegExp(r,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(u,e):t}}var iu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},su=au(iu),cu=au(In(iu)),lu=wn.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},fu=/(.)^/,pu={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},hu=/\\|'|\r|\n|\u2028|\u2029/g;function du(t){return"\\"+pu[t]}var vu=/^\s*(\w|\$)+\s*$/;var mu=0;function gu(t,e,r,n,u){if(!(n instanceof e))return t.apply(r,u);var o=qn(t.prototype),a=t.apply(o,u);return $r(a)?a:o}var Yu=Ir((function(t,e){var r=Yu.placeholder,n=function(){for(var u=0,o=e.length,a=Array(o),i=0;i<o;i++)a[i]=e[i]===r?arguments[u++]:e[i];for(;u<arguments.length;)a.push(arguments[u++]);return gu(t,n,this,this,a)};return n}));Yu.placeholder=wn;var yu=Ir((function(t,e,r){if(!Zr(t))throw new TypeError("Bind must be called on a function");var n=Ir((function(u){return gu(t,n,e,this,r.concat(u))}));return n})),bu=pn(Yn);function Mu(t,e,r,n){if(n=n||[],e||0===e){if(e<=0)return n.concat(t)}else e=1/0;for(var u=n.length,o=0,a=Yn(t);o<a;o++){var i=t[o];if(bu(i)&&(on(i)||cn(i)))if(e>1)Mu(i,e-1,r,n),u=n.length;else for(var s=0,c=i.length;s<c;)n[u++]=i[s++];else r||(n[u++]=i)}return n}var wu=Ir((function(t,e){var r=(e=Mu(e,!1,!1)).length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=e[r];t[n]=yu(t[n],t)}return t}));var _u=Ir((function(t,e,r){return setTimeout((function(){return t.apply(null,r)}),e)})),Du=Yu(_u,wn,1);function ju(t){return function(){return!t.apply(this,arguments)}}function xu(t,e){var r;return function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=null),r}}var Nu=Yu(xu,2);function Cu(t,e,r){e=ru(e,r);for(var n,u=bn(t),o=0,a=u.length;o<a;o++)if(e(t[n=u[o]],n,t))return n}function Ou(t){return function(e,r,n){r=ru(r,n);for(var u=Yn(e),o=t>0?0:u-1;o>=0&&o<u;o+=t)if(r(e[o],o,e))return o;return-1}}var Su=Ou(1),Au=Ou(-1);function Ru(t,e,r,n){for(var u=(r=ru(r,n,1))(e),o=0,a=Yn(t);o<a;){var i=Math.floor((o+a)/2);r(t[i])<u?o=i+1:a=i}return o}function Eu(t,e,r){return function(n,u,o){var a=0,i=Yn(n);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+i,a):i=o>=0?Math.min(o+1,i):o+i+1;else if(r&&o&&i)return n[o=r(n,u)]===u?o:-1;if(u!=u)return(o=e(Dr.call(n,a,i),ln))>=0?o+a:-1;for(o=t>0?a:i-1;o>=0&&o<i;o+=t)if(n[o]===u)return o;return-1}}var Hu=Eu(1,Su,Ru),Lu=Eu(-1,Au);function Tu(t,e,r){var n=(bu(t)?Su:Cu)(t,e,r);if(void 0!==n&&-1!==n)return t[n]}function ku(t,e,r){var n,u;if(e=Zn(e,r),bu(t))for(n=0,u=t.length;n<u;n++)e(t[n],n,t);else{var o=bn(t);for(n=0,u=o.length;n<u;n++)e(t[o[n]],o[n],t)}return t}function Iu(t,e,r){e=ru(e,r);for(var n=!bu(t)&&bn(t),u=(n||t).length,o=Array(u),a=0;a<u;a++){var i=n?n[a]:a;o[a]=e(t[i],i,t)}return o}function $u(t){var e=function(e,r,n,u){var o=!bu(e)&&bn(e),a=(o||e).length,i=t>0?0:a-1;for(u||(n=e[o?o[i]:i],i+=t);i>=0&&i<a;i+=t){var s=o?o[i]:i;n=r(n,e[s],s,e)}return n};return function(t,r,n,u){var o=arguments.length>=3;return e(t,Zn(r,u,4),n,o)}}var Fu=$u(1),Wu=$u(-1);function Bu(t,e,r){var n=[];return e=ru(e,r),ku(t,(function(t,r,u){e(t,r,u)&&n.push(t)})),n}function Vu(t,e,r){e=ru(e,r);for(var n=!bu(t)&&bn(t),u=(n||t).length,o=0;o<u;o++){var a=n?n[o]:o;if(!e(t[a],a,t))return!1}return!0}function qu(t,e,r){e=ru(e,r);for(var n=!bu(t)&&bn(t),u=(n||t).length,o=0;o<u;o++){var a=n?n[o]:o;if(e(t[a],a,t))return!0}return!1}function zu(t,e,r,n){return bu(t)||(t=kn(t)),("number"!=typeof r||n)&&(r=0),Hu(t,e,r)>=0}var Pu=Ir((function(t,e,r){var n,u;return Zr(e)?u=e:(e=Un(e),n=e.slice(0,-1),e=e[e.length-1]),Iu(t,(function(t){var o=u;if(!o){if(n&&n.length&&(t=Qn(t,n)),null==t)return;o=t[e]}return null==o?o:o.apply(t,r)}))}));function Uu(t,e){return Iu(t,Gn(e))}function Qu(t,e,r){var n,u,o=-1/0,a=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var i=0,s=(t=bu(t)?t:kn(t)).length;i<s;i++)null!=(n=t[i])&&n>o&&(o=n);else e=ru(e,r),ku(t,(function(t,r,n){((u=e(t,r,n))>a||u===-1/0&&o===-1/0)&&(o=t,a=u)}));return o}function Ju(t,e,r){if(null==e||r)return bu(t)||(t=kn(t)),t[uu(t.length-1)];var n=bu(t)?zn(t):kn(t),u=Yn(n);e=Math.max(Math.min(e,u),0);for(var o=u-1,a=0;a<e;a++){var i=uu(a,o),s=n[a];n[a]=n[i],n[i]=s}return n.slice(0,e)}function Ku(t){return Ju(t,1/0)}function Xu(t,e){return function(r,n,u){var o=e?[[],[]]:{};return n=ru(n,u),ku(r,(function(e,u){var a=n(e,u,r);t(o,e,a)})),o}}var Gu=Xu((function(t,e,r){an(t,r)?t[r].push(e):t[r]=[e]})),Zu=Xu((function(t,e,r){t[r]=e})),to=Xu((function(t,e,r){an(t,r)?t[r]++:t[r]=1})),eo=Xu((function(t,e,r){t[r?0:1].push(e)}),!0),ro=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function no(t,e,r){return e in r}var uo=Ir((function(t,e){var r={},n=e[0];if(null==t)return r;Zr(n)?(e.length>1&&(n=Zn(n,e[1])),e=jn(t)):(n=no,e=Mu(e,!1,!1),t=Object(t));for(var u=0,o=e.length;u<o;u++){var a=e[u],i=t[a];n(i,a,t)&&(r[a]=i)}return r})),oo=Ir((function(t,e){var r,n=e[0];return Zr(n)?(n=ju(n),e.length>1&&(r=e[1])):(e=Iu(Mu(e,!1,!1),String),n=function(t,r){return!zu(e,r)}),uo(t,n,r)}));function ao(t,e,r){return Dr.call(t,0,Math.max(0,t.length-(null==e||r?1:e)))}function io(t,e,r){return null==t||t.length<1?null==e||r?void 0:[]:null==e||r?t[0]:ao(t,t.length-e)}function so(t,e,r){return Dr.call(t,null==e||r?1:e)}function co(t,e){return Mu(t,e,!1)}var lo=Ir((function(t,e){return e=Mu(e,!0,!0),Bu(t,(function(t){return!zu(e,t)}))})),fo=Ir((function(t,e){return lo(t,e)}));function po(t,e,r,n){Br(e)||(n=r,r=e,e=!1),null!=r&&(r=ru(r,n));for(var u=[],o=[],a=0,i=Yn(t);a<i;a++){var s=t[a],c=r?r(s,a,t):s;e&&!r?(a&&o===c||u.push(s),o=c):r?zu(o,c)||(o.push(c),u.push(s)):zu(u,s)||u.push(s)}return u}var ho=Ir((function(t){return po(Mu(t,!0,!0))}));function vo(t){for(var e=t&&Qu(t,Yn).length||0,r=Array(e),n=0;n<e;n++)r[n]=Uu(t,n);return r}var mo=Ir(vo);function go(t,e,r){null==e&&(e=t||0,t=0),r||(r=e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/r),0),u=Array(n),o=0;o<n;o++,t+=r)u[o]=t;return u}function Yo(t,e){return t._chain?wn(e).chain():e}function yo(t){return ku($n(t),(function(e){var r=wn[e]=t[e];wn.prototype[e]=function(){var t=[this._wrapped];return _r.apply(t,arguments),Yo(this,r.apply(wn,t))}})),wn}ku(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=br[t];wn.prototype[t]=function(){var r=this._wrapped;return null!=r&&(e.apply(r,arguments),"shift"!==t&&"splice"!==t||0!==r.length||delete r[0]),Yo(this,r)}})),ku(["concat","join","slice"],(function(t){var e=br[t];wn.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),Yo(this,t)}}));var bo=yo(Object.freeze({__proto__:null,VERSION:"1.13.1",restArguments:Ir,isObject:$r,isNull:Fr,isUndefined:Wr,isBoolean:Br,isElement:function(t){return!(!t||1!==t.nodeType)},isString:qr,isNumber:zr,isDate:Pr,isRegExp:Ur,isError:Qr,isSymbol:Jr,isArrayBuffer:Kr,isDataView:un,isArray:on,isFunction:Zr,isArguments:cn,isFinite:function(t){return!Jr(t)&&Hr(t)&&!isNaN(parseFloat(t))},isNaN:ln,isTypedArray:gn,isEmpty:function(t){if(null==t)return!0;var e=Yn(t);return"number"==typeof e&&(on(t)||qr(t)||cn(t))?0===e:0===Yn(bn(t))},isMatch:Mn,isEqual:function(t,e){return Dn(t,e)},isMap:En,isWeakMap:Hn,isSet:Ln,isWeakSet:Tn,keys:bn,allKeys:jn,values:kn,pairs:function(t){for(var e=bn(t),r=e.length,n=Array(r),u=0;u<r;u++)n[u]=[e[u],t[e[u]]];return n},invert:In,functions:$n,methods:$n,extend:Wn,extendOwn:Bn,assign:Bn,defaults:Vn,create:function(t,e){var r=qn(t);return e&&Bn(r,e),r},clone:zn,tap:function(t,e){return e(t),t},get:Jn,has:function(t,e){for(var r=(e=Un(e)).length,n=0;n<r;n++){var u=e[n];if(!an(t,u))return!1;t=t[u]}return!!r},mapObject:function(t,e,r){e=ru(e,r);for(var n=bn(t),u=n.length,o={},a=0;a<u;a++){var i=n[a];o[i]=e(t[i],i,t)}return o},identity:Kn,constant:fn,noop:nu,toPath:Pn,property:Gn,propertyOf:function(t){return null==t?nu:function(e){return Jn(t,e)}},matcher:Xn,matches:Xn,times:function(t,e,r){var n=Array(Math.max(0,t));e=Zn(e,r,1);for(var u=0;u<t;u++)n[u]=e(u);return n},random:uu,now:ou,escape:su,unescape:cu,templateSettings:lu,template:function(t,e,r){!e&&r&&(e=r),e=Vn({},e,wn.templateSettings);var n=RegExp([(e.escape||fu).source,(e.interpolate||fu).source,(e.evaluate||fu).source].join("|")+"|$","g"),u=0,o="__p+='";t.replace(n,(function(e,r,n,a,i){return o+=t.slice(u,i).replace(hu,du),u=i+e.length,r?o+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),e})),o+="';\n";var a,i=e.variable;if(i){if(!vu.test(i))throw new Error("variable is not a bare identifier: "+i)}else o="with(obj||{}){\n"+o+"}\n",i="obj";o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{a=new Function(i,"_",o)}catch(t){throw t.source=o,t}var s=function(t){return a.call(this,t,wn)};return s.source="function("+i+"){\n"+o+"}",s},result:function(t,e,r){var n=(e=Un(e)).length;if(!n)return Zr(r)?r.call(t):r;for(var u=0;u<n;u++){var o=null==t?void 0:t[e[u]];void 0===o&&(o=r,u=n),t=Zr(o)?o.call(t):o}return t},uniqueId:function(t){var e=++mu+"";return t?t+e:e},chain:function(t){var e=wn(t);return e._chain=!0,e},iteratee:eu,partial:Yu,bind:yu,bindAll:wu,memoize:function(t,e){var r=function(n){var u=r.cache,o=""+(e?e.apply(this,arguments):n);return an(u,o)||(u[o]=t.apply(this,arguments)),u[o]};return r.cache={},r},delay:_u,defer:Du,throttle:function(t,e,r){var n,u,o,a,i=0;r||(r={});var s=function(){i=!1===r.leading?0:ou(),n=null,a=t.apply(u,o),n||(u=o=null)},c=function(){var c=ou();i||!1!==r.leading||(i=c);var l=e-(c-i);return u=this,o=arguments,l<=0||l>e?(n&&(clearTimeout(n),n=null),i=c,a=t.apply(u,o),n||(u=o=null)):n||!1===r.trailing||(n=setTimeout(s,l)),a};return c.cancel=function(){clearTimeout(n),i=0,n=u=o=null},c},debounce:function(t,e,r){var n,u,o,a,i,s=function(){var c=ou()-u;e>c?n=setTimeout(s,e-c):(n=null,r||(a=t.apply(i,o)),n||(o=i=null))},c=Ir((function(c){return i=this,o=c,u=ou(),n||(n=setTimeout(s,e),r&&(a=t.apply(i,o))),a}));return c.cancel=function(){clearTimeout(n),n=o=i=null},c},wrap:function(t,e){return Yu(e,t)},negate:ju,compose:function(){var t=arguments,e=t.length-1;return function(){for(var r=e,n=t[e].apply(this,arguments);r--;)n=t[r].call(this,n);return n}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:xu,once:Nu,findKey:Cu,findIndex:Su,findLastIndex:Au,sortedIndex:Ru,indexOf:Hu,lastIndexOf:Lu,find:Tu,detect:Tu,findWhere:function(t,e){return Tu(t,Xn(e))},each:ku,forEach:ku,map:Iu,collect:Iu,reduce:Fu,foldl:Fu,inject:Fu,reduceRight:Wu,foldr:Wu,filter:Bu,select:Bu,reject:function(t,e,r){return Bu(t,ju(ru(e)),r)},every:Vu,all:Vu,some:qu,any:qu,contains:zu,includes:zu,include:zu,invoke:Pu,pluck:Uu,where:function(t,e){return Bu(t,Xn(e))},max:Qu,min:function(t,e,r){var n,u,o=1/0,a=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var i=0,s=(t=bu(t)?t:kn(t)).length;i<s;i++)null!=(n=t[i])&&n<o&&(o=n);else e=ru(e,r),ku(t,(function(t,r,n){((u=e(t,r,n))<a||u===1/0&&o===1/0)&&(o=t,a=u)}));return o},shuffle:Ku,sample:Ju,sortBy:function(t,e,r){var n=0;return e=ru(e,r),Uu(Iu(t,(function(t,r,u){return{value:t,index:n++,criteria:e(t,r,u)}})).sort((function(t,e){var r=t.criteria,n=e.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return t.index-e.index})),"value")},groupBy:Gu,indexBy:Zu,countBy:to,partition:eo,toArray:function(t){return t?on(t)?Dr.call(t):qr(t)?t.match(ro):bu(t)?Iu(t,Kn):kn(t):[]},size:function(t){return null==t?0:bu(t)?t.length:bn(t).length},pick:uo,omit:oo,first:io,head:io,take:io,initial:ao,last:function(t,e,r){return null==t||t.length<1?null==e||r?void 0:[]:null==e||r?t[t.length-1]:so(t,Math.max(0,t.length-e))},rest:so,tail:so,drop:so,compact:function(t){return Bu(t,Boolean)},flatten:co,without:fo,uniq:po,unique:po,union:ho,intersection:function(t){for(var e=[],r=arguments.length,n=0,u=Yn(t);n<u;n++){var o=t[n];if(!zu(e,o)){var a;for(a=1;a<r&&zu(arguments[a],o);a++);a===r&&e.push(o)}}return e},difference:lo,unzip:vo,transpose:vo,zip:mo,object:function(t,e){for(var r={},n=0,u=Yn(t);n<u;n++)e?r[t[n]]=e[n]:r[t[n][0]]=t[n][1];return r},range:go,chunk:function(t,e){if(null==e||e<1)return[];for(var r=[],n=0,u=t.length;n<u;)r.push(Dr.call(t,n,n+=e));return r},mixin:yo,default:wn}));function Mo(t,{delimiter:e=",",quoteChar:r='"',lineTerminator:n="\n"}={}){return t.map(t=>t.map(t=>function(t,e,r){if(null==t||"number"==typeof t&&!Number.isFinite(t))return"";const n=String(t);return-1!==n.indexOf(r)?r+n.replace(new RegExp(r,"g"),r+r)+r:new RegExp(`[\n\r${e}]`).test(n)?r+n+r:n}(t,e,r)).join(e)).join(n)}function wo(t){const e={},r=t.slice(0);function n(t){const r=t.name();let n,u,o;for(r?(n=r,u=0,o=n):(n="X",u=1,o=`${n}.${u}`);Object.prototype.hasOwnProperty.call(e,o);)o=`${n}.${++u}`;o!==r&&t.name(o,r)}t.forEach(t=>{n(t),e[t.name()]=t});const u={columns:()=>t,column(r){if(qr(r)){if(void 0!==e[r])return e[r];throw new Error('No column found with that name: "'+r+'"')}if(!(r<0)){if(void 0!==t[r])return t[r];throw new Error("No column found with that name or index: "+r)}},numColumns:()=>t.length,numRows:()=>t[0].length,eachColumn(e){t.forEach(e)},hasColumn:r=>void 0!==(qr(r)?e[r]:t[r]),indexOf:r=>u.hasColumn(r)?t.indexOf(e[r]):-1,list:()=>go(t[0].length).map(u.row),row(e){if(e>=t[0].length)return{};const r={};return t.forEach(t=>{r[t.name()]=t.val(e)}),r},csv({includeComputedColumns:e=!0,includeHeader:r=!0,numeral:n=null,...o}={}){const a=u.numRows(),i=(e?t:t.filter(t=>!t.isComputed)).map(t=>[...r?[t.title()]:[],...t.formatted(n)]),s=i[0].map((t,e)=>i.map(t=>t[e])).slice(0,a+1);return!o.delimiter&&n&&(o.delimiter=function(t){try{if(","===t.localeData().delimiters.decimal)return";"}catch(t){}return","}(n)),Mo(s,o)},toCSV(){return this.csv(...arguments)},filterColumns:r=>(t=t.filter(t=>!r[t.name()]),ku(r,(t,r)=>{t&&e[r]&&delete e[r]}),u),eachRow(t){var e;for(e=0;e<u.numRows();e++)t(e);return u},add:o=>(n(o),t.push(o),e[o.name()]=o,r.push(o),u),limitRows:e=>(t.forEach(t=>{t.limitRows(e)}),u),limitColumns:e=>(t.length>e&&(t.length=e,r.length=e),u),columnOrder(e){return arguments.length?(t.length=0,e.forEach((function(e){t.push(r[e])})),u):t.map((function(t){return r.indexOf(t)}))},align(e=""){const r=Math.max(...t.map(t=>t.length));for(const n of t){const t=Array(r-n.length).fill(e);n.add(...t)}},clone:()=>wo(t.map(t=>t.clone())),clear(){for(const e of t)e.clear()},deleteRow(...e){e.sort();for(const r of t){let t=0;e.forEach(e=>{const n=r.deleteRow(e-t);t+=n.length})}return u}};return u}bo._=bo;const _o=/^ */.source,Do=/[*']* *$/.source,jo=/[ \-/.]?/.source,xo=/[ \-/.]/.source,No=/[ \-/.;,]/.source,Co=/[ \-|T]/.source,Oo=/[ \-/.m]/.source,So={YY:{parse:/['’‘]?(\d{2})/},YYYY:{test:/([12]\d{3})/,parse:/(\d{4})/},YYYY2:{test:/(?:1[7-9]|20)\d{2}/,parse:/(\d{4})/},H:{parse:/h([12])/},Q:{parse:/q([1234])/},W:{parse:/w([0-5]?[0-9])/},MM:{test:/(0?[1-9]|1[0-2])/,parse:/(0?[1-9]|1[0-2])/},DD:{parse:/(0?[1-9]|[1-2][0-9]|3[01])/},DOW:{parse:/([0-7])/},HHMM:{parse:/(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *(am|pm)?/}},Ao={0:["jan","january","januar","jänner","jän","janv","janvier","ene","enero","gen","gennaio","janeiro"],1:["feb","february","febr","februar","fév","févr","février","febrero","febbraio","fev","fevereiro"],2:["mar","mär","march","mrz","märz","mars","mars","marzo","marzo","março"],3:["apr","april","apr","april","avr","avril","abr","abril","aprile"],4:["may","mai","mayo","mag","maggio","maio","maj"],5:["jun","june","juni","juin","junio","giu","giugno","junho"],6:["jul","july","juli","juil","juillet","julio","lug","luglio","julho"],7:["aug","august","août","ago","agosto"],8:["sep","september","sept","septembre","septiembre","set","settembre","setembro"],9:["oct","october","okt","oktober","octobre","octubre","ott","ottobre","out","outubro"],10:["nov","november","november","novembre","noviembre","novembre","novembro"],11:["dec","december","dez","des","dezember","déc","décembre","dic","diciembre","dicembre","desember","dezembro"]},Ro={};ku(Ao,(function(t,e){ku(t,(function(t){Ro[t]=e}))})),So.MMM={parse:new RegExp("("+co(kn(Ao)).join("|")+")")},ku(So,(function(t){t.parse=t.parse.source,Ur(t.test)?t.test=t.test.source:t.test=t.parse}));var Eo={YYYY:{test:Ho(So.YYYY2.test),parse:Ho(So.YYYY2.parse),precision:"year"},"YYYY-H":{test:Ho(So.YYYY.test,jo,So.H.test),parse:Ho(So.YYYY.parse,jo,So.H.parse),precision:"half"},"H-YYYY":{test:Ho(So.H.test,xo,So.YYYY.test),parse:Ho(So.H.parse,xo,So.YYYY.parse),precision:"half"},"YYYY-Q":{test:Ho(So.YYYY.test,jo,So.Q.test),parse:Ho(So.YYYY.parse,jo,So.Q.parse),precision:"quarter"},"Q-YYYY":{test:Ho(So.Q.test,xo,So.YYYY.test),parse:Ho(So.Q.parse,xo,So.YYYY.parse),precision:"quarter"},"YYYY-M":{test:Ho(So.YYYY.test,Oo,So.MM.test),parse:Ho(So.YYYY.parse,Oo,So.MM.parse),precision:"month"},"M-YYYY":{test:Ho(So.MM.test,xo,So.YYYY.test),parse:Ho(So.MM.parse,xo,So.YYYY.parse),precision:"month"},"YYYY-MMM":{test:Ho(So.YYYY.test,xo,So.MMM.parse),parse:Ho(So.YYYY.parse,xo,So.MMM.parse),precision:"month"},"MMM-YYYY":{test:Ho(So.MMM.parse,xo,So.YYYY.test),parse:Ho(So.MMM.parse,xo,So.YYYY.parse),precision:"month"},"MMM-YY":{test:Ho(So.MMM.parse,xo,So.YY.test),parse:Ho(So.MMM.parse,xo,So.YY.parse),precision:"month"},MMM:{test:Ho(So.MMM.parse),parse:Ho(So.MMM.parse),precision:"month"},"YYYY-WW":{test:Ho(So.YYYY.test,jo,So.W.test),parse:Ho(So.YYYY.parse,jo,So.W.parse),precision:"week"},"WW-YYYY":{test:Ho(So.W.test,xo,So.YYYY.test),parse:Ho(So.W.parse,xo,So.YYYY.parse),precision:"week"},"MM/DD/YYYY":{test:Ho(So.MM.test,"([\\-\\/])",So.DD.test,"\\2",So.YYYY.test),parse:Ho(So.MM.parse,"([\\-\\/])",So.DD.parse,"\\2",So.YYYY.parse),precision:"day"},"MM/DD/YY":{test:Ho(So.MM.test,"([\\-\\/])",So.DD.test,"\\2",So.YY.test),parse:Ho(So.MM.parse,"([\\-\\/])",So.DD.parse,"\\2",So.YY.parse),precision:"day"},"DD/MM/YY":{test:Ho(So.DD.test,"([\\-\\.\\/ ?])",So.MM.test,"\\2",So.YY.test),parse:Ho(So.DD.parse,"([\\-\\.\\/ ?])",So.MM.parse,"\\2",So.YY.parse),precision:"day"},"DD/MM/YYYY":{test:Ho(So.DD.test,"([\\-\\.\\/ ?])",So.MM.test,"\\2",So.YYYY.test),parse:Ho(So.DD.parse,"([\\-\\.\\/ ?])",So.MM.parse,"\\2",So.YYYY.parse),precision:"day"},"DD/MMM/YYYY":{test:Ho(So.DD.test,"([\\-\\.\\/ ?])",So.MMM.test,"\\2",So.YYYY.test),parse:Ho(So.DD.parse,"([\\-\\.\\/ ?])",So.MMM.parse,"\\2",So.YYYY.parse),precision:"day"},"DD/MMM/YY":{test:Ho(So.DD.test,"([\\-\\.\\/ ?])",So.MMM.test,"\\2",So.YY.test),parse:Ho(So.DD.parse,"([\\-\\.\\/ ?])",So.MMM.parse,"\\2",So.YY.parse),precision:"day"},"YYYY-MM-DD":{test:Ho(So.YYYY.test,"([\\-\\.\\/ ?])",So.MM.test,"\\2",So.DD.test),parse:Ho(So.YYYY.parse,"([\\-\\.\\/ ?])",So.MM.parse,"\\2",So.DD.parse),precision:"day"},"MMM-DD-YYYY":{test:Ho(So.MMM.test,xo,So.DD.test,No,So.YYYY.test),parse:Ho(So.MMM.parse,xo,So.DD.parse,No,So.YYYY.parse),precision:"day"},"YYYY-WW-d":{test:Ho(So.YYYY.test,jo,So.W.test,xo,So.DOW.test),parse:Ho(So.YYYY.parse,jo,So.W.parse,xo,So.DOW.parse),precision:"day"},"MM/DD/YYYY HH:MM":{test:Ho(So.MM.test,"([\\-\\/])",So.DD.test,"\\2",So.YYYY.test,Co,So.HHMM.test),parse:Ho(So.MM.parse,"([\\-\\/])",So.DD.parse,"\\2",So.YYYY.parse,Co,So.HHMM.parse),precision:"day-minutes"},"DD.MM.YYYY HH:MM":{test:Ho(So.DD.test,"([\\-\\.\\/ ?])",So.MM.test,"\\2",So.YYYY.test,Co,So.HHMM.test),parse:Ho(So.DD.parse,"([\\-\\.\\/ ?])",So.MM.parse,"\\2",So.YYYY.parse,Co,So.HHMM.parse),precision:"day-minutes"},"YYYY-MM-DD HH:MM":{test:Ho(So.YYYY.test,"([\\-\\.\\/ ?])",So.MM.test,"\\2",So.DD.test,Co,So.HHMM.test),parse:Ho(So.YYYY.parse,"([\\-\\.\\/ ?])",So.MM.parse,"\\2",So.DD.parse,Co,So.HHMM.parse),precision:"day-minutes"},ISO8601:{test:/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d(\.\d+)?([+-][0-2]\d:[0-5]\d|Z)/,parse:function(t){return t},precision:"day-seconds"}};function Ho(){return new RegExp(_o+Array.prototype.slice.call(arguments).join(" *")+Do,"i")}function Lo(t,e){var r=Eo[e];return Ur(r.test)?r.test.test(t):r.test(t,e)}function To(t,e,r){var n=new Date(Date.UTC(t,0,3));return n.setUTCDate(3-n.getUTCDay()+7*(e-1)+parseInt(r,10)),n}function ko(t,e){return 12!==t?t+("pm"===e?12:0):"am"===e?0:12}var Io={text:function(){return{parse:Kn,errors:function(){return 0},name:function(){return"text"},isValid:function(){return!0},format:function(){}}},number:function(t){let e,r=0;const n={"-.":/^ *[-–—−]?[0-9]*(\.[0-9]+)?(e[+-][0-9]+)?%? *$/,"-,":/^ *[-–—−]?[0-9]*(,[0-9]+)?%? *$/,",.":/^ *[-–—−]?[0-9]{1,3}(,[0-9]{3})*(\.[0-9]+)?%? *$/,".,":/^ *[-–—−]?[0-9]{1,3}(\.[0-9]{3})*(,[0-9]+)?%? *$/," .":/^ *[-–—−]?[0-9]{1,3}([   ][0-9]{3})*(\.[0-9]+)?%? *$/," ,":/^ *[-–—−]?[0-9]{1,3}([   ][0-9]{3})*(,[0-9]+)?%? *$/,"'.":/^ *[-–—−]?[0-9]{1,3}('[0-9]{3})*(\.[0-9]+)?%? *$/},u={"-.":"1234.56","-,":"1234,56",",.":"1,234.56",".,":"1.234,56"," .":"1 234.56"," ,":"1 234,56"," .":"1 234.56"," ,":"1 234,56"," .":"1 234.56"," ,":"1 234,56"},o={na:1,"n/a":1,"-":1,":":1},a={},i=["-.",0];ku(t=t||[],(function(t){ku(n,(function(e,r){void 0===a[r]&&(a[r]=0),e.test(t)&&(a[r]+=1,a[r]>i[1]&&(i[0]=r,i[1]=a[r]))}))})),e=i[0];var s={parse:function(t){if(zr(t)||Wr(t)||Fr(t))return t;var n=t.replace("%","").replace("−","-").replace(/[   ]/g,"").replace("–","-").replace("—","-");return"-"!==e[0]&&(n=n.replace(new RegExp("."===e[0]?"\\.":e[0],"g"),"")),"."!==e[1]&&(n=n.replace(e[1],".")),isNaN(n)||""===n?(o[n.toLowerCase()]||""===n||r++,t):Number(n)},toNum:function(t){return t},fromNum:function(t){return t},errors:function(){return r},name:function(){return"number"},isValid:function(t){return""===t||o[String(t).toLowerCase()]||zr(s.parse(t))},ambiguousFormats:function(){var t=[];return ku(a,(function(e,r){e===i[1]&&t.push([r,u[r]])})),t},format:function(t){return arguments.length?(e=t,s):e}};return s},date:function(t){let e,r=0;const n={},u=["",0];t=t||[],ku(Eo,(function(e,r){ku(t,(function(t){void 0===n[r]&&(n[r]=0),Lo(t,r)&&(n[r]+=1,n[r]>u[1]&&(u[0]=r,u[1]=n[r]))}))})),e=u[0];const o={parse:function(t){if(Pr(t)||Wr(t))return t;if(!e||!qr(t))return r++,t;var n,u,o,a=(n=t.toLowerCase(),Ur((o=Eo[u=e]).parse)?n.match(o.parse):o.parse(n,u));if(!a)return r++,t;function i(t){return(t=+t)<30?2e3+t:1900+t}Lo(t,e)||r++;var s=(new Date).getFullYear();switch(e){case"YYYY":return new Date(a[1],0,1);case"YYYY-H":return new Date(a[1],6*(a[2]-1),1);case"H-YYYY":return new Date(a[2],6*(a[1]-1),1);case"YYYY-Q":return new Date(a[1],3*(a[2]-1),1);case"Q-YYYY":return new Date(a[2],3*(a[1]-1),1);case"YYYY-M":return new Date(a[1],a[2]-1,1);case"M-YYYY":return new Date(a[2],a[1]-1,1);case"YYYY-MMM":return new Date(+a[1],Ro[a[2]],1);case"MMM-YYYY":return new Date(+a[2],Ro[a[1]],1);case"MMM-YY":return new Date(i(+a[2]),Ro[a[1]],1);case"MMM":return new Date(s,Ro[a[1]],1);case"YYYY-WW":return To(a[1],a[2],1);case"WW-YYYY":return To(a[2],a[1],1);case"YYYY-WW-d":return To(a[1],a[2],a[3]);case"YYYY-MM-DD":return new Date(a[1],a[3]-1,a[4]);case"DD/MM/YYYY":return new Date(a[4],a[3]-1,a[1]);case"DD/MMM/YYYY":return new Date(a[4],Ro[a[3]],a[1]);case"DD/MMM/YY":return new Date(i(a[4]),Ro[a[3]],a[1]);case"MM/DD/YYYY":return new Date(a[4],a[1]-1,a[3]);case"MM/DD/YY":return new Date(i(a[4]),a[1]-1,a[3]);case"DD/MM/YY":return new Date(i(a[4]),a[3]-1,a[1]);case"MMM-DD-YYYY":return new Date(a[3],Ro[a[1]],a[2]);case"YYYY-MM-DD HH:MM":return new Date(+a[1],a[3]-1,+a[4],ko(+a[5],a[8]),+a[6]||0,+a[7]||0);case"DD.MM.YYYY HH:MM":return new Date(+a[4],a[3]-1,+a[1],ko(+a[5],a[8]),+a[6]||0,+a[7]||0);case"MM/DD/YYYY HH:MM":return new Date(+a[4],a[1]-1,+a[3],ko(+a[5],a[8]),+a[6]||0,+a[7]||0);case"ISO8601":return new Date(a.toUpperCase());default:console.warn("unknown format",e)}return r++,t},toNum:function(t){return Pr(t)?t.getTime():Number.NaN},fromNum:function(t){return new Date(t)},errors:function(){return r},name:function(){return"date"},format:function(t){return arguments.length?(e=t,o):e},precision:function(){return Eo[e].precision},isValid:function(t){return Pr(o.parse(t))},ambiguousFormats:function(){var t=[];return ku(n,(function(e,r){e===u[1]&&t.push([r,r])})),t}};return o}};const $o=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,Fo=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;function Wo(t,e){if(null===t)return null;if(void 0!==t){if((t=String(t)).indexOf("<")<0&&t.indexOf(">")<0)return t;if(t=Bo(t,e),"undefined"==typeof document)return t;var r=document.createElement("div");r.innerHTML=`<span>${t}</span>`,r.innerHTML=Bo(r.innerHTML,e&&!e.includes("<span>")?e+"<span>":void 0);for(var n=r.childNodes[0].querySelectorAll("*"),u=0;u<n.length;u++){if("a"===n[u].nodeName.toLowerCase()){"_self"!==n[u].getAttribute("target")&&n[u].setAttribute("target","_blank"),n[u].setAttribute("rel","nofollow noopener noreferrer");const t=(n[u].getAttribute("href")||"").toLowerCase().replace(/[^a-z0-9 -/:?=]/g,"").trim();(t.startsWith("javascript:")||t.startsWith("vbscript:")||t.startsWith("data:"))&&n[u].setAttribute("href","")}const t=[];for(var o=0;o<n[u].attributes.length;o++){var a=n[u].attributes[o];a.specified&&"on"===a.name.substr(0,2)&&t.push(a.name)}t.forEach(t=>n[u].removeAttribute(t))}return r.childNodes[0].innerHTML}}function Bo(t,e){e=(((void 0!==e?e||"":"<a><span><b><br><br/><i><strong><sup><sub><strike><u><em><tt>")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");for(var r=t,n=t;;)if(n=(r=n).replace(Fo,"").replace($o,(function(t,r){return e.indexOf("<"+r.toLowerCase()+">")>-1?t:""})),r===n)return n}function Vo(t,e,r){function n(t){return null!=t&&""!==t}const u=Ku(go(e.length)).filter((function(t){return n(e[t])})).slice(0,200).map((function(t){return e[t]}));r=r?Io[r](u):function(t){if(Vu(e,zr))return Io.number();if(Vu(e,Pr))return Io.date();const r=[Io.date(t),Io.number(t),Io.text()];let u;const o=.1*e.filter(n).length;return ku(e,(function(t){ku(r,(function(e){e.parse(t)}))})),Vu(r,(function(t){return t.errors()<o&&(u=t),!u})),Wr(u)&&(u=r[2]),u}(u);let o,a,i,s,c=t;const l=e.slice(0);let f;var p={name(){return arguments.length>=1?(t=arguments[0],c=2===arguments.length?arguments[1]:t,p):Wo(t)},origName:()=>Wo(c),title(){return arguments.length?(f=arguments[0],p):Wo(f||t)},length:e.length,val(t,n){if(arguments.length){var u=n?l:e;return t<0&&(t+=u.length),r.parse(Pr(u[t])||zr(u[t])?u[t]:Wo(u[t]))}},formatted(t=null){return t&&"number"===this.type()?this.values().map(e=>Number.isFinite(e)?t(e).format("0.[00000000000000000000]"):e):this.raw()},values(t){var n=t?l:e;return n=Iu(n,(function(t){return Pr(t)||zr(t)?t:Wo(t)})),Iu(n,r.parse)},each(t){for(var r=0;r<e.length;r++)t(p.val(r),r)},raw(t,r){return arguments.length?2===arguments.length?(e[t]=r,p):Pr(e[t])||zr(e[t])?e[t]:Wo(e[t]):e.map(t=>Pr(t)||zr(t)?t:Wo(t))},type(t){if(!0===t)return r;if(qr(t)){if(Io[t])return r=Io[t](u),p;throw new Error("unknown column type: "+t)}return r.name()},range:()=>!!r.toNum&&(o||(o=[Number.MAX_VALUE,-Number.MAX_VALUE],p.each((function(t){t=r.toNum(t),zr(t)&&!ln(t)&&(t<o[0]&&(o[0]=t),t>o[1]&&(o[1]=t))})),o[0]=r.fromNum(o[0]),o[1]=r.fromNum(o[1])),o),sum:()=>!!r.toNum&&(void 0===a&&(a=0,p.each((function(t){const e=r.toNum(t);Number.isFinite(e)&&(a+=e)})),a=r.fromNum(a)),a),mean(){if(!r.toNum)return!1;if(void 0===i){i=0;let t=0;p.each((function(e){const n=r.toNum(e);Number.isFinite(n)&&(i+=n,t++)})),i=r.fromNum(i/t)}return i},median(){if(!r.toNum)return!1;if(void 0===s){const t=p.values().map(r.toNum);s=r.fromNum(function(t){var e,r=[],n=t.length,u=-1;if(1===arguments.length)for(;++u<n;)Po(e=zo(t[u]))&&r.push(e);if(r.length)return qo(r.sort(Uo),.5)}(t))}return s},filterRows(t){return e=[],arguments.length?ku(t,(function(t){e.push(l[t])})):e=l.slice(0),p.length=e.length,o=a=i=s=void 0,p},deleteRow(t){const r=e.splice(t,1);return l.splice(t,1),p.length=e.length,o=a=i=s=void 0,r},toString:()=>t+" ("+r.name()+")",indexOf:t=>Tu(go(e.length),(function(e){return p.val(e)===t})),limitRows(t){l.length>t&&(l.length=t,e.length=t,p.length=t)},add(...t){l.push(...t),e.push(...t),p.length=e.length},clone:()=>Vo(t,e.slice(),r.name()),clear(){e.splice(0),p.length=e.length}};return p.total=p.sum,p}function qo(t,e){var r=(t.length-1)*e+1,n=Math.floor(r),u=+t[n-1],o=r-n;return o?u+o*(t[n]-u):u}function zo(t){return null===t?NaN:+t}function Po(t){return!ln(t)}function Uo(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Qo(t){return{dataset:function(){return function(){if(t.url){const e=(new Date).getTime(),r=`${t.url}${t.url.indexOf("?")>-1?"&":"?"}v=${t.url.indexOf("//static.dwcdn.net")>-1?e-e%6e4:e}`;return window.fetch(r).then(t=>t.text()).then(e=>new Jo(t).parse(e))}if(t.csv||""===t.csv){return new Promise(e=>{e(t.csv)}).then(e=>new Jo(t).parse(e))}throw new Error("you need to provide either an URL or CSV data.")}().catch(t=>(console.error("could not fetch datasource, returning an empty dataset",t),wo([])))},parse:function(){return new Jo(t).parse(t.csv)}}}wo.delimited=Qo;class Jo{constructor(t){t=Object.assign({delimiter:"auto",quoteChar:'"',skipRows:0,emptyValue:null,transpose:!1,firstRowIsHeader:!0},t),this.__delimiterPatterns=Ko(t.delimiter,t.quoteChar),this.opts=t}parse(t){this.__rawData=t;const e=this.opts;"auto"===e.delimiter&&(e.delimiter=this.guessDelimiter(t,e.skipRows),this.__delimiterPatterns=Ko(e.delimiter,e.quoteChar));const r="|"!==e.delimiter?"|":"#";let n;return t=r+"\n"+t.replace(/[ \r\n\f]+$/g,"").replace(/^\uFEFF/,"")+r,n=function(t,e,n){n=n||",";const u=[[]];let o,a=null;for(;a=t.exec(e);){var i=a[1];i.length&&i!==n&&u.push([]),o=a[2]?a[2].replace(new RegExp('""',"g"),'"'):a[3],u[u.length-1].push(void 0===o?"":o)}u[0][0].substr(0,1)===r&&(u[0][0]=u[0][0].substr(1));const s=u.length-1,c=u[s].length-1,l=u[s][c].length-1;return u[s][c].substr(l)===r&&(u[s][c]=u[s][c].substr(0,l)),u.slice(1)}(this.__delimiterPatterns,t,e.delimiter),e.transpose&&(n=function(t){const e=t,r=e.length?e.length:0,n=e[0]instanceof Array?e[0].length:0;if(0===n||0===r)return[];let u,o;const a=[];for(u=0;u<n;u++)for(a[u]=[],o=0;o<r;o++)a[u][o]=e[o][u];return a}(n)),function(t){return wo(function(t){if(!t)return[];if(!(t=t.slice(e.skipRows)).length)return[];const r=t[0],n={};let u=[],o=0;return e.firstRowIsHeader&&(u=t[o],o++,t.shift()),r.map((r,o)=>{const a=t.map(t=>""!==t[o]?t[o]:e.emptyValue);let i=qr(u[o])?u[o].replace(/^\s+|\s+$/g,""):"",s=""!==i?"":1;for(i=""!==i?i:"X.";void 0!==n[i+s];)s=""===s?1:s+1;return n[i+s]=!0,Vo(i+s,a)})}(t))}(function(t){for(let e=t.length-1;e>=0;e--)if(t[e].some(t=>""!==t))return t.slice(0,e+1);return t.slice(0,1)}(n))}guessDelimiter(t){let e=0,r=-1;const n=this,u=["\t",";","|",","];return u.forEach((u,o)=>{const a=Ko(u,n.quoteChar);let i=t.match(a).length;"\t"===u&&(i*=1.15),i>e&&(e=i,r=o)}),u[r]}}function Ko(t,e){return new RegExp("(\\"+t+"|\\r?\\n|\\r|^)(?:"+e+"([^"+e+"]*(?:"+e+'"[^'+e+"]*)*)"+e+"|([^"+e+"\\"+t+"\\r\\n]*))","gi")}function Xo(t){if(!t||"object"!=typeof t)return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}let Go=null,Zo=null;var ta={render(){const{hot:t}=this.get();t.render()},doSearch(){const{hot:t,search:e}=this.get();clearTimeout(Zo),Zo=setTimeout(()=>{if(t&&e){const r=t.getPlugin("search").query(e);this.set({searchResults:r})}else this.set({searchResults:[]})},300)},update(){const{data:t,transpose:e,firstRowIsHeader:r,skipRows:u,hot:o}=this.get();if(!t)return;const{dw_chart:a}=this.store.get(),i=a.dataset(Qo({csv:t,transpose:e,firstRowIsHeader:r,skipRows:u}).parse()).dataset();this.set({columnOrder:i.columnOrder()});const s=[[]];i.eachColumn(t=>s[0].push(t.title())),i.eachRow(t=>{const e=[];i.eachColumn(r=>e.push(r.raw(t))),s.push(e)}),o.loadData(s);const c=Yr(this,a,i,n.default);o.updateSettings({cells:(t,e)=>{const{readonly:r}=this.get();return{readOnly:r||i.hasColumn(e)&&i.column(e).isComputed&&0===t,renderer:c}},manualColumnMove:[]}),this.set({ds:i}),this.set({has_changes:Xo(a.get("metadata.data.changes",[])).length>0}),n.default.hooks.once("afterRender",()=>this.initCustomEvents()),n.default.hooks.once("afterRender",()=>this.fire("afterRender")),o.render()},dataChanged(t){const{hot:e}=this.get();let r=!1;t.forEach(([t,n,u,o])=>{if(u!==o){const a=this.store.get().dw_chart,{transpose:i}=this.get(),s=Xo(a.get("metadata.data.changes",[]));if(t=e.toPhysicalRow(t),n=a.dataset().columnOrder()[n],i){const e=t;t=n,n=e}s.push({column:n,row:t,value:o,previous:u,time:(new Date).getTime()}),a.set("metadata.data.changes",s),r=!0}}),r&&setTimeout(()=>{this.update(),chart.save()},100)},columnMoved(t,e){const{hot:r}=this.get();if(!t.length)return;const{columnOrder:u}=this.get(),o=u.slice(0),a=u[e],i=o.splice(t[0],t.length),s=void 0===a?o.length:a?o.indexOf(a):0;o.splice(s,0,...i),this.store.get().dw_chart.set("metadata.data.column-order",o.slice(0)),this.set({columnOrder:o}),n.default.hooks.once("afterRender",()=>{setTimeout(()=>{this.fire("resetSort"),r.selectCell(0,s,r.countRows()-1,s+i.length-1)},10)}),this.update()},updateHeight(){const t=this.refs.hot.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(500,t+10)+"px"},checkRange(t,e,r,n){const{hot:u}=this.get(),{ds:o}=this.get();if(e!==n||0!==t||r!==u.countRows()-1)if(e===n||0!==t||r!==u.countRows()-1)this.set({activeColumn:null,multiSelection:!1});else{const t=[];for(let r=Math.min(e,n);r<=Math.max(e,n);r++)t.push(+document.querySelector(`#data-preview .htCore tbody tr:first-child td:nth-child(${r+2})`).dataset.column);this.set({multiSelection:t.map(t=>o.column(t)),activeColumn:null})}},initCustomEvents(){setTimeout(()=>{this.refs.hot.querySelectorAll(".htCore thead th:first-child").forEach(t=>{t.removeEventListener("click",ua),t.addEventListener("click",ua)}),this.refs.hot.querySelectorAll(".htCore thead th+th").forEach(t=>{t.removeEventListener("click",na),t.addEventListener("click",na)})},500)},getColumnFormat(t){const{dw_chart:e}=this.store.get();return e.get("metadata.data.column-format",{})[t]||{type:"auto",ignore:!1}}};function ea(){Go=this,n.default.hooks.once("afterRender",()=>this.initCustomEvents()),window.addEventListener("keyup",t=>{const{activeColumn:e,ds:r}=this.get();if(e&&"input"!==t.target.tagName.toLowerCase()&&"textarea"!==t.target.tagName.toLowerCase()&&("ArrowRight"===t.key||"ArrowLeft"===t.key)){t.preventDefault(),t.stopPropagation();const n=r.indexOf(e.name());"ArrowRight"===t.key?this.set({activeColumn:r.column((n+1)%r.numColumns())}):this.set({activeColumn:r.column((n-1+r.numColumns())%r.numColumns())})}});const{dw_chart:t}=this.store.get(),e=new n.default(this.refs.hot,{data:[],rowHeaders:t=>n.default.hooks.run(e,"modifyRow",t)+1,colHeaders:!0,fixedRowsTop:1,fixedColumnsLeft:this.get().fixedColumnsLeft,filters:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:500,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0,syncLimit:5},sortIndicator:!0,columnSorting:!0,sortFunction:function(e,r){if(r.col>-1){const n=t.dataset().column(r.col),u=n.type();return(t,r)=>0===t[0]?-1:(t[1]=n.val(t[0]-1),r[1]=n.val(r[0]-1),"number"===u&&(isNaN(t[1])&&(t[1]=e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),isNaN(r[1])&&(r[1]=e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY)),"date"===u&&("string"==typeof t[1]&&(t[1]=new Date(110,0,1)),"string"==typeof r[1]&&(r[1]=new Date(110,0,1))),("desc"===e?-1:1)*(t[1]>r[1]?1:t[1]<r[1]?-1:0))}return(t,e)=>t[0]-e[0]},afterGetColHeader:(t,e)=>{const{activeColumn:r,ds:n}=this.get();n&&n.hasColumn(t)&&((0===t||t)&&r&&n.column(t).name()===r.name()&&e.classList.add("selected"),(0===t||t)&&(this.getColumnFormat(n.column(t).name()).ignore?e.classList.add("ignored"):e.classList.remove("ignored")))},search:"search"});window.HT=e,this.set({hot:e}),n.default.hooks.add("afterSetDataAtCell",t=>this.dataChanged(t)),n.default.hooks.add("afterColumnMove",(t,e)=>this.columnMoved(t,e)),n.default.hooks.add("afterRender",()=>this.updateHeight()),n.default.hooks.add("afterSelection",(t,e,r,n)=>this.checkRange(t,e,r,n))}function ra({changed:t,current:e,previous:r}){const n=e.hot;if(n){if(t.data&&this.update(),t.firstRowIsHeader&&r&&void 0!==r.firstRowIsHeader&&this.update(),t.hot&&this.update(),t.search&&r&&(this.doSearch(),this.set({searchIndex:0})),t.searchResults&&n.render(),t.currentResult&&e.currentResult){n.render();const t=e.currentResult;n.scrollViewportTo(t.row,t.col),setTimeout(()=>{n.scrollViewportTo(t.row,t.col)},100)}t.activeColumn&&setTimeout(()=>n.render(),10),t.fixedColumnsLeft&&n.updateSettings({fixedColumnsLeft:e.fixedColumnsLeft}),t.sorting&&n.getPlugin("columnSorting").sort(chart.dataset().indexOf(e.sorting.sortBy),e.sorting.sortDir?"asc":"desc")}}function na(t){const e=this,r=e.parentNode.children.length;let n=-1;for(let t=0;t<r;t++)if(e.parentNode.children.item(t)===e){n=t;break}const u=+Go.refs.hot.querySelector(`.htCore tbody tr:first-child td:nth-child(${n+1})`).dataset.column,{dw_chart:o}=Go.store.get(),{activeColumn:a,hot:i}=Go.get();if(o.dataset().hasColumn(u)){const e=o.dataset().column(+u);a&&a.name()===e.name()?(t.target.parentNode.classList.remove("selected"),Go.set({activeColumn:!1}),i.deselectCell()):(t.target.parentNode.classList.add("selected"),Go.set({activeColumn:e}))}}function ua(t){t.preventDefault();const{transpose:e}=Go.get();Go.set({transpose:!e}),Go.update()}function oa(t,e){var r;return{c(){var t;t="div",(r=document.createElement(t)).id="data-preview"},m(e,n){!function(t,e,r){t.insertBefore(e,r)}(e,r,n),t.refs.hot=r},p:o,d(e){var n;e&&(n=r).parentNode.removeChild(n),t.refs.hot===r&&(t.refs.hot=null)}}}function aa(t){!function(t,e){t._handlers=s(),t._slots=s(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}(this,t),this.refs={},this._state=a({hot:null,data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,fixedColumnsLeft:0,searchIndex:0,sortBy:"-",transpose:!1,activeColumn:null,search:"",searchResults:[]},t.data),this._recompute({searchResults:1,searchIndex:1},this._state),this._intro=!0,this._handlers.state=[ra],ra.call(this,{changed:i({},this._state),current:this._state}),this._fragment=oa(this,this._state),this.root._oncreate.push(()=>{ea.call(this),this.fire("update",{changed:i({},this._state),current:this._state})}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),c(this))}return a(aa.prototype,f),a(aa.prototype,ta),aa.prototype._recompute=function(t,e){(t.searchResults||t.searchIndex)&&this._differs(e.currentResult,e.currentResult=function({searchResults:t,searchIndex:e}){if(!t||!t.length)return null;const r=t.length;if(e<0||e>=r){for(;e<0;)e+=r;e>r&&(e%=r)}return t[e]}(e))&&(t.currentResult=!0)},{Handsontable:aa}}));
