!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("Handsontable"),require("dayjs")):"function"==typeof define&&define.amd?define(["Handsontable","dayjs"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["describe/hot"]=e(t.HOT,t.dayjs)}(this,(function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=n(t),a=n(e);function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function i(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=n){var r,a,o=[],u=!0,i=!1;try{for(n=n.call(t);!(u=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);u=!0);}catch(t){i=!0,a=t}finally{try{u||null==n.return||n.return()}finally{if(i)throw a}}return o}}(t,e)||u(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(){}function h(t,e){for(var n in e)t[n]=e[n];return t}function d(t,e){for(var n in e)t[n]=1;return t}function p(){return Object.create(null)}function v(t){t._lock=!0,m(t._beforecreate),m(t._oncreate),m(t._aftercreate),t._lock=!1}function m(t){for(;t&&t.length;)t.shift()()}var g={destroy:function(t){this.destroy=f,this.fire("destroy"),this.set=f,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:function(){return this._state},fire:function(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var r=0;r<n.length;r+=1){var a=n[r];if(!a.__calling)try{a.__calling=!0,a.call(this,e)}finally{a.__calling=!1}}},on:function(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}},set:function(t){this._set(h({},t)),this.root._lock||v(this.root)},_recompute:f,_set:function(t){var e=this._state,n={},r=!1;for(var a in t=h(this._staged,t),this._staged={},t)this._differs(t[a],e[a])&&(n[a]=r=!0);r&&(this._state=h(h({},e),t),this._recompute(n,this._state),this._bind&&this._bind(n,this._state),this._fragment&&(this.fire("state",{changed:n,current:this._state,previous:e}),this._fragment.p(n,this._state),this.fire("update",{changed:n,current:this._state,previous:e})))},_stage:function(t){h(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"===s(t)||"function"==typeof t}},y=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,b=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;function w(t,e){if(null===t)return null;if(void 0!==t){if((t=String(t)).indexOf("<")<0&&t.indexOf(">")<0)return t;if(t=function(t,e){e=(((void 0!==e?e||"":"<a><span><b><br><br/><i><strong><sup><sub><strike><u><em><tt>")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=t,r=t;for(;;)if(r=(n=r).replace(b,"").replace(y,(function(t,n){return e.indexOf("<"+n.toLowerCase()+">")>-1?t:""})),n===r)return r}(t,e),"undefined"==typeof document)return t;var n=document.createElement("div");n.innerHTML="<span>".concat(t,"</span>");for(var r=n.childNodes[0].querySelectorAll("*"),a=0;a<r.length;a++){if("a"===r[a].nodeName.toLowerCase()){"_self"!==r[a].getAttribute("target")&&r[a].setAttribute("target","_blank"),r[a].setAttribute("rel","nofollow noopener noreferrer");var o=(r[a].getAttribute("href")||"").toLowerCase().replace(/[^a-z0-9 -/:?=]/g,"").trim();(o.startsWith("javascript:")||o.startsWith("vbscript:")||o.startsWith("data:"))&&r[a].setAttribute("href","")}for(var u=[],i=0;i<r[a].attributes.length;i++){var c=r[a].attributes[i];c.specified&&"on"===c.name.substr(0,2)&&u.push(c.name)}u.forEach((function(t){return r[a].removeAttribute(t)}))}return n.childNodes[0].innerHTML}}var _="object"==("undefined"==typeof self?"undefined":s(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":s(global))&&global.global===global&&global||Function("return this")()||{},j=Array.prototype,S=Object.prototype,C="undefined"!=typeof Symbol?Symbol.prototype:null,O=j.push,M=j.slice,A=S.toString,R=S.hasOwnProperty,x="undefined"!=typeof ArrayBuffer,N="undefined"!=typeof DataView,I=Array.isArray,L=Object.keys,E=Object.create,T=x&&ArrayBuffer.isView,k=isNaN,D=isFinite,H=!{toString:null}.propertyIsEnumerable("toString"),P=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],F=Math.pow(2,53)-1;function B(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),a=0;a<n;a++)r[a]=arguments[a+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var o=Array(e+1);for(a=0;a<e;a++)o[a]=arguments[a];return o[e]=r,t.apply(this,o)}}function V(t){var e=s(t);return"function"===e||"object"===e&&!!t}function q(t){return void 0===t}function Y(t){return!0===t||!1===t||"[object Boolean]"===A.call(t)}function z(t){var e="[object "+t+"]";return function(t){return A.call(t)===e}}var W=z("String"),U=z("Number"),$=z("Date"),G=z("RegExp"),J=z("Error"),K=z("Symbol"),Q=z("ArrayBuffer"),X=z("Function"),Z=_.document&&_.document.childNodes;"function"!=typeof/./&&"object"!=("undefined"==typeof Int8Array?"undefined":s(Int8Array))&&"function"!=typeof Z&&(X=function(t){return"function"==typeof t||!1});var tt=X,et=z("Object"),nt=N&&et(new DataView(new ArrayBuffer(8))),rt="undefined"!=typeof Map&&et(new Map),at=z("DataView");var ot=nt?function(t){return null!=t&&tt(t.getInt8)&&Q(t.buffer)}:at,ut=I||z("Array");function it(t,e){return null!=t&&R.call(t,e)}var ct=z("Arguments");!function(){ct(arguments)||(ct=function(t){return it(t,"callee")})}();var st=ct;function lt(t){return U(t)&&k(t)}function ft(t){return function(){return t}}function ht(t){return function(e){var n=t(e);return"number"==typeof n&&n>=0&&n<=F}}function dt(t){return function(e){return null==e?void 0:e[t]}}var pt=dt("byteLength"),vt=ht(pt),mt=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var gt=x?function(t){return T?T(t)&&!ot(t):vt(t)&&mt.test(A.call(t))}:ft(!1),yt=dt("length");function bt(t,e){e=function(t){for(var e={},n=t.length,r=0;r<n;++r)e[t[r]]=!0;return{contains:function(t){return e[t]},push:function(n){return e[n]=!0,t.push(n)}}}(e);var n=P.length,r=t.constructor,a=tt(r)&&r.prototype||S,o="constructor";for(it(t,o)&&!e.contains(o)&&e.push(o);n--;)(o=P[n])in t&&t[o]!==a[o]&&!e.contains(o)&&e.push(o)}function wt(t){if(!V(t))return[];if(L)return L(t);var e=[];for(var n in t)it(t,n)&&e.push(n);return H&&bt(t,e),e}function _t(t,e){var n=wt(e),r=n.length;if(null==t)return!r;for(var a=Object(t),o=0;o<r;o++){var u=n[o];if(e[u]!==a[u]||!(u in a))return!1}return!0}function jt(t){return t instanceof jt?t:this instanceof jt?void(this._wrapped=t):new jt(t)}function St(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,pt(t))}jt.VERSION="1.13.1",jt.prototype.value=function(){return this._wrapped},jt.prototype.valueOf=jt.prototype.toJSON=jt.prototype.value,jt.prototype.toString=function(){return String(this._wrapped)};function Ct(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var a=s(t);return("function"===a||"object"===a||"object"==s(e))&&function t(e,n,r,a){e instanceof jt&&(e=e._wrapped);n instanceof jt&&(n=n._wrapped);var o=A.call(e);if(o!==A.call(n))return!1;if(nt&&"[object Object]"==o&&ot(e)){if(!ot(n))return!1;o="[object DataView]"}switch(o){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return C.valueOf.call(e)===C.valueOf.call(n);case"[object ArrayBuffer]":case"[object DataView]":return t(St(e),St(n),r,a)}var u="[object Array]"===o;if(!u&&gt(e)){if(pt(e)!==pt(n))return!1;if(e.buffer===n.buffer&&e.byteOffset===n.byteOffset)return!0;u=!0}if(!u){if("object"!=s(e)||"object"!=s(n))return!1;var i=e.constructor,c=n.constructor;if(i!==c&&!(tt(i)&&i instanceof i&&tt(c)&&c instanceof c)&&"constructor"in e&&"constructor"in n)return!1}a=a||[];var l=(r=r||[]).length;for(;l--;)if(r[l]===e)return a[l]===n;if(r.push(e),a.push(n),u){if((l=e.length)!==n.length)return!1;for(;l--;)if(!Ct(e[l],n[l],r,a))return!1}else{var f,h=wt(e);if(l=h.length,wt(n).length!==l)return!1;for(;l--;)if(f=h[l],!it(n,f)||!Ct(e[f],n[f],r,a))return!1}return r.pop(),a.pop(),!0}(t,e,n,r)}function Ot(t){if(!V(t))return[];var e=[];for(var n in t)e.push(n);return H&&bt(t,e),e}function Mt(t){var e=yt(t);return function(n){if(null==n)return!1;var r=Ot(n);if(yt(r))return!1;for(var a=0;a<e;a++)if(!tt(n[t[a]]))return!1;return t!==It||!tt(n[At])}}var At="forEach",Rt=["clear","delete"],xt=["get","has","set"],Nt=Rt.concat(At,xt),It=Rt.concat(xt),Lt=["add"].concat(Rt,At,"has"),Et=rt?Mt(Nt):z("Map"),Tt=rt?Mt(It):z("WeakMap"),kt=rt?Mt(Lt):z("Set"),Dt=z("WeakSet");function Ht(t){for(var e=wt(t),n=e.length,r=Array(n),a=0;a<n;a++)r[a]=t[e[a]];return r}function Pt(t){for(var e={},n=wt(t),r=0,a=n.length;r<a;r++)e[t[n[r]]]=n[r];return e}function Ft(t){var e=[];for(var n in t)tt(t[n])&&e.push(n);return e.sort()}function Bt(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var a=1;a<r;a++)for(var o=arguments[a],u=t(o),i=u.length,c=0;c<i;c++){var s=u[c];e&&void 0!==n[s]||(n[s]=o[s])}return n}}var Vt=Bt(Ot),qt=Bt(wt),Yt=Bt(Ot,!0);function zt(t){if(!V(t))return{};if(E)return E(t);var e=function(){};e.prototype=t;var n=new e;return e.prototype=null,n}function Wt(t){return V(t)?ut(t)?t.slice():Vt({},t):t}function Ut(t){return ut(t)?t:[t]}function $t(t){return jt.toPath(t)}function Gt(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0}function Jt(t,e,n){var r=Gt(t,$t(e));return q(r)?n:r}function Kt(t){return t}function Qt(t){return t=qt({},t),function(e){return _t(e,t)}}function Xt(t){return t=$t(t),function(e){return Gt(e,t)}}function Zt(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,a){return t.call(e,n,r,a)};case 4:return function(n,r,a,o){return t.call(e,n,r,a,o)}}return function(){return t.apply(e,arguments)}}function te(t,e,n){return null==t?Kt:tt(t)?Zt(t,e,n):V(t)&&!ut(t)?Qt(t):Xt(t)}function ee(t,e){return te(t,e,1/0)}function ne(t,e,n){return jt.iteratee!==ee?jt.iteratee(t,e):te(t,e,n)}function re(){}function ae(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}jt.toPath=Ut,jt.iteratee=ee;var oe=Date.now||function(){return(new Date).getTime()};function ue(t){var e=function(e){return t[e]},n="(?:"+wt(t).join("|")+")",r=RegExp(n),a=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(a,e):t}}var ie={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},ce=ue(ie),se=ue(Pt(ie)),le=jt.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},fe=/(.)^/,he={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},de=/\\|'|\r|\n|\u2028|\u2029/g;function pe(t){return"\\"+he[t]}var ve=/^\s*(\w|\$)+\s*$/;var me=0;function ge(t,e,n,r,a){if(!(r instanceof e))return t.apply(n,a);var o=zt(t.prototype),u=t.apply(o,a);return V(u)?u:o}var ye=B((function(t,e){var n=ye.placeholder;return function r(){for(var a=0,o=e.length,u=Array(o),i=0;i<o;i++)u[i]=e[i]===n?arguments[a++]:e[i];for(;a<arguments.length;)u.push(arguments[a++]);return ge(t,r,this,this,u)}}));ye.placeholder=jt;var be=B((function(t,e,n){if(!tt(t))throw new TypeError("Bind must be called on a function");var r=B((function(a){return ge(t,r,e,this,n.concat(a))}));return r})),we=ht(yt);function _e(t,e,n,r){if(r=r||[],e||0===e){if(e<=0)return r.concat(t)}else e=1/0;for(var a=r.length,o=0,u=yt(t);o<u;o++){var i=t[o];if(we(i)&&(ut(i)||st(i)))if(e>1)_e(i,e-1,n,r),a=r.length;else for(var c=0,s=i.length;c<s;)r[a++]=i[c++];else n||(r[a++]=i)}return r}var je=B((function(t,e){var n=(e=_e(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=be(t[r],t)}return t}));var Se=B((function(t,e,n){return setTimeout((function(){return t.apply(null,n)}),e)})),Ce=ye(Se,jt,1);function Oe(t){return function(){return!t.apply(this,arguments)}}function Me(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}var Ae=ye(Me,2);function Re(t,e,n){e=ne(e,n);for(var r,a=wt(t),o=0,u=a.length;o<u;o++)if(e(t[r=a[o]],r,t))return r}function xe(t){return function(e,n,r){n=ne(n,r);for(var a=yt(e),o=t>0?0:a-1;o>=0&&o<a;o+=t)if(n(e[o],o,e))return o;return-1}}var Ne=xe(1),Ie=xe(-1);function Le(t,e,n,r){for(var a=(n=ne(n,r,1))(e),o=0,u=yt(t);o<u;){var i=Math.floor((o+u)/2);n(t[i])<a?o=i+1:u=i}return o}function Ee(t,e,n){return function(r,a,o){var u=0,i=yt(r);if("number"==typeof o)t>0?u=o>=0?o:Math.max(o+i,u):i=o>=0?Math.min(o+1,i):o+i+1;else if(n&&o&&i)return r[o=n(r,a)]===a?o:-1;if(a!=a)return(o=e(M.call(r,u,i),lt))>=0?o+u:-1;for(o=t>0?u:i-1;o>=0&&o<i;o+=t)if(r[o]===a)return o;return-1}}var Te=Ee(1,Ne,Le),ke=Ee(-1,Ie);function De(t,e,n){var r=(we(t)?Ne:Re)(t,e,n);if(void 0!==r&&-1!==r)return t[r]}function He(t,e,n){var r,a;if(e=Zt(e,n),we(t))for(r=0,a=t.length;r<a;r++)e(t[r],r,t);else{var o=wt(t);for(r=0,a=o.length;r<a;r++)e(t[o[r]],o[r],t)}return t}function Pe(t,e,n){e=ne(e,n);for(var r=!we(t)&&wt(t),a=(r||t).length,o=Array(a),u=0;u<a;u++){var i=r?r[u]:u;o[u]=e(t[i],i,t)}return o}function Fe(t){var e=function(e,n,r,a){var o=!we(e)&&wt(e),u=(o||e).length,i=t>0?0:u-1;for(a||(r=e[o?o[i]:i],i+=t);i>=0&&i<u;i+=t){var c=o?o[i]:i;r=n(r,e[c],c,e)}return r};return function(t,n,r,a){var o=arguments.length>=3;return e(t,Zt(n,a,4),r,o)}}var Be=Fe(1),Ve=Fe(-1);function qe(t,e,n){var r=[];return e=ne(e,n),He(t,(function(t,n,a){e(t,n,a)&&r.push(t)})),r}function Ye(t,e,n){e=ne(e,n);for(var r=!we(t)&&wt(t),a=(r||t).length,o=0;o<a;o++){var u=r?r[o]:o;if(!e(t[u],u,t))return!1}return!0}function ze(t,e,n){e=ne(e,n);for(var r=!we(t)&&wt(t),a=(r||t).length,o=0;o<a;o++){var u=r?r[o]:o;if(e(t[u],u,t))return!0}return!1}function We(t,e,n,r){return we(t)||(t=Ht(t)),("number"!=typeof n||r)&&(n=0),Te(t,e,n)>=0}var Ue=B((function(t,e,n){var r,a;return tt(e)?a=e:(e=$t(e),r=e.slice(0,-1),e=e[e.length-1]),Pe(t,(function(t){var o=a;if(!o){if(r&&r.length&&(t=Gt(t,r)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)}))}));function $e(t,e){return Pe(t,Xt(e))}function Ge(t,e,n){var r,a,o=-1/0,u=-1/0;if(null==e||"number"==typeof e&&"object"!=s(t[0])&&null!=t)for(var i=0,c=(t=we(t)?t:Ht(t)).length;i<c;i++)null!=(r=t[i])&&r>o&&(o=r);else e=ne(e,n),He(t,(function(t,n,r){((a=e(t,n,r))>u||a===-1/0&&o===-1/0)&&(o=t,u=a)}));return o}function Je(t,e,n){if(null==e||n)return we(t)||(t=Ht(t)),t[ae(t.length-1)];var r=we(t)?Wt(t):Ht(t),a=yt(r);e=Math.max(Math.min(e,a),0);for(var o=a-1,u=0;u<e;u++){var i=ae(u,o),c=r[u];r[u]=r[i],r[i]=c}return r.slice(0,e)}function Ke(t,e){return function(n,r,a){var o=e?[[],[]]:{};return r=ne(r,a),He(n,(function(e,a){var u=r(e,a,n);t(o,e,u)})),o}}var Qe=Ke((function(t,e,n){it(t,n)?t[n].push(e):t[n]=[e]})),Xe=Ke((function(t,e,n){t[n]=e})),Ze=Ke((function(t,e,n){it(t,n)?t[n]++:t[n]=1})),tn=Ke((function(t,e,n){t[n?0:1].push(e)}),!0),en=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function nn(t,e,n){return e in n}var rn=B((function(t,e){var n={},r=e[0];if(null==t)return n;tt(r)?(e.length>1&&(r=Zt(r,e[1])),e=Ot(t)):(r=nn,e=_e(e,!1,!1),t=Object(t));for(var a=0,o=e.length;a<o;a++){var u=e[a],i=t[u];r(i,u,t)&&(n[u]=i)}return n})),an=B((function(t,e){var n,r=e[0];return tt(r)?(r=Oe(r),e.length>1&&(n=e[1])):(e=Pe(_e(e,!1,!1),String),r=function(t,n){return!We(e,n)}),rn(t,r,n)}));function on(t,e,n){return M.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function un(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:on(t,t.length-e)}function cn(t,e,n){return M.call(t,null==e||n?1:e)}var sn=B((function(t,e){return e=_e(e,!0,!0),qe(t,(function(t){return!We(e,t)}))})),ln=B((function(t,e){return sn(t,e)}));function fn(t,e,n,r){Y(e)||(r=n,n=e,e=!1),null!=n&&(n=ne(n,r));for(var a=[],o=[],u=0,i=yt(t);u<i;u++){var c=t[u],s=n?n(c,u,t):c;e&&!n?(u&&o===s||a.push(c),o=s):n?We(o,s)||(o.push(s),a.push(c)):We(a,c)||a.push(c)}return a}var hn=B((function(t){return fn(_e(t,!0,!0))}));function dn(t){for(var e=t&&Ge(t,yt).length||0,n=Array(e),r=0;r<e;r++)n[r]=$e(t,r);return n}var pn=B(dn);function vn(t,e){return t._chain?jt(e).chain():e}function mn(t){return He(Ft(t),(function(e){var n=jt[e]=t[e];jt.prototype[e]=function(){var t=[this._wrapped];return O.apply(t,arguments),vn(this,n.apply(jt,t))}})),jt}He(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=j[t];jt.prototype[t]=function(){var n=this._wrapped;return null!=n&&(e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0]),vn(this,n)}})),He(["concat","join","slice"],(function(t){var e=j[t];jt.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),vn(this,t)}}));var gn=mn(Object.freeze({__proto__:null,VERSION:"1.13.1",restArguments:B,isObject:V,isNull:function(t){return null===t},isUndefined:q,isBoolean:Y,isElement:function(t){return!(!t||1!==t.nodeType)},isString:W,isNumber:U,isDate:$,isRegExp:G,isError:J,isSymbol:K,isArrayBuffer:Q,isDataView:ot,isArray:ut,isFunction:tt,isArguments:st,isFinite:function(t){return!K(t)&&D(t)&&!isNaN(parseFloat(t))},isNaN:lt,isTypedArray:gt,isEmpty:function(t){if(null==t)return!0;var e=yt(t);return"number"==typeof e&&(ut(t)||W(t)||st(t))?0===e:0===yt(wt(t))},isMatch:_t,isEqual:function(t,e){return Ct(t,e)},isMap:Et,isWeakMap:Tt,isSet:kt,isWeakSet:Dt,keys:wt,allKeys:Ot,values:Ht,pairs:function(t){for(var e=wt(t),n=e.length,r=Array(n),a=0;a<n;a++)r[a]=[e[a],t[e[a]]];return r},invert:Pt,functions:Ft,methods:Ft,extend:Vt,extendOwn:qt,assign:qt,defaults:Yt,create:function(t,e){var n=zt(t);return e&&qt(n,e),n},clone:Wt,tap:function(t,e){return e(t),t},get:Jt,has:function(t,e){for(var n=(e=$t(e)).length,r=0;r<n;r++){var a=e[r];if(!it(t,a))return!1;t=t[a]}return!!n},mapObject:function(t,e,n){e=ne(e,n);for(var r=wt(t),a=r.length,o={},u=0;u<a;u++){var i=r[u];o[i]=e(t[i],i,t)}return o},identity:Kt,constant:ft,noop:re,toPath:Ut,property:Xt,propertyOf:function(t){return null==t?re:function(e){return Jt(t,e)}},matcher:Qt,matches:Qt,times:function(t,e,n){var r=Array(Math.max(0,t));e=Zt(e,n,1);for(var a=0;a<t;a++)r[a]=e(a);return r},random:ae,now:oe,escape:ce,unescape:se,templateSettings:le,template:function(t,e,n){!e&&n&&(e=n),e=Yt({},e,jt.templateSettings);var r=RegExp([(e.escape||fe).source,(e.interpolate||fe).source,(e.evaluate||fe).source].join("|")+"|$","g"),a=0,o="__p+='";t.replace(r,(function(e,n,r,u,i){return o+=t.slice(a,i).replace(de,pe),a=i+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":u&&(o+="';\n"+u+"\n__p+='"),e})),o+="';\n";var u,i=e.variable;if(i){if(!ve.test(i))throw new Error("variable is not a bare identifier: "+i)}else o="with(obj||{}){\n"+o+"}\n",i="obj";o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{u=new Function(i,"_",o)}catch(t){throw t.source=o,t}var c=function(t){return u.call(this,t,jt)};return c.source="function("+i+"){\n"+o+"}",c},result:function(t,e,n){var r=(e=$t(e)).length;if(!r)return tt(n)?n.call(t):n;for(var a=0;a<r;a++){var o=null==t?void 0:t[e[a]];void 0===o&&(o=n,a=r),t=tt(o)?o.call(t):o}return t},uniqueId:function(t){var e=++me+"";return t?t+e:e},chain:function(t){var e=jt(t);return e._chain=!0,e},iteratee:ee,partial:ye,bind:be,bindAll:je,memoize:function(t,e){var n=function n(r){var a=n.cache,o=""+(e?e.apply(this,arguments):r);return it(a,o)||(a[o]=t.apply(this,arguments)),a[o]};return n.cache={},n},delay:Se,defer:Ce,throttle:function(t,e,n){var r,a,o,u,i=0;n||(n={});var c=function(){i=!1===n.leading?0:oe(),r=null,u=t.apply(a,o),r||(a=o=null)},s=function(){var s=oe();i||!1!==n.leading||(i=s);var l=e-(s-i);return a=this,o=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),i=s,u=t.apply(a,o),r||(a=o=null)):r||!1===n.trailing||(r=setTimeout(c,l)),u};return s.cancel=function(){clearTimeout(r),i=0,r=a=o=null},s},debounce:function(t,e,n){var r,a,o,u,i,c=function c(){var s=oe()-a;e>s?r=setTimeout(c,e-s):(r=null,n||(u=t.apply(i,o)),r||(o=i=null))},s=B((function(s){return i=this,o=s,a=oe(),r||(r=setTimeout(c,e),n&&(u=t.apply(i,o))),u}));return s.cancel=function(){clearTimeout(r),r=o=i=null},s},wrap:function(t,e){return ye(e,t)},negate:Oe,compose:function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:Me,once:Ae,findKey:Re,findIndex:Ne,findLastIndex:Ie,sortedIndex:Le,indexOf:Te,lastIndexOf:ke,find:De,detect:De,findWhere:function(t,e){return De(t,Qt(e))},each:He,forEach:He,map:Pe,collect:Pe,reduce:Be,foldl:Be,inject:Be,reduceRight:Ve,foldr:Ve,filter:qe,select:qe,reject:function(t,e,n){return qe(t,Oe(ne(e)),n)},every:Ye,all:Ye,some:ze,any:ze,contains:We,includes:We,include:We,invoke:Ue,pluck:$e,where:function(t,e){return qe(t,Qt(e))},max:Ge,min:function(t,e,n){var r,a,o=1/0,u=1/0;if(null==e||"number"==typeof e&&"object"!=s(t[0])&&null!=t)for(var i=0,c=(t=we(t)?t:Ht(t)).length;i<c;i++)null!=(r=t[i])&&r<o&&(o=r);else e=ne(e,n),He(t,(function(t,n,r){((a=e(t,n,r))<u||a===1/0&&o===1/0)&&(o=t,u=a)}));return o},shuffle:function(t){return Je(t,1/0)},sample:Je,sortBy:function(t,e,n){var r=0;return e=ne(e,n),$e(Pe(t,(function(t,n,a){return{value:t,index:r++,criteria:e(t,n,a)}})).sort((function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index})),"value")},groupBy:Qe,indexBy:Xe,countBy:Ze,partition:tn,toArray:function(t){return t?ut(t)?M.call(t):W(t)?t.match(en):we(t)?Pe(t,Kt):Ht(t):[]},size:function(t){return null==t?0:we(t)?t.length:wt(t).length},pick:rn,omit:an,first:un,head:un,take:un,initial:on,last:function(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:cn(t,Math.max(0,t.length-e))},rest:cn,tail:cn,drop:cn,compact:function(t){return qe(t,Boolean)},flatten:function(t,e){return _e(t,e,!1)},without:ln,uniq:fn,unique:fn,union:hn,intersection:function(t){for(var e=[],n=arguments.length,r=0,a=yt(t);r<a;r++){var o=t[r];if(!We(e,o)){var u;for(u=1;u<n&&We(arguments[u],o);u++);u===n&&e.push(o)}}return e},difference:sn,unzip:dn,transpose:dn,zip:pn,object:function(t,e){for(var n={},r=0,a=yt(t);r<a;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},range:function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),a=Array(r),o=0;o<r;o++,t+=n)a[o]=t;return a},chunk:function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,a=t.length;r<a;)n.push(M.call(t,r,r+=e));return n},mixin:mn,default:jt}));function yn(t){if(!t.format())return Kt;switch(t.precision()){case"year":return function(t){return $(t)?t.getFullYear():t};case"half":return function(t){return $(t)?t.getFullYear()+" H"+(t.getMonth()/6+1):t};case"quarter":return function(t){return $(t)?t.getFullYear()+" Q"+(t.getMonth()/3+1):t};case"month":return function(t){return $(t)?a.default(t).format("MMM YY"):t};case"week":return function(t){return $(t)?function(t){var e=t.getUTCDay(),n=new Date(t.valueOf());n.setDate(n.getDate()-(e+6)%7+3);var r=n.getUTCFullYear(),a=Math.floor((n.getTime()-new Date(r,0,1,-6))/864e5);return[r,1+Math.floor(a/7),e>0?e:7]}(t).slice(0,2).join(" W"):t};case"day":return function(t,e){return $(t)?a.default(t).format(e?"dddd, MMMM DD, YYYY":"l"):t};case"day-minutes":return function(t){return $(t)?a.default(t).format("MMM DD").replace(" ","&nbsp;")+" - "+a.default(t).format("LT").replace(" ","&nbsp;"):t};case"day-seconds":return function(t){return $(t)?a.default(t).format("LTS").replace(" ","&nbsp;"):t}}}function bn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function wn(t,e,n){if(n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bn(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({format:"0.[00]",prepend:"",append:"",minusChar:"−",plusMinusChar:"±",multiply:1},n),void 0===e||isNaN(e)||""===e||null===e)return"";var r=n,a=r.append,o=r.prepend,u=r.minusChar,i=r.plusMinusChar,c=r.multiply,s=n.format;s.includes("%")&&Number.isFinite(e)&&(e*=.01),e*=c;var f=s.indexOf("(")>-1,h=s.indexOf(";")>-1;s=s.replace(/;/g,",");var d=t(f?e:Math.abs(e)).format(s);if(h){var p=t.options.currentLocale,v=t.locales[p].delimiters.thousands,m=s.includes("%")?e/.01:e;d=Math.abs(m)<1e4?d.replace(v,""):d}return o&&!f&&e<0&&_n.has(o.trim().toLowerCase())?"".concat(u).concat(o).concat(d.replace("+","")).concat(a):o&&e>=0&&_n.has(o.trim().toLowerCase())&&s.includes("+")?"".concat(0===e?i:"+").concat(o).concat(d.replace("+","")).concat(a):0===e&&s.includes("+")?"".concat(o).concat(d.replace("+",i)).concat(a):e<0&&!f?"".concat(o).concat(u).concat(d.replace("+","")).concat(a):"".concat(o).concat(d).concat(a)}gn._=gn;var _n=new Set(["฿","₿","¢","$","€","eur","£","gbp","¥","yen","usd","cad","us$","ca$","can$"]);function jn(t,e){return Math.abs(t-e)<1e-6}function Sn(t,e){var n=e["number-format"]||"-",r=Number(e["number-divisor"]||0),a=(e["number-append"]||"").replace(/ /g," "),o=(e["number-prepend"]||"").replace(/ /g," ");return function(e,u,i){if(isNaN(e))return e;var c,s,l=n,f=0;0!==r&&"-"===l&&(f=1),"s"===l.substr(0,1)&&(f=Math.max(0,(c=e,s=+l.substr(1),0===c?0:Math.round(s-Math.ceil(Math.log(Math.abs(c))/Math.LN10))))),i&&(f=0),"-"===l&&(f=jn(e,Math.round(e))?0:jn(e,.1*Math.round(10*e))?1:jn(e,.01*Math.round(100*e))?2:jn(e,.001*Math.round(1e3*e))?3:jn(e,1e-4*Math.round(1e4*e))?4:jn(e,1e-5*Math.round(1e5*e))?5:6),"n"===l[0]&&(f=Number(l.substr(1,l.length)));for(var h="0,0",d=0;d<f;d++)0===d&&(h+="."),h+="0";return wn(t,e,{format:h,prepend:u?o:"",append:u?a:"",multiply:Math.pow(10,-1*r)})}}var Cn=function(t){return t};function On(t,e,n,r){return"date"===e.type()?yn(e.type(!0)):"number"===e.type()?Sn(t,function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return t;for(var r=Array.isArray(e)?e:e.split("."),a=t,o=0;o<r.length&&null!=a;o++)a=a[r[o]];return null==a?n:a}(n,"data.column-format.".concat(r),{})):Cn}function Mn(t,e,n,r){var a=dw.visualization.libraries.numeral,o={date:"fa fa-clock-o"};return function(u,i,c,s,l,f,h){if(!(n.numColumns()<=s)&&n.hasColumn(s)){var d=n.column(s),p=t.get(),v=p.searchResults,m=p.currentResult,g=p.activeColumn,y=t.getColumnFormat(d.name());if((c=u.toPhysicalRow(c))>0){var b=On(a,d,e.get().metadata,d.name());f=null===d.val(c-1)||""===d.val(c-1)?"–":b(d.val(c-1),!0)}parseInt(f)<0&&i.classList.add("negative"),i.classList.add(d.type()+"Type"),i.dataset.column=s,"text"===d.type()&&f&&f.length>70&&(f=f.substr(0,60)+"…"),0===c?(i.classList.add("firstRow"),o[d.type()]&&(f='<i class="'+o[d.type()]+'"></i> '+f)):i.classList.add(c%2?"oddRow":"evenRow"),y.ignore&&i.classList.add("ignored"),g&&g.name()===d.name()&&i.classList.add("active");var _=r.hooks.run(u,"modifyRow",c);v.forEach((function(t){t.row===_&&t.col===s&&i.classList.add("htSearchResult")})),m&&m.row===_&&m.col===s&&i.classList.add("htCurrentSearchResult"),c>0&&!d.type(!0).isValid(d.val(c-1))&&null!==d.val(c-1)&&""!==d.val(c-1)&&i.classList.add("parsingError"),c>0&&(null===d.val(c-1)||""===d.val(c-1))&&i.classList.add("noData"),d.isComputed&&d.errors.length&&d.errors.find((function(t){return"all"===t.row||t.row===c-1}))&&i.classList.add("parsingError"),h.readOnly&&i.classList.add("readOnly"),e.dataCellChanged(s,c)&&i.classList.add("changed"),function(t,e,n,a,o,u){var i=w(r.helper.stringify(u));e.innerHTML=i}(0,i,0,0,0,f)}}}function An(t){if(!t||"object"!==s(t))return t;try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}var Rn=null,xn=null;var Nn={render:function(){this.get().hot.render()},doSearch:function(){var t=this,e=this.get(),n=e.hot,r=e.search;clearTimeout(xn),xn=setTimeout((function(){if(n&&r){var e=n.getPlugin("search").query(r);t.set({searchResults:e})}else t.set({searchResults:[]})}),300)},update:function(){var t=this,e=this.get(),n=e.data,a=e.transpose,o=e.firstRowIsHeader,u=e.skipRows,i=e.hot;if(n){var c=this.store.get().dw_chart,s=c.dataset(dw.datasource.delimited({csv:n,transpose:a,firstRowIsHeader:o,skipRows:u}).parse()).dataset();this.set({columnOrder:s.columnOrder()});var l=[[]];s.eachColumn((function(t){return l[0].push(t.title())})),s.eachRow((function(t){var e=[];s.eachColumn((function(n){return e.push(n.raw(t))})),l.push(e)})),i.loadData(l);var f=Mn(this,c,s,r.default);i.updateSettings({cells:function(e,n){return{readOnly:t.get().readonly||s.hasColumn(n)&&s.column(n).isComputed&&0===e,renderer:f}},manualColumnMove:[]}),this.set({ds:s}),this.set({has_changes:An(chart.get("metadata.data.changes",[])).length>0}),r.default.hooks.once("afterRender",(function(){return t.initCustomEvents()})),r.default.hooks.once("afterRender",(function(){return t.fire("afterRender")})),i.render()}},dataChanged:function(t){var e=this,n=this.get().hot,r=!1;t.forEach((function(t){var a=c(t,4),o=a[0],u=a[1],i=a[2],s=a[3];if(i!==s){var l=e.store.get().dw_chart,f=e.get().transpose,h=An(l.get("metadata.data.changes",[]));if(o=n.toPhysicalRow(o),u=l.dataset().columnOrder()[u],f){var d=o;o=u,u=d}h.push({column:u,row:o,value:s,previous:i,time:(new Date).getTime()}),l.set("metadata.data.changes",h),r=!0}})),r&&setTimeout((function(){e.update(),chart.save()}),100)},columnMoved:function(t,e){var n=this,a=this.get().hot;if(t.length){var o=this.get().columnOrder,u=o.slice(0),c=o[e],s=u.splice(t[0],t.length),l=void 0===c?u.length:c?u.indexOf(c):0;u.splice.apply(u,[l,0].concat(i(s))),this.store.get().dw_chart.set("metadata.data.column-order",u.slice(0)),this.set({columnOrder:u}),r.default.hooks.once("afterRender",(function(){setTimeout((function(){n.fire("resetSort"),a.selectCell(0,l,a.countRows()-1,l+s.length-1)}),10)})),this.update()}},updateHeight:function(){var t=document.querySelector(".ht_master.handsontable .wtHolder .wtHider").getBoundingClientRect().height;this.refs.hot.style.height=Math.min(500,t+10)+"px"},checkRange:function(t,e,n,r){var a=this.get().hot,o=this.get().ds;if(e!==r||0!==t||n!==a.countRows()-1)if(e===r||0!==t||n!==a.countRows()-1)this.set({activeColumn:null,multiSelection:!1});else{for(var u=[],i=Math.min(e,r);i<=Math.max(e,r);i++)u.push(+document.querySelector("#data-preview .htCore tbody tr:first-child td:nth-child(".concat(i+2,")")).dataset.column);this.set({multiSelection:u.map((function(t){return o.column(t)})),activeColumn:null})}},initCustomEvents:function(){var t=this;setTimeout((function(){t.refs.hot.querySelectorAll(".htCore thead th:first-child").forEach((function(t){t.removeEventListener("click",Tn),t.addEventListener("click",Tn)})),t.refs.hot.querySelectorAll(".htCore thead th+th").forEach((function(t){t.removeEventListener("click",En),t.addEventListener("click",En)}))}),500)},getColumnFormat:function(t){return this.store.get().dw_chart.get("metadata.data.column-format",{})[t]||{type:"auto",ignore:!1}}};function In(){var t=this;Rn=this,r.default.hooks.once("afterRender",(function(){return t.initCustomEvents()})),window.addEventListener("keyup",(function(e){var n=t.get(),r=n.activeColumn,a=n.ds;if(r&&"input"!==e.target.tagName.toLowerCase()&&"textarea"!==e.target.tagName.toLowerCase()&&("ArrowRight"===e.key||"ArrowLeft"===e.key)){e.preventDefault(),e.stopPropagation();var o=a.indexOf(r.name());"ArrowRight"===e.key?t.set({activeColumn:a.column((o+1)%a.numColumns())}):t.set({activeColumn:a.column((o-1+a.numColumns())%a.numColumns())})}}));var e=this.store.get().dw_chart,n=new r.default(this.refs.hot,{data:[],rowHeaders:function(t){return r.default.hooks.run(n,"modifyRow",t)+1},colHeaders:!0,fixedRowsTop:1,fixedColumnsLeft:this.get().fixedColumnsLeft,filters:!0,startRows:13,startCols:8,fillHandle:!1,stretchH:"all",height:500,manualColumnMove:!0,selectionMode:"range",autoColumnSize:{useHeaders:!0,syncLimit:5},sortIndicator:!0,columnSorting:!0,sortFunction:function(t,n){if(n.col>-1){var r=e.dataset().column(n.col),a=r.type();return function(e,n){return 0===e[0]?-1:(e[1]=r.val(e[0]-1),n[1]=r.val(n[0]-1),"number"===a&&(isNaN(e[1])&&(e[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY),isNaN(n[1])&&(n[1]=t?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY)),"date"===a&&("string"==typeof e[1]&&(e[1]=new Date(110,0,1)),"string"==typeof n[1]&&(n[1]=new Date(110,0,1))),("desc"===t?-1:1)*(e[1]>n[1]?1:e[1]<n[1]?-1:0))}}return function(t,e){return t[0]-e[0]}},afterGetColHeader:function(e,n){var r=t.get(),a=r.activeColumn,o=r.ds;o&&o.hasColumn(e)&&((0===e||e)&&a&&o.column(e).name()===a.name()&&n.classList.add("selected"),(0===e||e)&&(t.getColumnFormat(o.column(e).name()).ignore?n.classList.add("ignored"):n.classList.remove("ignored")))},search:"search"});window.HT=n,this.set({hot:n}),r.default.hooks.add("afterSetDataAtCell",(function(e){return t.dataChanged(e)})),r.default.hooks.add("afterColumnMove",(function(e,n){return t.columnMoved(e,n)})),r.default.hooks.add("afterRender",(function(){return t.updateHeight()})),r.default.hooks.add("afterSelection",(function(e,n,r,a){return t.checkRange(e,n,r,a)}))}function Ln(t){var e=t.changed,n=t.current,r=t.previous,a=n.hot;if(a){if(e.data&&this.update(),e.firstRowIsHeader&&r&&void 0!==r.firstRowIsHeader&&this.update(),e.hot&&this.update(),e.search&&r&&(this.doSearch(),this.set({searchIndex:0})),e.searchResults&&a.render(),e.currentResult&&n.currentResult){a.render();var o=n.currentResult;a.scrollViewportTo(o.row,o.col),setTimeout((function(){a.scrollViewportTo(o.row,o.col)}),100)}e.activeColumn&&setTimeout((function(){return a.render()}),10),e.fixedColumnsLeft&&a.updateSettings({fixedColumnsLeft:n.fixedColumnsLeft}),e.sorting&&a.getPlugin("columnSorting").sort(chart.dataset().indexOf(n.sorting.sortBy),n.sorting.sortDir?"asc":"desc")}}function En(t){for(var e=this.parentNode.children.length,n=-1,r=0;r<e;r++)if(this.parentNode.children.item(r)===this){n=r;break}var a=+Rn.refs.hot.querySelector(".htCore tbody tr:first-child td:nth-child(".concat(n+1,")")).dataset.column,o=Rn.store.get().dw_chart,u=Rn.get(),i=u.activeColumn,c=u.hot;if(o.dataset().hasColumn(a)){var s=o.dataset().column(+a);i&&i.name()===s.name()?(t.target.parentNode.classList.remove("selected"),Rn.set({activeColumn:!1}),c.deselectCell()):(t.target.parentNode.classList.add("selected"),Rn.set({activeColumn:s}))}}function Tn(t){t.preventDefault();var e=Rn.get().transpose;Rn.set({transpose:!e}),Rn.update()}function kn(t,e){var n;return{c:function(){var t;t="div",(n=document.createElement(t)).id="data-preview"},m:function(e,r){!function(t,e,n){t.insertBefore(e,n)}(e,n,r),t.refs.hot=n},p:f,d:function(e){var r;e&&(r=n).parentNode.removeChild(r),t.refs.hot===n&&(t.refs.hot=null)}}}function Dn(t){var e=this;!function(t,e){t._handlers=p(),t._slots=p(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}(this,t),this.refs={},this._state=h({hot:null,data:"",readonly:!1,skipRows:0,firstRowIsHeader:!0,fixedColumnsLeft:0,searchIndex:0,sortBy:"-",transpose:!1,activeColumn:null,search:"",searchResults:[]},t.data),this._recompute({searchResults:1,searchIndex:1},this._state),this._intro=!0,this._handlers.state=[Ln],Ln.call(this,{changed:d({},this._state),current:this._state}),this._fragment=kn(this,this._state),this.root._oncreate.push((function(){In.call(e),e.fire("update",{changed:d({},e._state),current:e._state})})),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),v(this))}return h(Dn.prototype,g),h(Dn.prototype,Nn),Dn.prototype._recompute=function(t,e){(t.searchResults||t.searchIndex)&&this._differs(e.currentResult,e.currentResult=function(t){var e=t.searchResults,n=t.searchIndex;if(!e||!e.length)return null;var r=e.length;if(n<0||n>=r){for(;n<0;)n+=r;n>r&&(n%=r)}return e[n]}(e))&&(t.currentResult=!0)},{Handsontable:Dn}}));
